<!DOCTYPE html>
<html lang="pt-br">
<head>
      <meta content="width=device-width, initial-scale=1" name="viewport"/>
      <title>Python para Escritórios Inteligentes</title>
      <style>
         body {
            max-width: 900px;
            margin: 0 auto;
            padding: 32px 16px 48px 16px;
            font-family: 'Segoe UI', 'Arial', sans-serif;
            font-size: 1.15em;
            line-height: 1.7;
            background: #f9f9fb;
            color: #222;
         }
         h1, h2, h3, h4, h5, h6 {
            color: #1a237e;
            margin-top: 2.2em;
            margin-bottom: 0.7em;
            font-weight: 700;
            line-height: 1.2;
         }
         h1 { font-size: 2.1em; }
         h2 { font-size: 1.6em; }
         h3 { font-size: 1.25em; }
         hr {
            border: none;
            border-top: 2px solid #e3e3e3;
            margin: 2.5em 0 2em 0;
         }
         figure, img {
            display: block;
            margin: 1.5em auto;
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 2px 12px #0001;
         }
         figcaption {
            text-align: center;
            font-size: 0.98em;
            color: #555;
            margin-top: 0.4em;
         }
         pre, code {
            background: #23272e;
            color: #e3e3e3;
            border-radius: 6px;
            padding: 0.7em 1em;
            font-size: 1em;
            overflow-x: auto;
         }
         pre {
            margin: 1.2em 0;
         }
         table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5em 0;
            background: #fff;
         }
         th, td {
            border: 1px solid #d0d0d0;
            padding: 0.7em 1em;
            text-align: left;
         }
         th {
            background: #e3e7fa;
            color: #1a237e;
         }
         nav, .toc {
            background: #f2f4fa;
            border: 1px solid #d0d0d0;
            border-radius: 10px;
            padding: 1.2em 1.5em;
            margin: 2em auto 2.5em auto;
            max-width: 700px;
            box-shadow: 0 2px 8px #0001;
         }
         nav h3, .toc h3 {
            color: #3949ab;
            margin-bottom: 0.7em;
            font-size: 1.15em;
            font-weight: 600;
         }
         nav ol, nav ul, .toc ol, .toc ul {
            padding-left: 1.2em;
            line-height: 1.7;
         }
         nav a, .toc a {
            color: #1a237e;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s;
         }
         nav a:hover, .toc a:hover {
            color: #0d133d;
            text-decoration: underline;
         }
         .sumario-link {
            display: inline-block;
            margin: 0.5em 0 2em 0;
            padding: 0.25em 0.9em;
            background: #e3e7fa;
            color: #1a237e;
            border-radius: 6px;
            font-size: 0.98em;
            font-weight: 500;
            text-decoration: none;
            transition: background 0.2s, color 0.2s;
            border: 1px solid #c3c7e0;
         }
         .sumario-link:hover {
            background: #c3c7e0;
            color: #0d133d;
         }
         @media (max-width: 900px) {
            body { max-width: 100vw; padding: 18px 4vw 32px 4vw; }
            nav, .toc, figure, table, pre, code { max-width: 100vw; }
         }
         @media (max-width: 600px) {
            body { font-size: 1em; }
            h1 { font-size: 1.3em; }
            h2 { font-size: 1.1em; }
            nav, .toc { padding: 0.7em 0.5em; }
         }
      </style>
</head>
<body>
   <div class="capa">
      <img src="images/capa.png" alt="Capa do Livro">
   </div>
<hr />
<h1 id="prefacio">Prefácio</h1>
<p>Vivemos um tempo em que a tecnologia deixou de ser apenas uma
ferramenta de especialistas para se tornar uma aliada indispensável em
todas as profissões. Nos escritórios, onde o tempo é precioso e as
demandas crescem a cada dia, a automação surge como uma ponte entre o
trabalho repetitivo e a criatividade, entre o esforço manual e a
inteligência estratégica.</p>
<p>Este livro nasce do desejo de mostrar que a automação não é
privilégio de grandes empresas ou de programadores experientes. Ela está
ao alcance de todos que desejam transformar sua rotina, ganhar tempo e
abrir espaço para o que realmente importa: pensar, criar, inovar e
servir melhor.</p>
<p>Ao longo destas páginas, você encontrará não apenas códigos e
exemplos práticos, mas também uma nova forma de enxergar os desafios do
dia a dia. Cada script, cada exercício, é um convite para experimentar,
errar, aprender e, principalmente, evoluir. Python, com sua simplicidade
e poder, será seu companheiro nessa jornada — e a inteligência
artificial, uma porta para possibilidades antes inimagináveis.</p>
<p>Que este livro inspire você a dar o primeiro passo, a superar o medo
do desconhecido e a descobrir que, com curiosidade e dedicação, é
possível reinventar o trabalho no escritório. Que cada automação criada
seja uma vitória sobre o tempo perdido e um passo rumo a uma vida
profissional mais leve, produtiva e gratificante.</p>
<p>Boa leitura, bons estudos e, acima de tudo, ótimas descobertas!</p>
<hr />
<h1 id="apresentacao">Apresentação</h1>
<p>Vivemos uma era em que a tecnologia e a inteligência artificial podem
transformar o dia a dia dos escritórios, tornando tarefas repetitivas
mais rápidas, precisas e menos cansativas. No entanto, muitos
profissionais ainda gastam horas com atividades manuais que poderiam ser
facilmente automatizadas.</p>
<p>Este livro nasceu da vontade de aproximar o poder da programação —
especialmente do Python — e da inteligência artificial do ambiente de
escritórios, sejam eles de advocacia, contabilidade, logística, vendas
ou serviços para repartições públicas e órgãos governamentais. O
objetivo é mostrar, de forma prática e acessível, como automatizar
processos comuns, economizar tempo e aumentar a produtividade, mesmo
para quem nunca programou antes.</p>
<p>Ao longo dos capítulos, você encontrará exemplos reais, projetos
práticos e dicas para aplicar imediatamente no seu trabalho. Não é
necessário ser um especialista em tecnologia: basta curiosidade e
vontade de aprender.</p>
<p>O conteúdo está dividido em duas partes principais para facilitar o
aprendizado e a aplicação dos conceitos:</p>
<ul>
<li><p><strong>Parte I – Fundamentos da Automação:</strong></p></li>
<li><p>Aqui você aprenderá os conceitos essenciais, desde a instalação
do ambiente até a manipulação de arquivos, automação de e-mails, web
scraping, criação de interfaces gráficas simples e introdução ao uso de
inteligência artificial em tarefas do escritório.</p></li>
<li><p><strong>Parte II – Casos Reais por Tipo de
Escritório:</strong></p></li>
<li><p>Nesta parte, apresentamos exemplos práticos e projetos voltados
para diferentes áreas, incluindo escritórios que prestam serviços para
repartições públicas e órgãos governamentais, mostrando como adaptar as
soluções para a sua realidade.</p></li>
</ul>
<p>Espero que este material ajude você a transformar sua rotina
profissional, abrindo portas para novas possibilidades e mostrando que a
automação e a inteligência artificial estão ao alcance de todos.</p>
<hr />
<h1 id="sumario">Sumário</h1>
<h2><a href="#introducao">Introdução</a></h2>
<h2><a href="#parte-i-fundamentos-da-automacao">Parte I – Fundamentos da Automação</a></h2>
<ol type="1">
<li><a href="#introducao-a-automacao-com-python">Introdução a automação com python</a></li>
<li><a href="#instalacao-de-ambiente-vs-code-python-e-bibliotecas-uteis">Instalação de ambiente vs code python e bibliotecas úteis</a></li>
<li><a href="#trabalhando-com-arquivos-excel-csv-pdf-word">Trabalhando com arquivos excel csv pdf word</a></li>
<li><a href="#automacao-de-e-mails-e-notificacoes">Automação de e-mails e notificações</a></li>
<li><a href="#web-scraping-e-automacao-de-sites">Web scraping e automação de sites</a></li>
<li><a href="#criacao-de-interfaces-graficas-simples-tkinter-ou-pywebio">Criação de interfaces gráficas simples tkinter ou pywebio</a></li>
</ol>
<h2><a href="#parte-ii-automacao-de-escritorios">Parte II – Casos Reais por Tipo de Escritório</a></h2>
<h3><a href="#escritorios-de-advocacia">Escritórios de Advocacia</a></h3>
<ol start="7" type="1">
<li><a href="#gerador-automatico-de-procuracoes-e-peticoes-a-partir-de-modelos">Gerador automático de procuracoes e peticoes a partir de modelos</a></li>
<li><a href="#controle-de-prazos-processuais-leitura-de-planilhas-envio-de-alertas-por-e-mail">Controle de prazos processuais leitura de planilhas envio de alertas por e-mail</a></li>
<li><a href="#consulta-a-sites-de-tribunais">Consulta a sites de tribunais</a></li>
</ol>
<h3><a href="#escritorios-de-contabilidade">Escritórios de Contabilidade</a></h3>
<ol start="10" type="1">
<li><a href="#leitura-e-consolidacao-de-extratos-bancarios-csv">Leitura e consolidação de extratos bancários csv</a></li>
<li><a href="#geracao-automatica-de-guias-de-impostos">Geração automática de guias de impostos</a></li>
<li><a href="#envio-automatico-de-boletos-por-e-mail">Envio automático de boletos por e-mail</a></li>
</ol>
<h3><a href="#escritorios-de-logistica">Escritórios de Logística</a></h3>
<ol start="13" type="1">
<li><a href="#leitura-e-geracao-de-manifestos-xml-pdf">Leitura e geração de manifestos xml pdf</a></li>
<li><a href="#roteirizacao-com-base-em-distancia-api-google-maps-ou-openroute">Roteirização com base em distância api google maps ou openroute</a></li>
<li><a href="#acompanhamento-de-entregas-via-planilhas">Acompanhamento de entregas via planilhas atualizadas</a></li>
</ol>
<h3><a href="#e-commerce-e-vendas-online">E-commerce e Vendas Online</a></h3>
<ol start="16" type="1">
<li><a href="#leitura-de-pedidos-de-marketplaces">Leitura de pedidos de marketplaces</a></li>
<li><a href="#atualizacao-automatica-de-estoque">Atualização automática de estoque em excel erp simples</a></li>
<li><a href="#envio-de-notas-fiscais-e-respostas-automaticas-a-clientes">Envio de notas fiscais e respostas automáticas a clientes</a></li>
</ol>
<h3><a href="#escritorios-que-prestam-servicos-para-reparticoes-publicas-e-orgaos-governamentais">Escritórios que prestam serviços para repartições públicas e órgãos governamentais</a></h3>
<ol start="19" type="1">
<li><a href="#controle-automatizado-de-protocolos-em-reparticao-publica">Controle automatizado de protocolos em repartição pública</a></li>
<li><a href="#conversor-de-tabelas-pdf-excel">Conversor de tabelas pdf excel</a></li>
<li><a href="#roteirizacao-com-base-em-distancia-api-google-maps-ou-openroute">Roteirização com base em distância api google maps ou openroute</a></li>
<li><a href="#acompanhamento-de-entregas-via-planilhas">Acompanhamento de entregas via planilhas</a></li>
</ol>
<hr />
<ol start="23" type="1">
<li><a href="#conclusao-1">Conclusão</a></li>
<li><a href="#agradecimentos">Agradecimentos</a></li>
<li><a href="#referencias-bibliograficas-formato-abnt">Referências bibliográficas formato abnt</a></li>
<li><a href="#adendo-codigos-em-python">Adendo códigos em python</a></li>
</ol>
<hr />
<h1 id="introducao">Introdução</h1>
<p>A automação de tarefas rotineiras é uma das maiores oportunidades
para escritórios que desejam ganhar produtividade, reduzir erros e
liberar tempo para atividades mais estratégicas. Python, por ser uma
linguagem acessível, poderosa e com vasta comunidade, tornou-se a
escolha ideal para quem quer começar a automatizar processos no dia a
dia profissional.</p>
<p>Este livro foi pensado para ser um guia prático, direto ao ponto, e
acessível mesmo para quem nunca programou antes. O conteúdo está
dividido em duas partes principais, para facilitar o aprendizado e a
aplicação dos conceitos:</p>
<ul>
<li><p><strong>Parte I – Fundamentos da Automação:</strong><br />
Você aprenderá os conceitos essenciais, desde a instalação do ambiente
até a manipulação de arquivos, automação de e-mails, web scraping,
criação de interfaces gráficas simples e introdução ao uso de
inteligência artificial em tarefas do escritório.</p></li>
<li><p><strong>Parte II – Casos Reais por Tipo de
Escritório:</strong><br />
Apresentamos exemplos práticos e projetos voltados para diferentes
áreas, incluindo escritórios de advocacia, contabilidade, logística,
e-commerce e serviços para repartições públicas, mostrando como adaptar
as soluções para a sua realidade.</p></li>
</ul>
<p>Ao final, você encontrará projetos práticos para consolidar o
aprendizado e estimular a criatividade na busca por novas
automações.</p>
<p>Esperamos que este livro seja um ponto de partida para transformar
sua rotina profissional, tornando seu escritório mais inteligente,
eficiente e preparado para</p>
<hr />
<h1 id="parte-i-fundamentos-da-automacao">Parte I – Fundamentos da
Automacao</h1>
<p>Nesta primeira parte do livro, voce ira construir a base necessaria
para comecar a automatizar tarefas do dia a dia em escritorios
utilizando Python. O objetivo e apresentar os conceitos essenciais de
forma pratica e acessivel, mesmo para quem nunca programou antes.</p>
<p>Você aprenderá desde a instalação do ambiente de desenvolvimento,
passando pela manipulação de arquivos (Excel, CSV, PDF, Word), automação
de e-mails e notificações, extração de dados de sites (web scraping),
até a criação de interfaces gráficas simples. Cada capítulo traz
exemplos práticos e exercícios para que você possa aplicar imediatamente
o que aprendeu.</p>
<p>Ao dominar os fundamentos apresentados nesta parte, você estará
preparado para avançar para os casos reais de automação em diferentes
tipos de escritórios, explorados na Parte II do livro.</p>
<hr />
<h1 id="introducao-a-automacao-com-python">1. Introdução à automação com
Python</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>Automação é o processo de usar tecnologia para executar tarefas de
forma automática, reduzindo a necessidade de intervenção manual. No
contexto dos escritórios, isso significa transformar atividades
repetitivas e demoradas em processos rápidos, precisos e eficientes.</p>
<p>Python é uma das linguagens de programação mais populares para
automação devido à sua simplicidade, legibilidade e grande quantidade de
bibliotecas prontas para uso. Com Python, é possível automatizar desde
tarefas simples, como renomear arquivos em lote, até processos mais
complexos, como gerar relatórios, enviar e-mails, manipular planilhas e
interagir com sistemas web.</p>
<h2 id="por-que-automatizar-com-python">Por que automatizar com
Python?</h2>
<ul>
<li><strong>Facilidade de aprendizado:</strong> Python possui uma
sintaxe clara e intuitiva, ideal para iniciantes.</li>
<li><strong>Comunidade ativa:</strong> Há muitos tutoriais, fóruns e
exemplos disponíveis.</li>
<li><strong>Bibliotecas poderosas:</strong> Existem módulos prontos para
manipular arquivos, enviar e-mails, acessar bancos de dados, trabalhar
com planilhas, PDFs, web scraping, entre outros.</li>
<li><strong>Versatilidade:</strong> Python pode ser usado em diferentes
sistemas operacionais e integrado a diversas ferramentas já utilizadas
em escritórios.</li>
</ul>
<h3 id="exemplos-de-automacao-em-escritorios">Exemplos de automação em
escritórios</h3>
<ul>
<li>Organizar e renomear arquivos automaticamente.</li>
<li>Preencher e gerar documentos a partir de modelos.</li>
<li>Ler e consolidar dados de planilhas.</li>
<li>Enviar e-mails em massa ou com anexos personalizados.</li>
<li>Coletar informações de sites automaticamente (web scraping).</li>
<li>Gerar relatórios e dashboards de forma automática.</li>
</ul>
<p>Ao longo deste livro, você verá como essas e outras tarefas podem ser
automatizadas, tornando o seu dia a dia mais produtivo e eficiente.
Vamos começar a jornada pela automação com Python!</p>
<hr />
<h1 id="instalacao-de-ambiente-vs-code-python-e-bibliotecas-uteis">2.
Instalação de Ambiente: VS Code, Python e Bibliotecas Úteis</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>Antes de iniciar os exemplos práticos, é importante preparar o
ambiente de desenvolvimento. Siga os passos abaixo:</p>
<h2 id="instale-o-visual-studio-code-vs-code">2.1. Instale o Visual
Studio Code (VS Code)</h2>
<ul>
<li>Acesse: <a
href="https://code.visualstudio.com/">https://code.visualstudio.com/</a></li>
<li>Baixe e instale a versão adequada para o seu sistema operacional
(Windows, macOS ou Linux).</li>
</ul>
<h2 id="instale-o-python">2.2. Instale o Python</h2>
<ul>
<li>Acesse: <a
href="https://www.python.org/downloads/">https://www.python.org/downloads/</a></li>
<li>Baixe a versão mais recente do Python 3.x.</li>
<li>Durante a instalação, marque a opção <strong>“Add Python to
PATH”</strong>.</li>
</ul>
<h2 id="instale-bibliotecas-uteis">2.3. Instale Bibliotecas Úteis</h2>
<p>Abra o terminal do VS Code (atalho: `Ctrl + ``) e execute os comandos
abaixo para instalar as principais bibliotecas que serão usadas nos
exemplos:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install pandas openpyxl</span></code></pre></div>
<ul>
<li><code>pandas</code>: Manipulação de dados e leitura de planilhas
Excel.</li>
<li><code>openpyxl</code>: Leitura e escrita de arquivos
<code>.xlsx</code> (Excel).</li>
</ul>
<h2 id="opcional-instale-extensoes-no-vs-code">2.4. (Opcional) Instale
Extensões no VS Code</h2>
<ul>
<li><strong>Python</strong> (Microsoft): Suporte a sintaxe, depuração e
execução de scripts Python.</li>
<li><strong>Jupyter</strong>: Para notebooks interativos, se
desejar.</li>
</ul>
<hr />
<blockquote>
<p>Após esses passos, seu ambiente estará pronto para executar os
exemplos práticos.</p>
</blockquote>
<hr />
<h1 id="trabalhando-com-arquivos-excel-csv-pdf-word">3. Trabalhando com
arquivos (Excel, CSV, PDF, Word)</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>Nesta seção, você aprenderá a manipular diferentes tipos de arquivos
comuns no ambiente de escritório, como Excel, CSV, PDF e Word. Essas
habilidades são essenciais para automatizar tarefas que envolvem
leitura, escrita e processamento de dados.</p>
<h2 id="arquivos-csv">3.1. Arquivos CSV</h2>
<p>Para ler e escrever arquivos CSV, use o módulo csv ou o pandas:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Lendo um arquivo CSV</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;dados.csv&#39;</span>, mode<span class="op">=</span><span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    leitor <span class="op">=</span> csv.reader(<span class="bu">file</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> linha <span class="kw">in</span> leitor:</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(linha)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Escrevendo em um arquivo CSV</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;saida.csv&#39;</span>, mode<span class="op">=</span><span class="st">&#39;w&#39;</span>, newline<span class="op">=</span><span class="st">&#39;&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    escritor <span class="op">=</span> csv.writer(<span class="bu">file</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    escritor.writerow([<span class="st">&#39;Nome&#39;</span>, <span class="st">&#39;Idade&#39;</span>])</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    escritor.writerow([<span class="st">&#39;João&#39;</span>, <span class="dv">30</span>])</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    escritor.writerow([<span class="st">&#39;Maria&#39;</span>, <span class="dv">25</span>])</span></code></pre></div>
<h2 id="arquivos-excel">3.2. Arquivos Excel</h2>
<p>Para manipular arquivos Excel, use a biblioteca <code>pandas</code>
ou <code>openpyxl</code>. Aqui está um exemplo com
<code>pandas</code>:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Lendo um arquivo Excel</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_excel(<span class="st">&#39;dados.xlsx&#39;</span>, sheet_name<span class="op">=</span><span class="st">&#39;Planilha1&#39;</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.head())  <span class="co"># Exibe as primeiras linhas do DataFrame</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Escrevendo em um arquivo Excel</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>df.to_excel(<span class="st">&#39;saida.xlsx&#39;</span>, index<span class="op">=</span><span class="va">False</span>, sheet_name<span class="op">=</span><span class="st">&#39;Resultados&#39;</span>)</span></code></pre></div>
<h2 id="arquivos-pdf">3.3. Arquivos PDF</h2>
<p>Para ler arquivos PDF, você pode usar a biblioteca
<code>PyPDF2</code>. Aqui está um exemplo simples:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> PyPDF2</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Lendo um arquivo PDF</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;documento.pdf&#39;</span>, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    leitor <span class="op">=</span> PyPDF2.PdfReader(<span class="bu">file</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pagina <span class="kw">in</span> leitor.pages:</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(pagina.extract_text())  <span class="co"># Extrai o texto de cada página</span></span></code></pre></div>
<h2 id="arquivos-word">3.4. Arquivos Word</h2>
<p>Para manipular arquivos Word, use a biblioteca
<code>python-docx</code>. Veja como ler e escrever documentos:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> docx <span class="im">import</span> Document</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Lendo um arquivo Word</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>doc <span class="op">=</span> Document(<span class="st">&#39;documento.docx&#39;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> par <span class="kw">in</span> doc.paragraphs:</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(par.text)  <span class="co"># Exibe o texto de cada parágrafo</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Escrevendo em um arquivo Word</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>doc_novo <span class="op">=</span> Document()</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>doc_novo.add_heading(<span class="st">&#39;Título do Documento&#39;</span>, level<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>doc_novo.add_paragraph(<span class="st">&#39;Este é um parágrafo de exemplo.&#39;</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>doc_novo.save(<span class="st">&#39;novo_documento.docx&#39;</span>)  <span class="co"># Salva o novo documento</span></span></code></pre></div>
<h2 id="configurando-as-dependencias-do-ambiente-python">3.5.
Configurando as dependências do ambiente Python</h2>
<p>Para trabalhar com arquivos Excel, CSV, PDF e Word, você precisa
instalar algumas bibliotecas extras. Siga os passos abaixo:</p>
<ol type="1">
<li><p><strong>Crie um ambiente virtual (opcional, mas
recomendado):</strong> No terminal, execute:</p>
<pre class="plaintext"><code>python -m venv venv</code></pre>
<p>Ative o ambiente virtual:</p>
<pre class="plaintext"><code>venv\Scripts\activate</code></pre></li>
<li><p><strong>Instale as bibliotecas necessárias:</strong></p>
<pre class="plaintext"><code>pip install pandas openpyxl pdfplumber python-docx</code></pre>
<ul>
<li><code>pandas</code>: manipulação de dados (CSV, Excel)</li>
<li><code>openpyxl</code>: leitura/escrita de arquivos Excel
(.xlsx)</li>
<li><code>pdfplumber</code>: leitura de arquivos PDF</li>
<li><code>python-docx</code>: leitura/escrita de arquivos Word
(.docx)</li>
</ul></li>
<li><p><strong>(Opcional) Crie um arquivo <code>requirements.txt</code>
para registrar as dependências:</strong></p>
<pre class="plaintext"><code>pip freeze &gt; requirements.txt</code></pre></li>
</ol>
<p>Assim, seu ambiente estará pronto para manipular arquivos desses
tipos em Python. Você pode usar os exemplos acima como base para criar
scripts que automatizam tarefas relacionadas a esses arquivos no seu dia
a dia profissional.</p>
<hr />
<h2 id="exercicios-praticos">3.6. Exercícios Práticos</h2>
<p>Nesta seção, você encontrará exercícios práticos para aplicar os
conceitos aprendidos sobre manipulação de arquivos. Esses exercícios são
projetados para serem desafiadores e ajudarão a consolidar seu
conhecimento em automação de tarefas comuns em escritórios.</p>
<hr />
<h3
id="exercicio-pratico-analise-de-vendas-de-produtos-online-csv">3.6.1.
Exercício Prático: Análise de Vendas de Produtos Online (CSV)</h3>
<p><strong>História:</strong><br />
Você trabalha no setor de análise de dados de uma loja online. Recebeu
um arquivo <code>vendas.csv</code> contendo o histórico de vendas do
último mês. Cada linha do arquivo representa uma venda, com as seguintes
colunas: <code>data</code>, <code>produto</code>,
<code>quantidade</code>, <code>preco_unitario</code>.</p>
<p><strong>Desafio:</strong></p>
<ol type="1">
<li>Leia o arquivo <code>vendas.csv</code> usando Python.</li>
<li>Calcule o total vendido (em reais) por produto.</li>
<li>Gere um novo arquivo <code>relatorio_vendas.csv</code> contendo duas
colunas: <code>produto</code> e <code>total_vendido</code>.</li>
<li>(Opcional) Identifique qual produto teve o maior volume de
vendas.</li>
</ol>
<p><strong>Exemplo de entrada (<code>vendas.csv</code>):</strong></p>
<pre class="plaintext"><code>data,produto,quantidade,preco_unitario
2025-06-01,Mouse,2,50
2025-06-01,Teclado,1,120
2025-06-02,Mouse,1,50
2025-06-02,Monitor,1,900</code></pre>
<p><strong>Código Python</strong> para resolver o exercício:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Caminhos dos arquivos</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>csv_path <span class="op">=</span> <span class="vs">r&#39;C:</span><span class="dv">\d</span><span class="vs">ev</span><span class="er">\</span><span class="vs">python_escritorios</span><span class="er">\</span><span class="vs">codes</span><span class="ch">\v</span><span class="vs">endas</span><span class="dv">.</span><span class="vs">csv&#39;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>relatorio_path <span class="op">=</span> <span class="vs">r&#39;C:</span><span class="dv">\d</span><span class="vs">ev</span><span class="er">\</span><span class="vs">python_escritorios</span><span class="er">\</span><span class="vs">codes</span><span class="ch">\r</span><span class="vs">elatorio_vendas</span><span class="dv">.</span><span class="vs">csv&#39;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Apaga o relatório antigo, se existir</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> os.path.exists(relatorio_path):</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    os.remove(relatorio_path)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Lê o arquivo de vendas</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(csv_path)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcula o total vendido por produto</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;total&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;quantidade&#39;</span>] <span class="op">*</span> df[<span class="st">&#39;preco_unitario&#39;</span>]</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>df_relatorio <span class="op">=</span> df.groupby(<span class="st">&#39;produto&#39;</span>)[<span class="st">&#39;total&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>df_relatorio.rename(columns<span class="op">=</span>{<span class="st">&#39;total&#39;</span>: <span class="st">&#39;total_vendido&#39;</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Salva o novo relatório</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>df_relatorio.to_csv(relatorio_path, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Relatório de vendas gerado com sucesso!&quot;</span>)</span></code></pre></div>
<p><strong>Resultado esperado
(<code>relatorio_vendas.csv</code>)</strong>:</p>
<pre class="plaintext"><code>produto,total_vendido
Mouse,150
Teclado,120
Monitor,900</code></pre>
<p><strong>Conclusão:</strong></p>
<p>Com este exercício, você praticou a leitura de arquivos CSV,
manipulação de dados com pandas e geração de relatórios. Essas
habilidades são fundamentais para automatizar análises de vendas e
outras tarefas relacionadas a dados em escritórios.</p>
<hr />
<h3
id="exercicio-pratico-automatizando-relatorios-de-inadimplencia-em-alugueis-com-python-e-excel">3.6.2.
Exercício Prático: Automatizando Relatórios de Inadimplência em Aluguéis
com Python e Excel</h3>
<p><strong>História:</strong> Neste exercício, vamos aplicar a
integração entre Python e Excel para resolver um problema comum em
empresas de aluguel de imóveis: o controle de inadimplência.</p>
<p><strong>Cenário:</strong><br />
Uma empresa de aluguel de imóveis mantém uma planilha chamada
<code>alugueis.xlsx</code> com os seguintes campos:</p>
<ul>
<li>Imóvel</li>
<li>Inquilino</li>
<li>Valor Mensal</li>
<li>Data de Vencimento</li>
<li>Pago (Sim/Não)</li>
</ul>
<p><strong>Planilha de exemplo
(<code>alugueis.xlsx</code>):</strong></p>
<pre class="plaintext"><code>|-----------|-------------------|--------------|--------------------|----------------|
| Imóvel    | Inquilino         | Valor Mensal | Data de Vencimento | Pago (Sim/Não) |
|-----------|-------------------|--------------|--------------------|----------------|
| Apto 101  | João da Silva     | 1800         | 2025-06-10         | Sim            |
| Casa 202  | Maria Souza       | 2500         | 2025-06-15         | Não            |
| Loja 303  | Pedro Lima        | 3200         | 2025-06-20         | Não            |
| Apto 104  | Ana Martins       | 2000         | 2025-06-12         | Sim            |
| Casa 205  | Bruno Carvalho    | 2700         | 2025-06-18         | Não            |
| Loja 307  | Carla Mendes      | 3500         | 2025-06-25         | Sim            |
| Apto 110  | Felipe Gonçalves  | 2100         | 2025-06-14         | Não            |
| Casa 208  | Luciana Ferreira  | 2600         | 2025-06-22         | Não            |
|-----------|-------------------|--------------|--------------------|----------------|</code></pre>
<p><strong>Desafio:</strong><br />
Crie um script Python que:</p>
<ol type="1">
<li>Leia a planilha <code>alugueis.xlsx</code>.</li>
<li>Filtre os registros de imóveis cujo aluguel ainda não foi pago.</li>
<li>Gere um novo arquivo Excel chamado
<code>relatorio_inadimplentes.xlsx</code> apenas com os
inadimplentes.</li>
<li>Simule o envio de um e-mail para cada inquilino inadimplente,
informando o valor devido e a data de vencimento.</li>
</ol>
<p><strong>Exemplo de Código Python:</strong></p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>relatorio_path <span class="op">=</span> <span class="vs">r&#39;C:</span><span class="dv">\d</span><span class="vs">ev</span><span class="er">\</span><span class="vs">python_escritorios</span><span class="er">\</span><span class="vs">codes</span><span class="ch">\r</span><span class="vs">elatorio_inadimplentes</span><span class="dv">.</span><span class="vs">xlsx&#39;</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Importar bibliotecas</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Importar bibliotecas necessárias</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Apagar o relatório anterior, se existir</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> os.path.exists(relatorio_path):</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    os.remove(relatorio_path)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Ler a planilha de aluguéis</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_excel(<span class="vs">r&#39;C:</span><span class="dv">\d</span><span class="vs">ev</span><span class="er">\</span><span class="vs">python_escritorios</span><span class="er">\</span><span class="vs">codes</span><span class="ch">\a</span><span class="vs">lugueis</span><span class="dv">.</span><span class="vs">xlsx&#39;</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Filtrar inadimplentes</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>inadimplentes <span class="op">=</span> df[df[<span class="st">&#39;Pago (Sim/Não)&#39;</span>] <span class="op">==</span> <span class="st">&#39;Não&#39;</span>]</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Salvar relatório dos inadimplentes</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>inadimplentes.to_excel(<span class="vs">r&#39;C:</span><span class="dv">\d</span><span class="vs">ev</span><span class="er">\</span><span class="vs">python_escritorios</span><span class="er">\</span><span class="vs">codes</span><span class="ch">\r</span><span class="vs">elatorio_inadimplentes</span><span class="dv">.</span><span class="vs">xlsx&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Simular envio de e-mails</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, row <span class="kw">in</span> inadimplentes.iterrows():</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Enviando e-mail para </span><span class="sc">{</span>row[<span class="st">&#39;Inquilino&#39;</span>]<span class="sc">}</span><span class="ss">:&quot;</span>)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Prezado(a) </span><span class="sc">{</span>row[<span class="st">&#39;Inquilino&#39;</span>]<span class="sc">}</span><span class="ss">, seu aluguel do imóvel </span><span class="sc">{</span>row[<span class="st">&#39;Imóvel&#39;</span>]<span class="sc">}</span><span class="ss"> no valor de R$ </span><span class="sc">{</span>row[<span class="st">&#39;Valor Mensal&#39;</span>]<span class="sc">}</span><span class="ss"> está em aberto. Vencimento: </span><span class="sc">{</span>row[<span class="st">&#39;Data de Vencimento&#39;</span>]<span class="sc">}</span><span class="ss">.&quot;</span>)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;------------------------------</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Calcular total de aluguéis em aberto</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>total_inadimplentes <span class="op">=</span> inadimplentes[<span class="st">&#39;Valor Mensal&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Total de aluguéis em aberto: R$ </span><span class="sc">{</span>total_inadimplentes<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Calcular total de aluguéis pagos</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>total_pagos <span class="op">=</span> df[df[<span class="st">&#39;Pago (Sim/Não)&#39;</span>] <span class="op">==</span> <span class="st">&#39;Sim&#39;</span>][<span class="st">&#39;Valor Mensal&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Total de aluguéis pagos: R$ </span><span class="sc">{</span>total_pagos<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. Calcular total geral de aluguéis</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>total_geral <span class="op">=</span> df[<span class="st">&#39;Valor Mensal&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Total geral de aluguéis: R$ </span><span class="sc">{</span>total_geral<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. Calcular porcentagem de inadimplência</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>porcentagem_inadimplencia <span class="op">=</span> (total_inadimplentes <span class="op">/</span> total_geral) <span class="op">*</span> <span class="dv">100</span> <span class="cf">if</span> total_geral <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Porcentagem de inadimplência: </span><span class="sc">{</span>porcentagem_inadimplencia<span class="sc">:.2f}</span><span class="ss">%&quot;</span>)</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 10. Exibir relatório final</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Relatório Final:&quot;</span>)</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Total de aluguéis em aberto: R$ </span><span class="sc">{</span>total_inadimplentes<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Total de aluguéis pagos: R$ </span><span class="sc">{</span>total_pagos<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Total geral de aluguéis: R$ </span><span class="sc">{</span>total_geral<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a><span class="co"># 11. Salvar relatório final</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>relatorio_final <span class="op">=</span> {</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Total Aluguéis em Aberto&#39;</span>: [total_inadimplentes],</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Total Aluguéis Pagos&#39;</span>: [total_pagos],</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Total Geral de Aluguéis&#39;</span>: [total_geral],</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Porcentagem de Inadimplência&#39;</span>: [porcentagem_inadimplencia]</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>relatorio_df <span class="op">=</span> pd.DataFrame(relatorio_final)</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>relatorio_df.to_excel(<span class="vs">r&#39;C:</span><span class="dv">\d</span><span class="vs">ev</span><span class="er">\</span><span class="vs">python_escritorios</span><span class="er">\</span><span class="vs">codes</span><span class="ch">\r</span><span class="vs">elatorio_final</span><span class="dv">.</span><span class="vs">xlsx&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a><span class="co"># 12. Exibir mensagem de conclusão</span></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Relatório final salvo com sucesso em &#39;relatorio_final.xlsx&#39;.&quot;</span>)</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a><span class="co"># 13. Fim do script</span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Processamento concluído.&quot;</span>)</span></code></pre></div>
<h3
id="adendo-exercicio-pratico-envio-real-de-e-mails-para-inquilinos-inadimplentes">Adendo
- Exercício Prático: Envio Real de E-mails para Inquilinos
Inadimplentes</h3>
<p>Além de gerar o relatório de inadimplentes, é possível automatizar o
envio de e-mails reais para cada inquilino com aluguel em aberto
utilizando Python.</p>
<p><strong>Como fazer:</strong></p>
<ol type="1">
<li><p><strong>Adicione uma coluna “E-mail”</strong> na planilha
<code>alugueis.xlsx</code> com o endereço de e-mail de cada
inquilino.</p></li>
<li><p><strong>Utilize a biblioteca <code>smtplib</code></strong> do
Python para enviar e-mails automáticos. É recomendado utilizar uma conta
de e-mail dedicada e, no caso do Gmail, gerar uma senha de aplicativo
para maior segurança.</p></li>
<li><p><strong>Exemplo de código Python:</strong><br />
O código completo para geração do relatório de inadimplentes e envio
real de e-mails está disponível no arquivo:</p></li>
</ol>
<p><strong>Código Python para envio de e-mails:</strong></p>
<p><code>codes/03_exemplo_pratico_alugueis_com_email.py</code></p>
<ol start="4" type="1">
<li><strong>Exemplo de Planilha de Aluguéis com E-mail dos
Inquilinos</strong></li>
</ol>
<pre class="plaintext"><code>|-----------|-------------------|--------------|--------------------|----------------|----------------------|
| Imóvel    | Inquilino         | Valor Mensal | Data de Vencimento | Pago (Sim/Não) | E-mail               |
|-----------|-------------------|--------------|--------------------|----------------|----------------------|
| Apto 101  | João da Silva     | 1800         | 2025-06-10         | Sim            | joao@email.com       |
| Casa 202  | Maria Souza       | 2500         | 2025-06-15         | Não            | maria@email.com      |
| Loja 303  | Pedro Lima        | 3200         | 2025-06-20         | Não            | pedro@email.com      |
| Apto 104  | Ana Martins       | 2000         | 2025-06-12         | Sim            | ana@email.com        |
| Casa 205  | Bruno Carvalho    | 2700         | 2025-06-18         | Não            | bruno@email.com      |
| Loja 307  | Carla Mendes      | 3500         | 2025-06-25         | Sim            | carla@email.com      |
| Apto 110  | Felipe Gonçalves  | 2100         | 2025-06-14         | Não            | felipe@email.com     |
| Casa 208  | Luciana Ferreira  | 2600         | 2025-06-22         | Não            | luciana@email.com    |
|-----------|-------------------|--------------|--------------------|----------------|----------------------|</code></pre>
<p><strong>Atenção:</strong></p>
<ul>
<li>Nunca compartilhe senhas em código público.</li>
<li>Teste o envio com poucos destinatários antes de usar em
produção.</li>
<li>Certifique-se de que o envio de e-mails está de acordo com as
políticas da sua empresa e com a legislação vigente (LGPD).</li>
</ul>
<p>Com essa automação, a empresa pode agilizar a comunicação com os
inquilinos inadimplentes, tornando o processo mais eficiente e reduzindo
o tempo gasto com cobranças manuais.</p>
<p><strong>Conclusão:</strong></p>
<p>Com este exercício, você praticou a leitura e escrita de arquivos
Excel, filtragem de dados com pandas. Essas habilidades são essenciais
para automatizar o controle de inadimplência em empresas de aluguel de
imóveis, tornando o processo mais eficiente e organizado.</p>
<hr />
<h3 id="exercicio-pratico-extracao-de-texto-de-um-pdf">3.6.3. Exercício
Prático: Extração de Texto de um PDF</h3>
<p><strong>História Fictícia:</strong><br />
A repartição pública “Prefeitura Municipal de Campo Largo, do Estado do
Paraná” recebe diariamente diversos documentos em PDF, como ofícios,
requerimentos e certidões. A servidora Ana precisa extrair rapidamente o
texto de um ofício em PDF para copiar o conteúdo para um sistema
interno, mas fazer isso manualmente toma muito tempo.</p>
<p><strong>Desafio:</strong><br />
Ajude Ana a automatizar esse processo criando um script Python que:</p>
<ol type="1">
<li>Leia um arquivo PDF chamado <code>oficio_exemplo.pdf</code>
localizado na pasta <code>codes</code>.</li>
<li>Extraia todo o texto do documento.</li>
<li>Salve o texto extraído em um arquivo chamado
<code>oficio_extraido.txt</code> na mesma pasta.</li>
<li>Mostre na tela as primeiras linhas do texto extraído.</li>
</ol>
<p><strong>Dica:</strong><br />
Utilize a biblioteca <code>PyPDF2</code> para a extração de texto de
arquivos PDF.</p>
<p><strong>Código Python</strong>:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> PyPDF2</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Caminho do arquivo PDF</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>pdf_path <span class="op">=</span> <span class="vs">r&#39;C:</span><span class="dv">\d</span><span class="vs">ev</span><span class="er">\</span><span class="vs">python_escritorios</span><span class="er">\</span><span class="vs">codes</span><span class="er">\</span><span class="vs">oficio_exemplo</span><span class="dv">.</span><span class="vs">pdf&#39;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>txt_path <span class="op">=</span> <span class="vs">r&#39;C:</span><span class="dv">\d</span><span class="vs">ev</span><span class="er">\</span><span class="vs">python_escritorios</span><span class="er">\</span><span class="vs">codes</span><span class="er">\</span><span class="vs">oficio_extraido</span><span class="dv">.</span><span class="vs">txt&#39;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Abrir o PDF e extrair texto</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(pdf_path, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    reader <span class="op">=</span> PyPDF2.PdfReader(<span class="bu">file</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    texto <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> page <span class="kw">in</span> reader.pages:</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>        texto <span class="op">+=</span> page.extract_text()</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvar o texto extraído em um arquivo .txt</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(txt_path, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    f.write(texto)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar as primeiras linhas do texto extraído</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Primeiras linhas do texto extraído:&quot;</span>)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>.join(texto.splitlines()[:<span class="dv">10</span>]))</span></code></pre></div>
<p><strong>Observação:</strong><br />
Certifique-se de instalar a biblioteca com
<code>pip install PyPDF2</code> antes de executar o script.</p>
<p><strong>Resultado esperado:</strong></p>
<pre class="plaintext"><code>OFÍCIO Nº 123/2025 – GAB/PMNE  
 
Campo Largo, 17 de junho de 2025.  
 
Ao   
Senhor Diretor do Departamento de Recursos Humanos   
Prefeitura Municipal de Campo Largo  
 
Assunto: Solicitação de atualização cadastral  
 
Prezado Senhor,  
 
Solicito, por meio deste ofício, a gentileza de proceder à atualização dos dados 
cadastrais do servidor João da Silva, matrícula 4567, lotado no setor de Protocolo. 
Informo que houve alteração de endereço residencial e número de telefone para 
contato.  
 
Segue em anexo a documentação comprobatória.  
 
Atenciosamente,  
 
Maria Souza   
Chefe de Gabinete   
Prefeitura Municipal de Campo Largo</code></pre>
<p><strong>Conclusão:</strong></p>
<p>Com este exercício, você praticou a leitura de arquivos PDF e a
extração de texto usando Python. Essa habilidade é útil para automatizar
a coleta de informações de documentos oficiais, economizando tempo e
aumentando a eficiência no trabalho com repartições públicas.</p>
<hr />
<h3
id="exercicio-pratico-leitura-e-modificacao-de-um-arquivo-word">3.6.4.
Exercício Prático: Leitura e Modificação de um Arquivo Word</h3>
<p><strong>História Fictícia:</strong><br />
O escritório de advocacia “Silva &amp; Associados” recebe frequentemente
minutas de contratos em formato Word, enviadas por clientes e parceiros.
A advogada Júlia precisa revisar rapidamente esses contratos para
garantir que todos contenham uma cláusula padrão de confidencialidade.
Para agilizar o processo, ela deseja um script Python que leia o arquivo
Word do contrato, verifique se a cláusula está presente e, caso não
esteja, adicione automaticamente a cláusula ao final do documento.</p>
<p><strong>Desafio:</strong><br />
Crie um script Python que:</p>
<ol type="1">
<li><p>Leia um arquivo Word chamado <code>contrato_exemplo.docx</code>
localizado na pasta <code>codes</code>.</p></li>
<li><p>Verifique se o texto da cláusula de confidencialidade está
presente.</p></li>
<li><p>Caso não esteja, adicione a seguinte cláusula ao final do
documento:</p>
<blockquote>
<p><strong>Cláusula de Confidencialidade:</strong> As partes se
comprometem a manter em sigilo todas as informações trocadas em razão
deste contrato, não podendo divulgá-las a terceiros sem prévia
autorização por escrito.</p>
</blockquote></li>
<li><p>Salve o documento modificado como
<code>contrato_confidencial.docx</code> na mesma pasta.</p></li>
</ol>
<p><strong>Dica:</strong><br />
Utilize a biblioteca <code>python-docx</code> para manipulação de
arquivos Word.</p>
<p><strong>Código Python</strong>:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> docx <span class="im">import</span> Document</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Caminho do arquivo Word</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>doc_path <span class="op">=</span> <span class="vs">r&#39;C:</span><span class="dv">\d</span><span class="vs">ev</span><span class="er">\</span><span class="vs">python_escritorios</span><span class="er">\</span><span class="vs">codes</span><span class="er">\</span><span class="vs">contrato_exemplo</span><span class="dv">.</span><span class="vs">docx&#39;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>doc_novo_path <span class="op">=</span> <span class="vs">r&#39;C:</span><span class="dv">\d</span><span class="vs">ev</span><span class="er">\</span><span class="vs">python_escritorios</span><span class="er">\</span><span class="vs">codes</span><span class="er">\</span><span class="vs">contrato_confidencial</span><span class="dv">.</span><span class="vs">docx&#39;</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Cláusula de confidencialidade</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>clausa_confidencialidade <span class="op">=</span> (</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Cláusula de Confidencialidade: As partes se comprometem a manter em sigilo &quot;</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;todas as informações trocadas em razão deste contrato, não podendo divulgá-las &quot;</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;a terceiros sem prévia autorização por escrito.&quot;</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Abrir o documento Word</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>doc <span class="op">=</span> Document(doc_path)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar se a cláusula já existe</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>clausula_presente <span class="op">=</span> <span class="bu">any</span>(clausa_confidencialidade <span class="kw">in</span> par.text <span class="cf">for</span> par <span class="kw">in</span> doc.paragraphs)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> clausula_presente:</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adicionar a cláusula de confidencialidade ao final do documento</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    doc.add_paragraph(clausa_confidencialidade)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Cláusula de confidencialidade adicionada ao contrato.&quot;</span>)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Cláusula de confidencialidade já está presente no contrato.&quot;</span>)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvar o documento modificado</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>doc.save(doc_novo_path)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibir mensagem de conclusão</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Documento modificado salvo como &#39;</span><span class="sc">{</span>doc_novo_path<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span></code></pre></div>
<p><strong>Resultado esperado:</strong></p>
<pre class="plaintext"><code>Cláusula de confidencialidade adicionada ao contrato.
Documento modificado salvo como &#39;C:\dev\python_escritorios\codes\contrato_confidencial.docx&#39;</code></pre>
<p><strong>Conclusão:</strong></p>
<p>Com este exercício, você praticou a leitura e modificação de arquivos
Word usando Python. Essa habilidade é útil para automatizar a revisão de
documentos legais, garantindo que cláusulas importantes estejam sempre
presentes, economizando tempo e aumentando a eficiência no trabalho de
advogados e escritórios de advocacia.</p>
<hr />
<h1 id="automacao-de-e-mails-e-notificacoes">4. Automação de E-mails e Notificações</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>Nesta seção, você aprenderá a automatizar o envio de e-mails e
notificações usando Python. Essa habilidade é essencial para manter a
comunicação eficiente em escritórios, seja para enviar lembretes,
relatórios ou avisos importantes.</p>
<h2 id="enviando-e-mails-com-python">4.1. Enviando E-mails com
Python</h2>
<p>Para enviar e-mails com Python, você pode usar a biblioteca
<code>smtplib</code>, que permite enviar mensagens através do protocolo
SMTP. Abaixo está um exemplo básico de como enviar um e-mail:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> smtplib</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.text <span class="im">import</span> MIMEText</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Configurações do servidor SMTP</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>smtp_server <span class="op">=</span> <span class="st">&#39;smtp.gmail.com&#39;</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>smtp_port <span class="op">=</span> <span class="dv">587</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>smtp_user <span class="op">=</span> <span class="st">&#39;seu_email@gmail.com&#39;</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>smtp_password <span class="op">=</span> <span class="st">&#39;sua_senha&#39;</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para enviar e-mail</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> enviar_email(destinatario, assunto, corpo):</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Criar o objeto de mensagem</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    msg <span class="op">=</span> MIMEText(corpo)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    msg[<span class="st">&#39;Subject&#39;</span>] <span class="op">=</span> assunto</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    msg[<span class="st">&#39;From&#39;</span>] <span class="op">=</span> smtp_user</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    msg[<span class="st">&#39;To&#39;</span>] <span class="op">=</span> destinatario</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Enviar o e-mail</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> smtplib.SMTP(smtp_server, smtp_port) <span class="im">as</span> server:</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>        server.starttls()</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>        server.login(smtp_user, smtp_password)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>        server.send_message(msg)    </span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de uso</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>enviar_email(<span class="st">&#39;destinatario@example.com&#39;</span>, <span class="st">&#39;Assunto do E-mail&#39;</span>, <span class="st">&#39;Corpo do e-mail&#39;</span>)</span></code></pre></div>
<h2 id="enviando-e-mails-com-anexos">4.2. Enviando E-mails com
Anexos</h2>
<p>Para enviar e-mails com anexos, você pode usar a biblioteca
<code>email</code> para criar mensagens mais complexas. Veja o exemplo
abaixo:</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> smtplib</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.multipart <span class="im">import</span> MIMEMultipart</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.text <span class="im">import</span> MIMEText</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.base <span class="im">import</span> MIMEBase</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email <span class="im">import</span> encoders</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Configurações do servidor SMTP</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>smtp_server <span class="op">=</span> <span class="st">&#39;smtp.gmail.com&#39;</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>smtp_port <span class="op">=</span> <span class="dv">587</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>smtp_user <span class="op">=</span> <span class="st">&#39;seu_email@gmail.com&#39;</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>smtp_password <span class="op">=</span> <span class="st">&#39;sua_senha&#39;</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para enviar e-mail com anexo</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> enviar_email_com_anexo(destinatario, assunto, corpo, caminho_anexo):</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Criar o objeto de mensagem</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    msg <span class="op">=</span> MIMEMultipart()</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    msg[<span class="st">&#39;Subject&#39;</span>] <span class="op">=</span> assunto</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    msg[<span class="st">&#39;From&#39;</span>] <span class="op">=</span> smtp_user</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    msg[<span class="st">&#39;To&#39;</span>] <span class="op">=</span> destinatario</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adicionar o corpo do e-mail</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    msg.attach(MIMEText(corpo, <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adicionar o anexo</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(caminho_anexo, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> anexo:</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>        parte <span class="op">=</span> MIMEBase(<span class="st">&#39;application&#39;</span>, <span class="st">&#39;octet-stream&#39;</span>)</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>        parte.set_payload(anexo.read())</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>        encoders.encode_base64(parte)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>        parte.add_header(<span class="st">&#39;Content-Disposition&#39;</span>, <span class="ss">f&#39;attachment; filename=</span><span class="sc">{</span>caminho_anexo<span class="sc">.</span>split(<span class="st">&quot;/&quot;</span>)[<span class="op">-</span><span class="dv">1</span>]<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>        msg.attach(parte)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Enviar o e-mail</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> smtplib.SMTP(smtp_server, smtp_port) <span class="im">as</span> server:</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>        server.starttls()</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>        server.login(smtp_user, smtp_password)</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>        server.send_message(msg)</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de uso</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>enviar_email_com_anexo(</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;destinatario@example.com&#39;</span>,</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Assunto do E-mail com Anexo&#39;</span>,</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Corpo do e-mail com anexo&#39;</span>,</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;caminho/para/o/anexo.txt&#39;</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 id="enviando-notificacoes-por-e-mail">4.3. Enviando Notificações por
E-mail</h2>
<p>Para enviar notificações por e-mail, você pode usar a função
<code>enviar_email</code> que criamos anteriormente. Veja um exemplo de
como enviar um lembrete de reunião:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>enviar_email(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;destinatario@example.com&#39;</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Lembrete de Reunião&#39;</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Este é um lembrete de que você tem uma reunião agendada para amanhã às 10h.&#39;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h2 id="configurando-as-dependencias-do-ambiente-python-1">4.4.
Configurando as Dependências do Ambiente Python</h2>
<p>Para que os exemplos de envio de e-mails funcionem, você precisa ter
o Python instalado em seu ambiente, bem como as bibliotecas necessárias.
Você pode instalar as bibliotecas usando o gerenciador de pacotes
<code>pip</code>. Execute o seguinte comando no terminal:</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install secure-smtplib email</span></code></pre></div>
<h2 id="exercicios-praticos-1">4.5. Exercícios Práticos</h2>
<p>Nesta seção, você encontrará exercícios práticos para aplicar os
conceitos aprendidos sobre automação de e-mails e notificações. Esses
exercícios são projetados para serem desafiadores e ajudarão a
consolidar seu conhecimento em automação de comunicação por e-mail.</p>
<h3 id="exercicio-pratico-envio-de-relatorios-diarios-por-e-mail">4.5.1.
Exercício Prático: Envio de Relatórios Diários por E-mail</h3>
<p><strong>História:</strong> A empresa “Tech Solutions” precisa enviar
relatórios diários de vendas para a equipe de gerência. O relatório é
gerado em um arquivo Excel chamado <code>relatorio_vendas.xlsx</code>,
que contém as vendas do dia anterior. A gerente Ana deseja automatizar o
envio desse relatório por e-mail todas as manhãs.</p>
<p><strong>Desafio:</strong> Crie um script Python que:</p>
<ol type="1">
<li>Leia o arquivo <code>relatorio_vendas.xlsx</code> localizado na
pasta <code>codes</code>.</li>
<li>Envie o arquivo como anexo para o e-mail da gerente Ana, cujo
endereço é <code>ana@techsolutions.com</code>.</li>
<li>O assunto do e-mail deve ser “Relatório de Vendas - [Data
Atual]”.</li>
<li>O corpo do e-mail deve conter uma breve mensagem: “Prezada Ana,
segue em anexo o relatório de vendas do dia anterior.”</li>
<li>Certifique-se de que o e-mail seja enviado usando uma conta de
e-mail válida (por exemplo, Gmail).</li>
<li>(Opcional) Configure o script para ser executado automaticamente
todos os dias às 8h da manhã usando o agendador de tarefas do sistema
operacional (Windows Task Scheduler ou cron no Linux).</li>
</ol>
<p><strong>Código Python:</strong></p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> smtplib</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.multipart <span class="im">import</span> MIMEMultipart</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.text <span class="im">import</span> MIMEText</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.base <span class="im">import</span> MIMEBase</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email <span class="im">import</span> encoders</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Configurações do servidor SMTP</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>smtp_server <span class="op">=</span> <span class="st">&#39;smtp.gmail.com&#39;</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>smtp_port <span class="op">=</span> <span class="dv">587</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>smtp_user <span class="op">=</span> <span class="st">&#39;seu_email@gmail.com&#39;</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>smtp_password <span class="op">=</span> <span class="st">&#39;sua_senha&#39;</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para enviar e-mail com anexo</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> enviar_email_com_anexo(destinatario, assunto, corpo, caminho_anexo):</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Criar o objeto de mensagem</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    msg <span class="op">=</span> MIMEMultipart()</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    msg[<span class="st">&#39;Subject&#39;</span>] <span class="op">=</span> assunto</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    msg[<span class="st">&#39;From&#39;</span>] <span class="op">=</span> smtp_user</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    msg[<span class="st">&#39;To&#39;</span>] <span class="op">=</span> destinatario</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adicionar o corpo do e-mail</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    msg.attach(MIMEText(corpo, <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adicionar o anexo</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(caminho_anexo, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> anexo:</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>        parte <span class="op">=</span> MIMEBase(<span class="st">&#39;application&#39;</span>, <span class="st">&#39;octet-stream&#39;</span>)</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>        parte.set_payload(anexo.read())</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>        encoders.encode_base64(parte)</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>        parte.add_header(<span class="st">&#39;Content-Disposition&#39;</span>, <span class="ss">f&#39;attachment; filename=</span><span class="sc">{</span>caminho_anexo<span class="sc">.</span>split(<span class="st">&quot;/&quot;</span>)[<span class="op">-</span><span class="dv">1</span>]<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>        msg.attach(parte)</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Enviar o e-mail</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> smtplib.SMTP(smtp_server, smtp_port) <span class="im">as</span> server:</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>        server.starttls()</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>        server.login(smtp_user, smtp_password)</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>        server.send_message(msg)</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Caminho do arquivo Excel</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>excel_path <span class="op">=</span> <span class="vs">r&#39;C:</span><span class="dv">\d</span><span class="vs">ev</span><span class="er">\</span><span class="vs">python_escritorios</span><span class="er">\</span><span class="vs">codes</span><span class="ch">\r</span><span class="vs">elatorio_vendas</span><span class="dv">.</span><span class="vs">xlsx&#39;</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Ler o arquivo Excel existente</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> os.path.exists(excel_path):</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>    df_vendas <span class="op">=</span> pd.read_excel(excel_path)</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Arquivo de vendas encontrado em: </span><span class="sc">{</span>excel_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Exibir os dados de vendas no console para copiar e colar no Excel</span></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Copie e cole os dados abaixo no Excel, se desejar:&quot;</span>)</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df_vendas.to_csv(sep<span class="op">=</span><span class="st">&#39;</span><span class="ch">\t</span><span class="st">&#39;</span>, index<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Arquivo </span><span class="sc">{</span>excel_path<span class="sc">}</span><span class="ss"> não encontrado. Certifique-se de que a planilha existe com os dados prontos.&quot;</span>)</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>    exit(<span class="dv">1</span>)</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Enviar o e-mail com o relatório</span></span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>data_atual <span class="op">=</span> datetime.now().strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y&#39;</span>)</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>assunto <span class="op">=</span> <span class="ss">f&#39;Relatório de Vendas - </span><span class="sc">{</span>data_atual<span class="sc">}</span><span class="ss">&#39;</span></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>corpo <span class="op">=</span> <span class="st">&#39;Prezada Ana, segue em anexo o relatório de vendas do dia anterior.&#39;</span></span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>enviar_email_com_anexo(</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;ana@techsolutions.com&#39;</span>,</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>    assunto,</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>    corpo,</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>    excel_path</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;E-mail enviado com sucesso!&quot;</span>)</span></code></pre></div>
<p><strong>Resultado esperado:</strong></p>
<pre class="plaintext"><code>Arquivo de vendas gerado em: C:\dev\python_escritorios\codes\relatorio_vendas.xlsx
Copie e cole os dados abaixo no Excel, se desejar:
Data Produto Quantidade Valor Total
25/10/2023 Notebook 5 15000.00
E-mail enviado com sucesso!</code></pre>
<p><strong>Observações:</strong></p>
<ul>
<li>Substitua <code>seu_email@gmail.com</code> e <code>sua_senha</code>
pelas suas credenciais.</li>
<li>Instale as dependências necessárias com:<br />
<code>pip install pandas faker openpyxl</code></li>
<li>Nunca compartilhe suas credenciais em código público.</li>
<li>Considere usar senha de aplicativo ou OAuth2 para maior
segurança.</li>
</ul>
<p><strong>Conclusão:</strong></p>
<p>Com este exercício, você praticou o envio de e-mails com anexos
usando Python. Essa habilidade é essencial para automatizar a
comunicação de relatórios e documentos importantes em ambientes
corporativos, economizando tempo e aumentando a eficiência na troca de
informações.</p>
<hr />
<h3
id="exercicio-pratico-geracao-e-envio-automatico-de-relatorios-diarios-de-vendas-multiplos-dias">4.5.2.
Exercício Prático: Geração e Envio Automático de Relatórios Diários de
Vendas (Múltiplos Dias)</h3>
<p><strong>História:</strong><br />
A empresa “Tech Solutions” deseja automatizar o envio de relatórios
diários de vendas, gerando arquivos separados para cada dia e enviando
todos juntos em um único e-mail para a gerente Ana.</p>
<p><strong>Desafio:</strong><br />
Automatizar o processo de geração de dados fictícios de vendas para
vários dias, salvar um arquivo Excel para cada dia e enviar todos os
arquivos como anexos em um único e-mail.</p>
<ol type="1">
<li><strong>Geração de Dados Fictícios de Vendas para Múltiplos
Dias:</strong>
<ul>
<li>Gerar registros de vendas para vários dias usando a biblioteca
<code>Faker</code>.</li>
<li>Cada arquivo deve conter as vendas de um dia específico.</li>
</ul></li>
<li><strong>Salvando Dados em Arquivos Excel Diários:</strong>
<ul>
<li>Salvar cada dia em um arquivo Excel separado, nomeando conforme a
data.</li>
</ul></li>
<li><strong>Exibindo Dados no Console:</strong>
<ul>
<li>Exibir os dados de cada dia no console para conferência.</li>
</ul></li>
<li><strong>Envio de Todos os Relatórios em um Único E-mail:</strong>
<ul>
<li>Enviar todos os arquivos gerados como anexos em um único e-mail para
a gerente Ana (<code>ana@techsolutions.com</code>).</li>
</ul></li>
</ol>
<p><strong>Código Python:</strong><br />
Veja o arquivo
<code>codes/08_exemplo_pratico_envio_relatorio_diario.py</code> para o
exemplo completo.</p>
<p><strong>Resumo do Aprendizado:</strong></p>
<ul>
<li>Geração de dados para múltiplos dias.</li>
<li>Manipulação e criação dinâmica de múltiplos arquivos Excel.</li>
<li>Envio de múltiplos anexos em um único e-mail.</li>
<li>Organização de arquivos em pastas.</li>
</ul>
<hr />
<h2
id="consideracoes-de-seguranca-oauth2-aplicativos-menos-seguros">4.6.
Considerações de Segurança (OAuth2, aplicativos menos seguros)</h2>
<p>Ao automatizar o envio de e-mails, é importante considerar as
implicações de segurança. O uso de senhas em texto claro, como mostrado
nos exemplos, não é recomendado para ambientes de produção.</p>
<h3 id="oauth2">4.6.1. OAuth2</h3>
<p>Uma abordagem mais segura é usar OAuth2 para autenticação. O OAuth2 é
um protocolo de autorização que permite que aplicativos de terceiros
acessem suas informações sem precisar compartilhar suas senhas.</p>
<p><strong>Vantagens do OAuth2:</strong></p>
<ul>
<li><strong>Segurança:</strong> Não é necessário armazenar senhas em
texto claro.</li>
<li><strong>Controle:</strong> É possível revogar o acesso a qualquer
momento.</li>
<li><strong>Escopo:</strong> É possível limitar o acesso a apenas
determinadas informações.</li>
</ul>
<p><strong>Como Usar OAuth2 com Python:</strong></p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> oauth2client.service_account <span class="im">import</span> ServiceAccountCredentials</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gspread</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Configurar o escopo e as credenciais</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>escopo <span class="op">=</span> [<span class="st">&#39;https://www.googleapis.com/auth/spreadsheets&#39;</span>]</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>credenciais <span class="op">=</span> ServiceAccountCredentials.from_json_keyfile_name(<span class="st">&#39;caminho/para/credenciais.json&#39;</span>, escopo)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Autenticar e acessar o Google Sheets</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>cliente <span class="op">=</span> gspread.authorize(credenciais)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>planilha <span class="op">=</span> cliente.<span class="bu">open</span>(<span class="st">&#39;Nome da Planilha&#39;</span>).sheet1</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Ler dados da planilha</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>dados <span class="op">=</span> planilha.get_all_records()</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dados)</span></code></pre></div>
<h3 id="aplicativos-menos-seguros">4.6.2. Aplicativos Menos Seguros</h3>
<p>Se você estiver usando o Gmail, é possível que precise permitir o
acesso de “aplicativos menos seguros” para que o envio de e-mails
funcione. No entanto, essa opção reduz a segurança da sua conta e não é
recomendada.</p>
<p><strong>Como Ativar:</strong></p>
<ol type="1">
<li>Acesse sua conta do Google.</li>
<li>Vá para “Segurança”.</li>
<li>Na seção “Acesso a app menos seguro”, ative a opção “Permitir
aplicativos menos seguros”.</li>
</ol>
<p><strong>Atenção:</strong></p>
<ul>
<li>Essa opção pode não estar disponível para contas do Google Workspace
(antigo G Suite).</li>
<li>O Google pode bloquear o acesso de aplicativos menos seguros a
qualquer momento, afetando a funcionalidade do seu aplicativo.</li>
</ul>
<h3 id="conclusao">4.6.3. Conclusão</h3>
<p>Neste capítulo, você aprendeu sobre considerações de segurança ao
automatizar o envio de e-mails. A utilização de OAuth2 é a abordagem
recomendada para garantir a segurança das suas credenciais e
informações.</p>
<hr />
<h1 id="web-scraping-e-automacao-de-sites">5. Web scraping e automação de sites</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>Nesta seção, você aprenderá como extrair dados de sites e automatizar
interações com páginas web utilizando Python. O web scraping permite
coletar informações de páginas da internet de forma automatizada,
facilitando tarefas como atualização de preços, monitoramento de
concorrentes, coleta de dados públicos, entre outros. Além disso, a
automação de sites possibilita simular ações humanas, como preencher
formulários, clicar em botões e navegar por páginas automaticamente,
tornando processos repetitivos mais rápidos e eficientes.</p>
<p>Você verá exemplos práticos usando as bibliotecas
<code>requests</code> e <code>BeautifulSoup</code> para extração de
dados, além de dicas para lidar com tabelas HTML e boas práticas para
respeitar as políticas dos sites.</p>
<hr />
<h2 id="introducao-ao-web-scraping">5.1. Introdução ao Web Scraping</h2>
<p>Web scraping é o processo de extrair dados de sites. Com Python, você
pode usar bibliotecas como <code>BeautifulSoup</code> e
<code>requests</code> para realizar essa tarefa. Abaixo está um exemplo
básico de como fazer web scraping:</p>
<p><strong>Código Python:</strong></p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># URL do site que você deseja extrair dados</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">&#39;https://example.com&#39;</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Fazer uma requisição HTTP para obter o conteúdo da página</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> requests.get(url)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar se a requisição foi bem-sucedida</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> response.status_code <span class="op">==</span> <span class="dv">200</span>:</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Analisar o conteúdo da página</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    soup <span class="op">=</span> BeautifulSoup(response.text, <span class="st">&#39;html.parser&#39;</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extrair informações específicas</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    dados <span class="op">=</span> soup.find_all(<span class="st">&#39;div&#39;</span>, class_<span class="op">=</span><span class="st">&#39;informacao&#39;</span>)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> dado <span class="kw">in</span> dados:</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(dado.text)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Erro ao acessar o site: </span><span class="sc">{</span>response<span class="sc">.</span>status_code<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<p><strong>Resultado esperado</strong>:</p>
<pre class="plaintext"><code>Informação 1
Informação 2
Informação 3</code></pre>
<h3 id="boas-praticas-de-web-scraping">5.1.1. Boas Práticas de Web
Scraping</h3>
<p>Ao realizar web scraping, é importante seguir algumas boas práticas
para garantir que você não cause problemas ao site que está acessando e
para respeitar as regras de uso. Aqui estão algumas dicas:</p>
<ul>
<li><strong>Respeite o <code>robots.txt</code>:</strong> Verifique se o
site permite scraping e quais páginas podem ser acessadas.</li>
<li><strong>Não sobrecarregue o servidor:</strong> Faça requisições com
intervalos de tempo razoáveis para evitar sobrecarga no site.</li>
<li><strong>Use User-Agent:</strong> Inclua um cabeçalho
<code>User-Agent</code> na sua requisição para identificar seu script
como um navegador legítimo.</li>
<li><strong>Armazene os dados de forma estruturada:</strong> Utilize
formatos como CSV, JSON ou bancos de dados para armazenar os dados
extraídos.</li>
<li><strong>Mantenha a ética:</strong> Não use scraping para coletar
informações sensíveis ou violar os termos de serviço do site.</li>
</ul>
<h2 id="extraindo-dados-de-tabelas-html">5.2. Extraindo Dados de Tabelas
HTML</h2>
<p>Para extrair dados de tabelas HTML, você pode usar o
<code>pandas</code> junto com <code>BeautifulSoup</code>. Veja como
fazer isso:</p>
<p><strong>Código Python:</strong></p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># URL do site com a tabela</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">&#39;https://example.com/tabela&#39;</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fazer uma requisição HTTP para obter o conteúdo da página</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> requests.get(url)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar se a requisição foi bem-sucedida</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> response.status_code <span class="op">==</span> <span class="dv">200</span>:</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Analisar o conteúdo da página</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    soup <span class="op">=</span> BeautifulSoup(response.text, <span class="st">&#39;html.parser&#39;</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Encontrar a tabela</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    tabela <span class="op">=</span> soup.find(<span class="st">&#39;table&#39;</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ler a tabela usando pandas</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.read_html(<span class="bu">str</span>(tabela))[<span class="dv">0</span>]</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df)  <span class="co"># Exibir os dados da tabela</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Erro ao acessar o site: </span><span class="sc">{</span>response<span class="sc">.</span>status_code<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<p><strong>Resultado esperado:</strong></p>
<pre class="plaintext"><code>   Coluna1  Coluna2  Coluna3
0  Dado1    Dado2    Dado3
1  Dado4    Dado5    Dado6
2  Dado7    Dado8    Dado9</code></pre>
<h3 id="manipulando-dados-extraidos">5.2.1. Manipulando Dados
Extraídos</h3>
<p>Após extrair os dados de uma tabela HTML, você pode manipulá-los
usando as funcionalidades do <code>pandas</code>. Por exemplo, você pode
filtrar, agrupar ou transformar os dados conforme necessário.</p>
<p><strong>Exemplo de manipulação de dados:</strong></p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar dados onde Coluna1 é igual a &#39;Dado1&#39;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>dados_filtrados <span class="op">=</span> df[df[<span class="st">&#39;Coluna1&#39;</span>] <span class="op">==</span> <span class="st">&#39;Dado1&#39;</span>]</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dados_filtrados)</span></code></pre></div>
<p><strong>Resultado esperado:</strong></p>
<pre class="plaintext"><code>   Coluna1  Coluna2  Coluna3
0  Dado1    Dado2    Dado3</code></pre>
<h2 id="automacao-de-sites-com-selenium">5.3. Automação de Sites com
Selenium</h2>
<p>O Selenium é uma das ferramentas mais poderosas para automação de
navegadores web. Com ele, é possível simular praticamente qualquer ação
que um usuário humano faria em um site: clicar em botões, preencher
formulários, rolar páginas, fazer login, baixar arquivos e até mesmo
interagir com elementos dinâmicos carregados por JavaScript.</p>
<p>Essa abordagem é especialmente útil para automatizar tarefas em
sistemas web internos, portais de clientes, ou para coletar dados de
sites que exigem autenticação ou navegação dinâmica. O Selenium suporta
diversos navegadores, como Chrome, Firefox e Edge, e pode ser integrado
a scripts Python para criar robôs de automação robustos.</p>
<h3 id="principais-recursos-do-selenium">Principais recursos do
Selenium</h3>
<ul>
<li><strong>Automação de login e navegação:</strong> Preencha campos de
usuário e senha, clique em botões de login e navegue por diferentes
páginas automaticamente.</li>
<li><strong>Interação com elementos dinâmicos:</strong> Clique em menus,
marque checkboxes, selecione opções em listas suspensas e interaja com
pop-ups.</li>
<li><strong>Extração de dados após autenticação:</strong> Acesse áreas
restritas de sites e colete informações que não estão disponíveis
publicamente.</li>
<li><strong>Execução de tarefas repetitivas:</strong> Automatize
processos como cadastro de informações, download de relatórios, envio de
formulários e muito mais.</li>
</ul>
<h3 id="quando-usar-selenium">Quando usar Selenium?</h3>
<ul>
<li>Quando o site depende fortemente de JavaScript para carregar
dados.</li>
<li>Quando é necessário simular ações humanas completas (login,
navegação, cliques).</li>
<li>Quando outras bibliotecas de scraping (como requests +
BeautifulSoup) não conseguem acessar o conteúdo desejado.</li>
</ul>
<h3 id="instalando-o-selenium">5.3.1. Instalando o Selenium</h3>
<p>Para usar o Selenium, instale a biblioteca e baixe o driver do
navegador correspondente (por exemplo, ChromeDriver para Google
Chrome):</p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install selenium</span></code></pre></div>
<p>Baixe o ChromeDriver em: <a
href="https://sites.google.com/chromium.org/driver/"
class="uri">https://sites.google.com/chromium.org/driver/</a></p>
<h3 id="exemplo-de-automacao-com-selenium">5.3.2. Exemplo de Automação
com Selenium</h3>
<p>O exemplo abaixo mostra como automatizar o login em um site e extrair
informações após o acesso:</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selenium <span class="im">import</span> webdriver</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selenium.webdriver.common.by <span class="im">import</span> By</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selenium.webdriver.common.keys <span class="im">import</span> Keys</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Configurar o driver do navegador (certifique-se de que o ChromeDriver está no PATH)</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>driver <span class="op">=</span> webdriver.Chrome()  <span class="co"># ou webdriver.Firefox() para Firefox</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Abrir a página de login</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>driver.get(<span class="st">&#39;https://example.com/login&#39;</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Encontrar os campos de login e senha</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>username_field <span class="op">=</span> driver.find_element(By.NAME, <span class="st">&#39;username&#39;</span>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>password_field <span class="op">=</span> driver.find_element(By.NAME, <span class="st">&#39;password&#39;</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Preencher os campos de login</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>username_field.send_keys(<span class="st">&#39;seu_usuario&#39;</span>)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>password_field.send_keys(<span class="st">&#39;sua_senha&#39;</span>)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Enviar o formulário (pressionar Enter)</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>password_field.send_keys(Keys.RETURN)</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Esperar alguns segundos para a página carregar após o login</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>time.sleep(<span class="dv">5</span>)</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Extrair informações da página após o login</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>dados <span class="op">=</span> driver.find_elements(By.CLASS_NAME, <span class="st">&#39;informacao&#39;</span>)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> dado <span class="kw">in</span> dados:</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(dado.text)</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Fechar o navegador</span></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>driver.quit()</span></code></pre></div>
<p><strong>Resultado esperado:</strong></p>
<pre class="plaintext"><code>Informação 1
Informação 2
Informação 3</code></pre>
<h3 id="dicas-e-boas-praticas-com-selenium">5.3.3. Dicas e Boas Práticas
com Selenium</h3>
<ul>
<li><strong>Espere elementos carregarem:</strong> Use
<code>time.sleep()</code> para aguardar carregamentos simples, ou
prefira <code>WebDriverWait</code> para esperar elementos
específicos.</li>
<li><strong>Evite hardcoding de caminhos:</strong> Utilize seletores
robustos (por exemplo, <code>By.ID</code>, <code>By.NAME</code>,
<code>By.CSS_SELECTOR</code>) para localizar elementos.</li>
<li><strong>Automatize downloads:</strong> É possível configurar o
navegador para baixar arquivos automaticamente para uma pasta
específica.</li>
<li><strong>Cuidado com bloqueios:</strong> Sites podem detectar
automação. Use User-Agent customizado e intervalos realistas entre
ações.</li>
<li><strong>Feche o navegador ao final:</strong> Sempre chame
<code>driver.quit()</code> para liberar recursos do sistema.</li>
</ul>
<h3 id="exemplos-de-interacao-com-elementos">5.3.4. Exemplos de
Interação com Elementos</h3>
<ul>
<li><strong>Clicar em botões:</strong></li>
</ul>
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>botao <span class="op">=</span> driver.find_element(By.ID, <span class="st">&#39;botaoEnviar&#39;</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>botao.click()</span></code></pre></div>
<ul>
<li><strong>Preencher campos de texto:</strong></li>
</ul>
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>campo_texto <span class="op">=</span> driver.find_element(By.NAME, <span class="st">&#39;campoTexto&#39;</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>campo_texto.send_keys(<span class="st">&#39;Texto a ser preenchido&#39;</span>)</span></code></pre></div>
<ul>
<li><strong>Selecionar opções em dropdowns:</strong></li>
</ul>
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selenium.webdriver.support.ui <span class="im">import</span> Select</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>select_element <span class="op">=</span> driver.find_element(By.ID, <span class="st">&#39;dropdown&#39;</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>select <span class="op">=</span> Select(select_element)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>select.select_by_visible_text(<span class="st">&#39;Opção 1&#39;</span>)</span></code></pre></div>
<ul>
<li><strong>Navegar para outra página:</strong></li>
</ul>
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>driver.get(<span class="st">&#39;https://example.com/outra_pagina&#39;</span>)</span></code></pre></div>
<p>Com o Selenium, você pode criar robôs que automatizam tarefas
repetitivas em sistemas web, economizando tempo e reduzindo erros
manuais em processos do escritório.</p>
<hr />
<h1 id="criacao-de-interfaces-graficas-simples-tkinter-ou-pywebio"> Criação de interfaces gráficas simples (Tkinter ou PyWebIO)</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>Nesta seção, você aprenderá a criar interfaces gráficas simples para
suas aplicações de automação. Interfaces gráficas são importantes para
tornar suas ferramentas mais amigáveis e acessíveis, permitindo que
usuários interajam com suas automações de forma mais intuitiva.</p>
<p>Você verá exemplos de como criar janelas, botões, campos de texto e
outros elementos gráficos usando as bibliotecas Tkinter e PyWebIO. Além
disso, aprenderá a coletar entradas de usuários e exibir resultados de
forma visual.</p>
<hr />
<h2 id="introducao-ao-tkinter">6.1. Introdução ao Tkinter</h2>
<p>Tkinter é a biblioteca padrão do Python para criação de interfaces
gráficas. Com ela, é possível criar janelas, diálogos, botões, menus e
outros elementos gráficos de forma simples e rápida.</p>
<h3 id="exemplo-basico-de-uma-janela-tkinter">Exemplo básico de uma
janela Tkinter</h3>
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tkinter <span class="im">as</span> tk</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Função chamada ao clicar no botão</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ao_clicar():</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Botão clicado!&quot;</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar a janela principal</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>janela <span class="op">=</span> tk.Tk()</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>janela.title(<span class="st">&quot;Minha Primeira Janela&quot;</span>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar um botão e adicionar à janela</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>botao <span class="op">=</span> tk.Button(janela, text<span class="op">=</span><span class="st">&quot;Clique Aqui&quot;</span>, command<span class="op">=</span>ao_clicar)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>botao.pack()</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Iniciar o loop da interface</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>janela.mainloop()</span></code></pre></div>
<p><strong>Resultado esperado:</strong></p>
<p>Uma janela com um botão. Ao clicar no botão, a mensagem “Botão
clicado!” deve aparecer no console.</p>
<h2 id="coletando-entradas-de-usuario">6.2. Coletando Entradas de
Usuário</h2>
<p>É possível coletar entradas de usuário através de campos de texto,
caixas de seleção, botões de opção, entre outros.</p>
<h3 id="exemplo-de-coleta-de-entrada">Exemplo de coleta de entrada</h3>
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tkinter <span class="im">as</span> tk</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Função chamada ao clicar no botão</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mostrar_nome():</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    nome <span class="op">=</span> entrada_nome.get()</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    label_resultado.config(text<span class="op">=</span><span class="ss">f&quot;Olá, </span><span class="sc">{</span>nome<span class="sc">}</span><span class="ss">!&quot;</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar a janela principal</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>janela <span class="op">=</span> tk.Tk()</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>janela.title(<span class="st">&quot;Coletando Entradas&quot;</span>)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar um rótulo (label)</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>label_instrucoes <span class="op">=</span> tk.Label(janela, text<span class="op">=</span><span class="st">&quot;Digite seu nome:&quot;</span>)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>label_instrucoes.pack()</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar um campo de entrada de texto</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>entrada_nome <span class="op">=</span> tk.Entry(janela)</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>entrada_nome.pack()</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar um botão</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>botao <span class="op">=</span> tk.Button(janela, text<span class="op">=</span><span class="st">&quot;Enviar&quot;</span>, command<span class="op">=</span>mostrar_nome)</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>botao.pack()</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar um rótulo para exibir o resultado</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>label_resultado <span class="op">=</span> tk.Label(janela, text<span class="op">=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>label_resultado.pack()</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Iniciar o loop da interface</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>janela.mainloop()</span></code></pre></div>
<p><strong>Resultado esperado:</strong></p>
<p>Uma janela com um campo de texto, um botão e um rótulo. O usuário
deve digitar seu nome no campo de texto, clicar no botão e ver seu nome
sendo exibido no rótulo.</p>
<h2 id="introducao-ao-pywebio">6.3. Introdução ao PyWebIO</h2>
<p>PyWebIO é uma biblioteca que permite criar interfaces web interativas
diretamente em scripts Python, sem a necessidade de conhecimentos em
HTML ou CSS. É uma ótima opção para quem deseja criar rapidamente
interfaces para suas aplicações de automação.</p>
<h3 id="exemplo-basico-de-uso-do-pywebio">Exemplo básico de uso do
PyWebIO</h3>
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pywebio <span class="im">import</span> start_server</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pywebio.output <span class="im">import</span> put_text</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pywebio.<span class="bu">input</span> <span class="im">import</span> <span class="bu">input</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Função principal da aplicação</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> app():</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    nome <span class="op">=</span> <span class="bu">input</span>(<span class="st">&quot;Qual é o seu nome?&quot;</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    put_text(<span class="ss">f&quot;Olá, </span><span class="sc">{</span>nome<span class="sc">}</span><span class="ss">! Bem-vindo à automação com Python.&quot;</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Iniciar o servidor web</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>start_server(app, port<span class="op">=</span><span class="dv">8080</span>)</span></code></pre></div>
<p><strong>Resultado esperado:</strong></p>
<p>Ao executar o script, um servidor web será iniciado. Acesse
<code>http://localhost:8080</code> no navegador para interagir com a
aplicação.</p>
<h2 id="criando-formularios-simples">6.4. Criando Formulários
Simples</h2>
<p>Tanto no Tkinter quanto no PyWebIO, é possível criar formulários para
coletar informações de usuários.</p>
<h3 id="exemplo-de-formulario-no-tkinter">Exemplo de formulário no
Tkinter</h3>
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tkinter <span class="im">as</span> tk</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Função chamada ao enviar o formulário</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> enviar_formulario():</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    nome <span class="op">=</span> entrada_nome.get()</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    email <span class="op">=</span> entrada_email.get()</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Nome: </span><span class="sc">{</span>nome<span class="sc">}</span><span class="ss">, Email: </span><span class="sc">{</span>email<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar a janela principal</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>janela <span class="op">=</span> tk.Tk()</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>janela.title(<span class="st">&quot;Formulário de Contato&quot;</span>)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar campos de entrada</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>label_nome <span class="op">=</span> tk.Label(janela, text<span class="op">=</span><span class="st">&quot;Nome:&quot;</span>)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>label_nome.pack()</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>entrada_nome <span class="op">=</span> tk.Entry(janela)</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>entrada_nome.pack()</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>label_email <span class="op">=</span> tk.Label(janela, text<span class="op">=</span><span class="st">&quot;Email:&quot;</span>)</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>label_email.pack()</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>entrada_email <span class="op">=</span> tk.Entry(janela)</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>entrada_email.pack()</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar botão de envio</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>botao_enviar <span class="op">=</span> tk.Button(janela, text<span class="op">=</span><span class="st">&quot;Enviar&quot;</span>, command<span class="op">=</span>enviar_formulario)</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>botao_enviar.pack()</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Iniciar o loop da interface</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>janela.mainloop()</span></code></pre></div>
<h3 id="exemplo-de-formulario-no-pywebio">Exemplo de formulário no
PyWebIO</h3>
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pywebio <span class="im">import</span> start_server</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pywebio.<span class="bu">input</span> <span class="im">import</span> input_group</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pywebio.output <span class="im">import</span> put_text</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Função principal da aplicação</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> app():</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    dados <span class="op">=</span> input_group(<span class="st">&quot;Formulário de Contato&quot;</span>, [</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">input</span>(<span class="st">&quot;Nome:&quot;</span>),</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">input</span>(<span class="st">&quot;Email:&quot;</span>)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    put_text(<span class="ss">f&quot;Nome: </span><span class="sc">{</span>dados[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">, Email: </span><span class="sc">{</span>dados[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Iniciar o servidor web</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>start_server(app, port<span class="op">=</span><span class="dv">8080</span>)</span></code></pre></div>
<hr />
<h1 id="parte-ii-automacao-de-escritorios">Parte II: Automação de
Escritórios</h1>
<p>Nesta parte do livro, você aprenderá como aplicar os conceitos de
automação em ambientes de escritório, focando em tarefas comuns que
podem ser automatizadas para aumentar a eficiência, reduzir erros e
liberar tempo para atividades mais estratégicas. Serão apresentados
exemplos práticos e projetos reais, organizados por tipo de escritório,
para que você possa adaptar as soluções à sua realidade
profissional.</p>
<p>Ao longo dos próximos capítulos, você verá como automatizar:</p>
<ul>
<li>A geração de documentos legais e o controle de prazos processuais em
escritórios de advocacia.</li>
<li>A leitura e consolidação de extratos bancários, geração de guias de
impostos e envio automático de boletos em escritórios de
contabilidade.</li>
<li>O acompanhamento de entregas, roteirização de rotas e geração de
manifestos em escritórios de logística.</li>
<li>A leitura de pedidos, atualização de estoque e envio de notas
fiscais em e-commerces e empresas de vendas online.</li>
<li>O controle de protocolos, conversão de tabelas e automação de
rotinas em escritórios que prestam serviços para repartições públicas e
órgãos governamentais.</li>
</ul>
<p>Cada seção traz exemplos práticos, dicas e exercícios para consolidar
o aprendizado e estimular a criatividade na busca por novas
automações.</p>
<hr />
<h1 id="escritorios-de-advocacia">Escritórios de Advocacia</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>Os escritórios de advocacia lidam diariamente com uma grande
quantidade de documentos, prazos processuais e consultas a sistemas
jurídicos. A automação dessas tarefas pode trazer ganhos significativos
de produtividade, reduzir erros e liberar tempo para atividades mais
estratégicas, como o atendimento ao cliente e a elaboração de peças
jurídicas.</p>
<p>Neste capítulo, você aprenderá como aplicar Python para automatizar
processos comuns em escritórios de advocacia, tornando o trabalho mais
eficiente e seguro. Serão apresentados exemplos práticos que podem ser
adaptados à rotina de diferentes escritórios, facilitando a gestão de
documentos, o controle de prazos e a consulta a sites de tribunais.</p>
<p>A seguir, você verá como automatizar:</p>
<ul>
<li>A geração de documentos legais, como procurações e petições, a
partir de modelos pré-definidos.</li>
<li>O controle de prazos processuais com alertas por e-mail.</li>
<li>A leitura e extração de informações de documentos PDF e Word.</li>
<li>A automação de consultas a sites de tribunais e a extração de dados
relevantes.</li>
</ul>
<hr />
<h2
id="gerador-automatico-de-procuracoes-e-peticoes-a-partir-de-modelos">7. Gerador automático de procurações e petições a partir de modelos</h2>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>A criação de procurações e petições é uma tarefa comum e essencial no
dia a dia de um escritório de advocacia. No entanto, preencher esses
documentos manualmente pode ser demorado e sujeito a erros. Neste
exemplo, vamos mostrar como automatizar a geração de procurações e
petições a partir de modelos pré-definidos, utilizando Python e a
biblioteca <code>docx</code> para manipulação de arquivos do Word.</p>
<h2 id="objetivo">7.1. Objetivo</h2>
<p>O objetivo deste exemplo é criar um script que:</p>
<ul>
<li>Leia um modelo de procuração ou petição, previamente elaborado em um
arquivo do Word.</li>
<li>Substitua automaticamente os campos variáveis (como nome do cliente,
CPF, data, etc.) pelas informações fornecidas pelo usuário.</li>
<li>Salve o documento preenchido com um novo nome, indicando que se
trata de um documento personalizado.</li>
</ul>
<h2 id="estrutura-do-codigo">7.2. Estrutura do Código</h2>
<p>O código será estruturado em funções, para facilitar a leitura e a
manutenção. As principais funções serão:</p>
<ul>
<li><code>ler_modelo()</code>: Para ler o arquivo modelo da procuração
ou petição.</li>
<li><code>preencher_documento()</code>: Para substituir os campos
variáveis pelas informações do cliente.</li>
<li><code>salvar_documento()</code>: Para salvar o documento preenchido
com um novo nome.</li>
</ul>
<h2 id="exemplo-de-codigo">7.3. Exemplo de Código</h2>
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> docx <span class="im">import</span> Document</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para ler o modelo de documento</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ler_modelo(caminho_modelo):</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Document(caminho_modelo)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para preencher o documento com os dados do cliente</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> preencher_documento(doc, dados_cliente):</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> par <span class="kw">in</span> doc.paragraphs:</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> chave, valor <span class="kw">in</span> dados_cliente.items():</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="ss">f&#39;</span><span class="ch">{{{{</span><span class="sc">{</span>chave<span class="sc">}</span><span class="ch">}}}}</span><span class="ss">&#39;</span> <span class="kw">in</span> par.text:</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>                par.text <span class="op">=</span> par.text.replace(<span class="ss">f&#39;</span><span class="ch">{{{{</span><span class="sc">{</span>chave<span class="sc">}</span><span class="ch">}}}}</span><span class="ss">&#39;</span>, valor)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> doc</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para salvar o documento preenchido</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> salvar_documento(doc, caminho_saida):</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>    doc.save(caminho_saida)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de uso</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>modelo_path <span class="op">=</span> <span class="st">&#39;modelo_procuracao.docx&#39;</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>saida_path <span class="op">=</span> <span class="st">&#39;procuracao_preenchida.docx&#39;</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>dados_cliente <span class="op">=</span> {</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;nome&#39;</span>: <span class="st">&#39;João da Silva&#39;</span>,</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;cpf&#39;</span>: <span class="st">&#39;123.456.789-00&#39;</span>,</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;data&#39;</span>: <span class="st">&#39;01/06/2025&#39;</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Ler o modelo</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>doc <span class="op">=</span> ler_modelo(modelo_path)</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Preencher o documento</span></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>doc_preenchido <span class="op">=</span> preencher_documento(doc, dados_cliente)</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvar o documento preenchido</span></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>salvar_documento(doc_preenchido, saida_path)</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Procuração gerada com sucesso: </span><span class="sc">{</span>saida_path<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h2 id="consideracoes-finais">7.4. Considerações Finais</h2>
<p>A automação da geração de procurações e petições pode trazer ganhos
significativos de produtividade para escritórios de advocacia, além de
reduzir a possibilidade de erros na elaboração desses documentos. Com o
uso de modelos e a automação do preenchimento, é possível agilizar o
trabalho e garantir maior precisão e padronização nos documentos
gerados.</p>
<hr />
<h1
id="controle-de-prazos-processuais-leitura-de-planilhas-envio-de-alertas-por-e-mail">8.
Controle de prazos processuais (leitura de planilhas + envio de alertas
por e-mail)</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>O controle de prazos processuais é uma atividade crítica para
escritórios de advocacia, pois o não cumprimento de prazos pode resultar
em prejuízos financeiros e danos à reputação do escritório. Neste
exemplo, vamos mostrar como automatizar o controle de prazos
processuais, utilizando Python para ler planilhas com os prazos e enviar
alertas por e-mail quando os prazos estiverem se aproximando.</p>
<h2 id="objetivo-1">8.1. Objetivo</h2>
<p>O objetivo deste exemplo é criar um script que:</p>
<ul>
<li>Leia uma planilha com os prazos processuais, contendo informações
como número do processo, descrição do prazo, data de início e data de
término.</li>
<li>Verifique quais prazos estão próximos do vencimento (por exemplo,
faltando 3 dias ou menos).</li>
<li>Envie um e-mail de alerta para o responsável pelo processo,
informando sobre o prazo iminente.</li>
</ul>
<h2 id="estrutura-do-codigo-1">8.2. Estrutura do Código</h2>
<p>O código será estruturado em funções, para facilitar a leitura e a
manutenção. As principais funções serão:</p>
<ul>
<li><code>ler_planilha()</code>: Para ler o arquivo da planilha com os
prazos processuais.</li>
<li><code>verificar_prazos()</code>: Para identificar quais prazos estão
próximos do vencimento.</li>
<li><code>enviar_alertas()</code>: Para enviar os e-mails de
alerta.</li>
</ul>
<h2 id="exemplo-de-codigo-1">8.3. Exemplo de Código</h2>
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> smtplib</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.text <span class="im">import</span> MIMEText</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para ler a planilha de prazos</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ler_planilha(caminho_arquivo):</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.read_excel(caminho_arquivo)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para verificar prazos próximos do vencimento</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> verificar_prazos(df, dias_aviso<span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    hoje <span class="op">=</span> datetime.now()</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    proximos_prazos <span class="op">=</span> df[(df[<span class="st">&#39;Data de Término&#39;</span>] <span class="op">-</span> hoje).dt.days <span class="op">&lt;=</span> dias_aviso]</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> proximos_prazos</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para enviar e-mail de alerta</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> enviar_alertas(df_prazos, smtp_user, smtp_password):</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    smtp_server <span class="op">=</span> <span class="st">&#39;smtp.gmail.com&#39;</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    smtp_port <span class="op">=</span> <span class="dv">587</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _, row <span class="kw">in</span> df_prazos.iterrows():</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>        destinatario <span class="op">=</span> row[<span class="st">&#39;Email&#39;</span>]</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>        assunto <span class="op">=</span> <span class="ss">f&quot;Aviso de Prazo Processual - </span><span class="sc">{</span>row[<span class="st">&#39;Número do Processo&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>        corpo <span class="op">=</span> <span class="ss">f&quot;Prezado(a),</span><span class="ch">\n\n</span><span class="ss">Este é um aviso de que o prazo processual referente ao processo </span><span class="sc">{</span>row[<span class="st">&#39;Número do Processo&#39;</span>]<span class="sc">}</span><span class="ss"> está se aproximando.</span><span class="ch">\n</span><span class="ss">Data de Término: </span><span class="sc">{</span>row[<span class="st">&#39;Data de Término&#39;</span>]<span class="sc">.</span>strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y&#39;</span>)<span class="sc">}</span><span class="ch">\n\n</span><span class="ss">Atenciosamente,&quot;</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>        msg <span class="op">=</span> MIMEText(corpo)</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>        msg[<span class="st">&#39;Subject&#39;</span>] <span class="op">=</span> assunto</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>        msg[<span class="st">&#39;From&#39;</span>] <span class="op">=</span> smtp_user</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>        msg[<span class="st">&#39;To&#39;</span>] <span class="op">=</span> destinatario</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> smtplib.SMTP(smtp_server, smtp_port) <span class="im">as</span> server:</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>            server.starttls()</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>            server.login(smtp_user, smtp_password)</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>            server.send_message(msg)</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de uso</span></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>caminho_planilha <span class="op">=</span> <span class="st">&#39;prazos_processuais.xlsx&#39;</span></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> ler_planilha(caminho_planilha)</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>df_prazos_proximos <span class="op">=</span> verificar_prazos(df)</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Enviar alertas (descomente a linha abaixo para enviar os e-mails)</span></span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a><span class="co"># enviar_alertas(df_prazos_proximos, &#39;seu_email@gmail.com&#39;, &#39;sua_senha&#39;)</span></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Processamento concluído.&quot;</span>)</span></code></pre></div>
<h2 id="consideracoes-finais-1">8.4. Considerações Finais</h2>
<p>A automação do controle de prazos processuais pode trazer maior
eficiência e segurança para escritórios de advocacia, reduzindo o risco
de perda de prazos importantes e melhorando a comunicação com os
clientes. Com o uso de planilhas e o envio automático de alertas por
e-mail, é possível manter o controle dos prazos de forma organizada e
prática.</p>
<hr />
<h1 id="consulta-a-sites-de-tribunais">9. Consulta a sites de
tribunais</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>A consulta a sites de tribunais é uma atividade rotineira em
escritórios de advocacia, utilizada para acompanhar o andamento de
processos, verificar publicações e obter informações atualizadas sobre
casos judiciais. Neste exemplo, vamos mostrar como automatizar a
consulta a sites de tribunais, utilizando Python para acessar as
informações de forma rápida e eficiente.</p>
<h2 id="objetivo-2">9.1. Objetivo</h2>
<p>O objetivo deste exemplo é criar um script que:</p>
<ul>
<li>Acesse o site de um tribunal (por exemplo, Tribunal de Justiça de
São Paulo).</li>
<li>Realize a busca por um processo utilizando o número do processo
informado pelo usuário.</li>
<li>Extraia e exiba informações relevantes sobre o andamento do
processo.</li>
</ul>
<h2 id="estrutura-do-codigo-2">9.2. Estrutura do Código</h2>
<p>O código será estruturado em funções, para facilitar a leitura e a
manutenção. As principais funções serão:</p>
<ul>
<li><code>acessar_site()</code>: Para acessar o site do tribunal.</li>
<li><code>buscar_processo()</code>: Para realizar a busca pelo
processo.</li>
<li><code>extrair_informacoes()</code>: Para extrair as informações
relevantes sobre o processo.</li>
</ul>
<h2 id="exemplo-de-codigo-2">9.3. Exemplo de Código</h2>
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para acessar o site do tribunal</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> acessar_site(url):</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> requests.get(url)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> response.status_code <span class="op">==</span> <span class="dv">200</span>:</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> response.text</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">Exception</span>(<span class="ss">f&quot;Erro ao acessar o site: </span><span class="sc">{</span>response<span class="sc">.</span>status_code<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para buscar o processo</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> buscar_processo(html, numero_processo):</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    soup <span class="op">=</span> BeautifulSoup(html, <span class="st">&#39;html.parser&#39;</span>)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    campo_busca <span class="op">=</span> soup.find(<span class="st">&#39;input&#39;</span>, {<span class="st">&#39;name&#39;</span>: <span class="st">&#39;numero_processo&#39;</span>})</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> campo_busca:</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Simular a busca pelo processo</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&quot;Processo </span><span class="sc">{</span>numero_processo<span class="sc">}</span><span class="ss"> encontrado.&quot;</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;Campo de busca não encontrado.&quot;</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para extrair informações do processo</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extrair_informacoes(html):</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>    soup <span class="op">=</span> BeautifulSoup(html, <span class="st">&#39;html.parser&#39;</span>)</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>    informacoes <span class="op">=</span> {}</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extrair informações relevantes (exemplo: número do processo, partes, advogado, etc.)</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>    informacoes[<span class="st">&#39;numero_processo&#39;</span>] <span class="op">=</span> soup.find(<span class="st">&#39;h1&#39;</span>).text</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>    informacoes[<span class="st">&#39;partes&#39;</span>] <span class="op">=</span> [parte.text <span class="cf">for</span> parte <span class="kw">in</span> soup.find_all(<span class="st">&#39;div&#39;</span>, class_<span class="op">=</span><span class="st">&#39;parte&#39;</span>)]</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> informacoes</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de uso</span></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">&#39;https://www.tjsp.jus.br/&#39;</span></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>numero_processo <span class="op">=</span> <span class="st">&#39;1234567890&#39;</span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>html_site <span class="op">=</span> acessar_site(url)</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>resultado_busca <span class="op">=</span> buscar_processo(html_site, numero_processo)</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(resultado_busca)</span></code></pre></div>
<h2 id="consideracoes-finais-2">9.4. Considerações Finais</h2>
<p>A automação da consulta a sites de tribunais pode trazer maior
agilidade e eficiência para escritórios de advocacia, permitindo o
acompanhamento em tempo real dos processos e a obtenção rápida de
informações relevantes. Com o uso de web scraping e automação de
navegação, é possível simplificar e otimizar essa tarefa rotineira.</p>
<hr />
<h1 id="escritorios-de-contabilidade">Escritórios de Contabilidade</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>Os escritórios de contabilidade desempenham um papel fundamental na
gestão financeira de empresas e profissionais autônomos. Além de
garantir o cumprimento das obrigações fiscais, esses escritórios são
responsáveis por organizar documentos, gerar relatórios, calcular
impostos e manter o controle sobre receitas e despesas. Com o avanço da
tecnologia, a automação dessas tarefas tornou-se essencial para aumentar
a produtividade, reduzir erros e liberar tempo para atividades mais
estratégicas.</p>
<p>Neste capítulo, você aprenderá como aplicar Python para automatizar
processos comuns em escritórios de contabilidade, tornando o dia a dia
mais eficiente e seguro. Serão apresentados exemplos práticos que podem
ser adaptados à realidade de diferentes negócios, facilitando a rotina
contábil e proporcionando maior agilidade no atendimento aos
clientes.</p>
<p>A seguir, você verá como automatizar:</p>
<ul>
<li>A leitura e consolidação de extratos bancários em formato CSV.</li>
<li>A geração automática de guias de impostos.</li>
<li>O envio automático de boletos por e-mail.</li>
</ul>
<hr />
<h1 id="leitura-e-consolidacao-de-extratos-bancarios-csv">10. Leitura e
consolidação de extratos bancários (CSV)</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>A leitura e consolidação de extratos bancários é uma tarefa essencial
para a gestão financeira de empresas, permitindo o acompanhamento de
receitas, despesas e saldos. Neste exemplo, vamos mostrar como
automatizar a leitura de extratos bancários em formato CSV e a
consolidação das informações em um relatório financeiro.</p>
<h2 id="objetivo-3">10.1. Objetivo</h2>
<p>O objetivo deste exemplo é criar um script que:</p>
<ul>
<li>Leia um ou mais arquivos CSV contendo extratos bancários.</li>
<li>Consolide as informações em um único relatório, com o resumo das
receitas e despesas.</li>
</ul>
<h2 id="estrutura-do-codigo-3">10.2. Estrutura do Código</h2>
<p>O código será estruturado em funções, para facilitar a leitura e a
manutenção. As principais funções serão:</p>
<ul>
<li><code>ler_extrato()</code>: Para ler o arquivo CSV do extrato
bancário.</li>
<li><code>consolidar_extratos()</code>: Para consolidar as informações
de múltiplos extratos.</li>
<li><code>gerar_relatorio()</code>: Para gerar o relatório
financeiro.</li>
</ul>
<h2 id="exemplo-de-codigo-3">10.3. Exemplo de Código</h2>
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para ler o extrato bancário</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ler_extrato(caminho_arquivo):</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.read_csv(caminho_arquivo, sep<span class="op">=</span><span class="st">&#39;;&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;latin1&#39;</span>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para consolidar extratos</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> consolidar_extratos(pasta_extratos):</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    arquivos <span class="op">=</span> glob.glob(<span class="ss">f&quot;</span><span class="sc">{</span>pasta_extratos<span class="sc">}</span><span class="ss">/*.csv&quot;</span>)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>    extratos <span class="op">=</span> [ler_extrato(arquivo) <span class="cf">for</span> arquivo <span class="kw">in</span> arquivos]</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.concat(extratos, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para gerar o relatório financeiro</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gerar_relatorio(df_consolidado):</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    relatorio <span class="op">=</span> df_consolidado.groupby(<span class="st">&#39;Tipo&#39;</span>)[<span class="st">&#39;Valor&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    relatorio.to_csv(<span class="st">&#39;relatorio_financeiro.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>, sep<span class="op">=</span><span class="st">&#39;;&#39;</span>)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Relatório financeiro gerado: relatorio_financeiro.csv&quot;</span>)</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de uso</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>pasta_extratos <span class="op">=</span> <span class="st">&#39;extratos_bancarios&#39;</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>df_consolidado <span class="op">=</span> consolidar_extratos(pasta_extratos)</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>gerar_relatorio(df_consolidado)</span></code></pre></div>
<h2 id="consideracoes-finais-3">10.4. Considerações Finais</h2>
<p>A automação da leitura e consolidação de extratos bancários pode
trazer maior eficiência e precisão para a gestão financeira de empresas,
facilitando o acompanhamento de receitas e despesas. Com o uso de
arquivos CSV e a automação do processamento de dados, é possível
simplificar e otimizar essa tarefa contábil.</p>
<hr />
<h1 id="geracao-automatica-de-guias-de-impostos">11. Geração automática
de guias de impostos</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>A geração de guias de impostos é uma obrigação periódica para
empresas, sendo essencial para a regularidade fiscal e o cumprimento das
obrigações tributárias. Neste exemplo, vamos mostrar como automatizar a
geração de guias de impostos, utilizando Python para calcular os valores
devidos e gerar os documentos necessários.</p>
<h2 id="objetivo-4">11.1. Objetivo</h2>
<p>O objetivo deste exemplo é criar um script que:</p>
<ul>
<li>Calcule os valores de impostos devidos com base nas receitas e
despesas informadas.</li>
<li>Gere as guias de pagamento dos impostos de forma automática.</li>
</ul>
<h2 id="estrutura-do-codigo-4">11.2. Estrutura do Código</h2>
<p>O código será estruturado em funções, para facilitar a leitura e a
manutenção. As principais funções serão:</p>
<ul>
<li><code>calcular_impostos()</code>: Para calcular os impostos
devidos.</li>
<li><code>gerar_guia_pagamento()</code>: Para gerar a guia de pagamento
do imposto.</li>
</ul>
<h2 id="exemplo-de-codigo-4">11.3. Exemplo de Código</h2>
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para calcular os impostos devidos</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calcular_impostos(receitas, despesas, aliquota_imposto):</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    lucro <span class="op">=</span> receitas <span class="op">-</span> despesas</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    imposto_devido <span class="op">=</span> lucro <span class="op">*</span> aliquota_imposto</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> imposto_devido</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para gerar a guia de pagamento do imposto</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gerar_guia_pagamento(imposto_devido, caminho_saida):</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(caminho_saida, <span class="st">&#39;w&#39;</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">file</span>.write(<span class="ss">f&quot;Guia de Pagamento de Imposto</span><span class="ch">\n</span><span class="ss">&quot;</span>)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">file</span>.write(<span class="ss">f&quot;Valor do Imposto Devido: R$ </span><span class="sc">{</span>imposto_devido<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">&quot;</span>)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Guia de pagamento gerada: </span><span class="sc">{</span>caminho_saida<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de uso</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>receitas <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>despesas <span class="op">=</span> <span class="dv">5000</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>aliquota_imposto <span class="op">=</span> <span class="fl">0.15</span>  <span class="co"># 15%</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>imposto_devido <span class="op">=</span> calcular_impostos(receitas, despesas, aliquota_imposto)</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>gerar_guia_pagamento(imposto_devido, <span class="st">&#39;guia_pagamento_imposto.txt&#39;</span>)</span></code></pre></div>
<h2 id="consideracoes-finais-4">11.4. Considerações Finais</h2>
<p>A automação da geração de guias de impostos pode trazer maior
agilidade e precisão para o cumprimento das obrigações tributárias das
empresas, reduzindo o risco de erros e atrasos. Com o uso de cálculos
automáticos e a geração de documentos, é possível simplificar e otimizar
essa tarefa contábil.</p>
<hr />
<h1 id="envio-automatico-de-boletos-por-e-mail">12. Envio automático de
boletos por e-mail</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>O envio de boletos por e-mail é uma prática comum e eficiente para a
cobrança de clientes, facilitando o recebimento e melhorando o fluxo de
caixa das empresas. Neste exemplo, vamos mostrar como automatizar o
envio de boletos por e-mail, utilizando Python para gerar os boletos e
enviá-los automaticamente para os clientes.</p>
<h2 id="objetivo-5">12.1. Objetivo</h2>
<p>O objetivo deste exemplo é criar um script que:</p>
<ul>
<li>Gere boletos bancários com base nas informações de cobrança.</li>
<li>Envie os boletos gerados como anexos em e-mails para os
clientes.</li>
</ul>
<h2 id="estrutura-do-codigo-5">12.2. Estrutura do Código</h2>
<p>O código será estruturado em funções, para facilitar a leitura e a
manutenção. As principais funções serão:</p>
<ul>
<li><code>gerar_boleto()</code>: Para gerar o boleto bancário.</li>
<li><code>enviar_boleto_email()</code>: Para enviar o boleto por
e-mail.</li>
</ul>
<h2 id="exemplo-de-codigo-5">12.3. Exemplo de Código</h2>
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> smtplib</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.multipart <span class="im">import</span> MIMEMultipart</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.text <span class="im">import</span> MIMEText</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.base <span class="im">import</span> MIMEBase</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email <span class="im">import</span> encoders</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para gerar o boleto bancário</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gerar_boleto(dados_boleto, caminho_saida):</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    df_boleto <span class="op">=</span> pd.DataFrame([dados_boleto])</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    df_boleto.to_csv(caminho_saida, index<span class="op">=</span><span class="va">False</span>, sep<span class="op">=</span><span class="st">&#39;;&#39;</span>)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Boleto gerado: </span><span class="sc">{</span>caminho_saida<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para enviar o boleto por e-mail</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> enviar_boleto_email(destinatario, assunto, corpo, caminho_boleto, smtp_user, smtp_password):</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    smtp_server <span class="op">=</span> <span class="st">&#39;smtp.gmail.com&#39;</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    smtp_port <span class="op">=</span> <span class="dv">587</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Criar o objeto de mensagem</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>    msg <span class="op">=</span> MIMEMultipart()</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>    msg[<span class="st">&#39;Subject&#39;</span>] <span class="op">=</span> assunto</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>    msg[<span class="st">&#39;From&#39;</span>] <span class="op">=</span> smtp_user</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>    msg[<span class="st">&#39;To&#39;</span>] <span class="op">=</span> destinatario</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adicionar o corpo do e-mail</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>    msg.attach(MIMEText(corpo, <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adicionar o anexo</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(caminho_boleto, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> anexo:</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>        parte <span class="op">=</span> MIMEBase(<span class="st">&#39;application&#39;</span>, <span class="st">&#39;octet-stream&#39;</span>)</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>        parte.set_payload(anexo.read())</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>        encoders.encode_base64(parte)</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>        parte.add_header(<span class="st">&#39;Content-Disposition&#39;</span>, <span class="ss">f&#39;attachment; filename=</span><span class="sc">{</span>caminho_boleto<span class="sc">.</span>split(<span class="st">&quot;/&quot;</span>)[<span class="op">-</span><span class="dv">1</span>]<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>        msg.attach(parte)</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Enviar o e-mail</span></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> smtplib.SMTP(smtp_server, smtp_port) <span class="im">as</span> server:</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>        server.starttls()</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>        server.login(smtp_user, smtp_password)</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>        server.send_message(msg)</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de uso</span></span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>dados_boleto <span class="op">=</span> {</span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Cliente&#39;</span>: <span class="st">&#39;João da Silva&#39;</span>,</span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Valor&#39;</span>: <span class="fl">150.00</span>,</span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Vencimento&#39;</span>: <span class="st">&#39;2025-06-10&#39;</span></span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>caminho_boleto <span class="op">=</span> <span class="st">&#39;boleto_joao_silva.csv&#39;</span></span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a>gerar_boleto(dados_boleto, caminho_boleto)</span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Enviar o boleto por e-mail (descomente a linha abaixo para enviar o e-mail)</span></span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a><span class="co"># enviar_boleto_email(&#39;joao@email.com&#39;, &#39;Seu Boleto&#39;, &#39;Segue em anexo o boleto.&#39;, caminho_boleto, &#39;seu_email@gmail.com&#39;, &#39;sua_senha&#39;)</span></span></code></pre></div>
<h2 id="consideracoes-finais-5">12.4. Considerações Finais</h2>
<p>A automação do envio de boletos por e-mail pode trazer maior
eficiência e agilidade para o processo de cobrança, melhorando o fluxo
de caixa e a relação com os clientes. Com o uso de geração automática de
boletos e envio programático por e-mail, é possível simplificar e
otimizar essa tarefa financeira.</p>
<hr />
<h1 id="escritorios-de-logistica">Escritórios de Logística</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>Os escritórios de logística são responsáveis pelo planejamento,
execução e controle das operações de transporte e armazenamento de
mercadorias, buscando sempre a eficiência, a redução de custos e a
satisfação dos clientes. A automação pode transformar a rotina desses
escritórios, trazendo mais agilidade, precisão e rastreabilidade para os
processos logísticos.</p>
<p>Nesta seção, você aprenderá como aplicar Python para automatizar
tarefas comuns em logística, desde a leitura e geração de documentos até
o acompanhamento de entregas e roteirização de rotas. Os exemplos
apresentados foram pensados para resolver desafios reais enfrentados por
profissionais da área, mostrando como a tecnologia pode ser uma grande
aliada na otimização das operações.</p>
<p>A seguir, você verá como automatizar:</p>
<ul>
<li>A leitura e geração de manifestos em XML e PDF.</li>
<li>A roteirização com base em distância, utilizando APIs como Google
Maps ou OpenRoute.</li>
<li>O acompanhamento de entregas via planilhas atualizadas.</li>
</ul>
<hr />
<h1 id="leitura-e-geracao-de-manifestos-xml-pdf">13. Leitura e geração
de manifestos (XML, PDF)</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>A leitura e geração de manifestos é uma atividade importante para o
transporte de mercadorias, sendo essencial para a conformidade fiscal e
o rastreamento das operações de transporte. Neste exemplo, vamos mostrar
como automatizar a leitura de manifestos em formato XML e PDF, e a
geração de novos manifestos com base nas informações lidas.</p>
<h2 id="objetivo-6">13.1. Objetivo</h2>
<p>O objetivo deste exemplo é criar um script que:</p>
<ul>
<li>Leia um manifesto em formato XML, extraindo as informações
relevantes.</li>
<li>Gere um novo manifesto em formato PDF, com as informações
extraídas.</li>
</ul>
<h2 id="estrutura-do-codigo-6">13.2. Estrutura do Código</h2>
<p>O código será estruturado em funções, para facilitar a leitura e a
manutenção. As principais funções serão:</p>
<ul>
<li><code>ler_manifesto_xml()</code>: Para ler o manifesto em formato
XML.</li>
<li><code>gerar_manifesto_pdf()</code>: Para gerar o novo manifesto em
formato PDF.</li>
</ul>
<h2 id="exemplo-de-codigo-6">13.3. Exemplo de Código</h2>
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xml.etree.ElementTree <span class="im">as</span> ET</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fpdf <span class="im">import</span> FPDF</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para ler o manifesto em formato XML</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ler_manifesto_xml(caminho_arquivo):</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    tree <span class="op">=</span> ET.parse(caminho_arquivo)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    root <span class="op">=</span> tree.getroot()</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    dados_manifesto <span class="op">=</span> {</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;remetente&#39;</span>: root.find(<span class="st">&#39;remetente&#39;</span>).text,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;destinatario&#39;</span>: root.find(<span class="st">&#39;destinatario&#39;</span>).text,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;peso&#39;</span>: root.find(<span class="st">&#39;peso&#39;</span>).text,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;valor_frete&#39;</span>: root.find(<span class="st">&#39;valor_frete&#39;</span>).text</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dados_manifesto</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para gerar o manifesto em formato PDF</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gerar_manifesto_pdf(dados_manifesto, caminho_saida):</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>    pdf <span class="op">=</span> FPDF()</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>    pdf.add_page()</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    pdf.set_font(<span class="st">&quot;Arial&quot;</span>, size<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> chave, valor <span class="kw">in</span> dados_manifesto.items():</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>        pdf.cell(<span class="dv">0</span>, <span class="dv">10</span>, <span class="ss">f&quot;</span><span class="sc">{</span>chave<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>valor<span class="sc">}</span><span class="ss">&quot;</span>, ln<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>    pdf.output(caminho_saida)</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Manifesto gerado: </span><span class="sc">{</span>caminho_saida<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de uso</span></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>caminho_xml <span class="op">=</span> <span class="st">&#39;manifesto.xml&#39;</span></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>caminho_pdf <span class="op">=</span> <span class="st">&#39;manifesto.pdf&#39;</span></span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>dados_manifesto <span class="op">=</span> ler_manifesto_xml(caminho_xml)</span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>gerar_manifesto_pdf(dados_manifesto, caminho_pdf)</span></code></pre></div>
<h2 id="consideracoes-finais-6">13.4. Considerações Finais</h2>
<p>A automação da leitura e geração de manifestos pode trazer maior
eficiência e precisão para as operações de transporte, facilitando o
cumprimento das obrigações fiscais e o rastreamento das mercadorias. Com
o uso de arquivos XML e PDF, e a automação do processamento e geração de
documentos, é possível simplificar e otimizar essa tarefa logística.</p>
<hr />
<h1
id="roteirizacao-com-base-em-distancia-api-google-maps-ou-openroute">14.
Roteirização com base em distância (API Google Maps ou OpenRoute)</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>A roteirização é uma atividade fundamental para a otimização do
transporte de mercadorias, permitindo a definição das melhores rotas a
serem seguidas pelos veículos. Neste exemplo, vamos mostrar como
automatizar a roteirização com base em distância, utilizando APIs como
Google Maps ou OpenRoute.</p>
<h2 id="objetivo-7">14.1. Objetivo</h2>
<p>O objetivo deste exemplo é criar um script que:</p>
<ul>
<li>Receba uma lista de endereços de origem e destino.</li>
<li>Calcule a rota mais curta ou mais rápida entre os pontos, utilizando
a API escolhida.</li>
<li>Exiba o resultado com as informações da rota, como distância e tempo
estimado.</li>
</ul>
<h2 id="estrutura-do-codigo-7">14.2. Estrutura do Código</h2>
<p>O código será estruturado em funções, para facilitar a leitura e a
manutenção. As principais funções serão:</p>
<ul>
<li><code>calcular_rota_google_maps()</code>: Para calcular a rota
utilizando a API do Google Maps.</li>
<li><code>calcular_rota_openroute()</code>: Para calcular a rota
utilizando a API do OpenRoute.</li>
</ul>
<h2 id="exemplo-de-codigo-7">14.3. Exemplo de Código</h2>
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para calcular a rota utilizando a API do Google Maps</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calcular_rota_google_maps(origem, destino, chave_api):</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    url <span class="op">=</span> <span class="ss">f&quot;https://maps.googleapis.com/maps/api/directions/json?origin=</span><span class="sc">{</span>origem<span class="sc">}</span><span class="ss">&amp;destination=</span><span class="sc">{</span>destino<span class="sc">}</span><span class="ss">&amp;key=</span><span class="sc">{</span>chave_api<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> requests.get(url)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    dados <span class="op">=</span> response.json()</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> dados[<span class="st">&#39;status&#39;</span>] <span class="op">==</span> <span class="st">&#39;OK&#39;</span>:</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>        rota <span class="op">=</span> dados[<span class="st">&#39;routes&#39;</span>][<span class="dv">0</span>]</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>        distancia <span class="op">=</span> rota[<span class="st">&#39;legs&#39;</span>][<span class="dv">0</span>][<span class="st">&#39;distance&#39;</span>][<span class="st">&#39;text&#39;</span>]</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>        tempo <span class="op">=</span> rota[<span class="st">&#39;legs&#39;</span>][<span class="dv">0</span>][<span class="st">&#39;duration&#39;</span>][<span class="st">&#39;text&#39;</span>]</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&quot;Distância: </span><span class="sc">{</span>distancia<span class="sc">}</span><span class="ss">, Tempo: </span><span class="sc">{</span>tempo<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;Erro ao calcular a rota.&quot;</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para calcular a rota utilizando a API do OpenRoute</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calcular_rota_openroute(origem, destino):</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>    url <span class="op">=</span> <span class="ss">f&quot;https://api.openrouteservice.org/v2/directions/driving-car?api_key=sua_chave_api&amp;start=</span><span class="sc">{</span>origem<span class="sc">}</span><span class="ss">&amp;end=</span><span class="sc">{</span>destino<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> requests.get(url)</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>    dados <span class="op">=</span> response.json()</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> dados[<span class="st">&#39;routes&#39;</span>]:</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>        rota <span class="op">=</span> dados[<span class="st">&#39;routes&#39;</span>][<span class="dv">0</span>]</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>        distancia <span class="op">=</span> rota[<span class="st">&#39;summary&#39;</span>][<span class="st">&#39;length&#39;</span>]</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>        tempo <span class="op">=</span> rota[<span class="st">&#39;summary&#39;</span>][<span class="st">&#39;duration&#39;</span>]</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&quot;Distância: </span><span class="sc">{</span>distancia<span class="sc">}</span><span class="ss"> metros, Tempo: </span><span class="sc">{</span>tempo<span class="sc">}</span><span class="ss"> segundos&quot;</span></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;Erro ao calcular a rota.&quot;</span></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de uso</span></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>origem <span class="op">=</span> <span class="st">&quot;-23.550520, -46.633308&quot;</span>  <span class="co"># São Paulo</span></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>destino <span class="op">=</span> <span class="st">&quot;-22.906847, -43.172896&quot;</span>  <span class="co"># Rio de Janeiro</span></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular rota pelo Google Maps</span></span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>resultado_google_maps <span class="op">=</span> calcular_rota_google_maps(origem, destino, <span class="st">&#39;sua_chave_api_google_maps&#39;</span>)</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Google Maps:&quot;</span>, resultado_google_maps)</span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular rota pelo OpenRoute</span></span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>resultado_openroute <span class="op">=</span> calcular_rota_openroute(origem, destino)</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;OpenRoute:&quot;</span>, resultado_openroute)</span></code></pre></div>
<h2 id="consideracoes-finais-7">14.4. Considerações Finais</h2>
<p>A automação da roteirização com base em distância pode trazer ganhos
significativos de eficiência e economia para as operações de transporte,
permitindo a definição de rotas otimizadas e a redução de custos com
combustível e tempo de viagem. Com o uso de APIs de mapeamento e a
automação do processamento das informações, é possível simplificar e
otimizar essa tarefa logística.</p>
<hr />
<h1 id="acompanhamento-de-entregas-via-planilhas">15. Acompanhamento de
entregas via planilhas</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>O acompanhamento de entregas é uma atividade importante para garantir
a satisfação dos clientes e a eficiência das operações de logística.
Neste exemplo, vamos mostrar como automatizar o acompanhamento de
entregas, utilizando Python para ler planilhas com os dados das entregas
e enviar notificações automáticas.</p>
<h2 id="objetivo-8">15.1. Objetivo</h2>
<p>O objetivo deste exemplo é criar um script que:</p>
<ul>
<li>Leia uma planilha com os dados das entregas, contendo informações
como código da entrega, cliente, endereço, data e status.</li>
<li>Envie notificações automáticas para os clientes, informando sobre o
status da entrega.</li>
</ul>
<h2 id="estrutura-do-codigo-8">15.2. Estrutura do Código</h2>
<p>O código será estruturado em funções, para facilitar a leitura e a
manutenção. As principais funções serão:</p>
<ul>
<li><code>ler_planilha_entregas()</code>: Para ler a planilha com os
dados das entregas.</li>
<li><code>enviar_notificacoes()</code>: Para enviar as notificações
automáticas.</li>
</ul>
<h2 id="exemplo-de-codigo-8">15.3. Exemplo de Código</h2>
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> smtplib</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.text <span class="im">import</span> MIMEText</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para ler a planilha de entregas</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ler_planilha_entregas(caminho_arquivo):</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.read_excel(caminho_arquivo)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para enviar notificações automáticas</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> enviar_notificacoes(df_entregas, smtp_user, smtp_password):</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>    smtp_server <span class="op">=</span> <span class="st">&#39;smtp.gmail.com&#39;</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    smtp_port <span class="op">=</span> <span class="dv">587</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _, row <span class="kw">in</span> df_entregas.iterrows():</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>        destinatario <span class="op">=</span> row[<span class="st">&#39;Email&#39;</span>]</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>        assunto <span class="op">=</span> <span class="ss">f&quot;Atualização sobre sua entrega - </span><span class="sc">{</span>row[<span class="st">&#39;Código da Entrega&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>        corpo <span class="op">=</span> <span class="ss">f&quot;Prezado(a),</span><span class="ch">\n\n</span><span class="ss">Informamos que o status da sua entrega </span><span class="sc">{</span>row[<span class="st">&#39;Código da Entrega&#39;</span>]<span class="sc">}</span><span class="ss"> foi atualizado para: </span><span class="sc">{</span>row[<span class="st">&#39;Status&#39;</span>]<span class="sc">}</span><span class="ss">.</span><span class="ch">\n\n</span><span class="ss">Atenciosamente,&quot;</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>        msg <span class="op">=</span> MIMEText(corpo)</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>        msg[<span class="st">&#39;Subject&#39;</span>] <span class="op">=</span> assunto</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>        msg[<span class="st">&#39;From&#39;</span>] <span class="op">=</span> smtp_user</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>        msg[<span class="st">&#39;To&#39;</span>] <span class="op">=</span> destinatario</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> smtplib.SMTP(smtp_server, smtp_port) <span class="im">as</span> server:</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>            server.starttls()</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>            server.login(smtp_user, smtp_password)</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>            server.send_message(msg)</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de uso</span></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>caminho_planilha <span class="op">=</span> <span class="st">&#39;entregas.xlsx&#39;</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>df_entregas <span class="op">=</span> ler_planilha_entregas(caminho_planilha)</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Enviar notificações (descomente a linha abaixo para enviar os e-mails)</span></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a><span class="co"># enviar_notificacoes(df_entregas, &#39;seu_email@gmail.com&#39;, &#39;sua_senha&#39;)</span></span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Processamento concluído.&quot;</span>)</span></code></pre></div>
<h2 id="consideracoes-finais-8">15.4. Considerações Finais</h2>
<p>A automação do acompanhamento de entregas pode trazer maior
eficiência e agilidade para as operações de logística, melhorando a
comunicação com os clientes e a gestão das entregas. Com o uso de
planilhas e o envio automático de notificações por e-mail, é possível
simplificar e otimizar essa tarefa logística.</p>
<hr />
<h1 id="e-commerce-e-vendas-online">E-commerce e Vendas Online</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>O setor de e-commerce e vendas online cresce a cada ano, exigindo das
empresas agilidade, precisão e integração de processos para atender
clientes em diferentes canais de venda. Automatizar tarefas nesse
contexto é fundamental para garantir eficiência operacional, evitar
erros manuais e proporcionar uma melhor experiência ao cliente.</p>
<p>Nesta seção, você aprenderá como aplicar Python para automatizar
rotinas comuns em lojas virtuais e operações de vendas online, desde o
processamento de pedidos até a atualização de estoque e o envio de
documentos fiscais. Os exemplos apresentados foram pensados para
resolver desafios reais enfrentados por quem atua no comércio
eletrônico, mostrando como a tecnologia pode ser uma grande aliada no
crescimento do negócio.</p>
<p>A seguir, você verá como automatizar:</p>
<ul>
<li>A leitura de pedidos de marketplaces.</li>
<li>A atualização automática de estoque em Excel ou ERP simples.</li>
<li>O envio de notas fiscais e respostas automáticas a clientes.</li>
</ul>
<hr />
<h1 id="leitura-de-pedidos-de-marketplaces">16. Leitura de pedidos de
marketplaces</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>A leitura e processamento de pedidos de marketplaces é uma tarefa
importante para empresas que vendem produtos em plataformas como Mercado
Livre, Amazon e outros. Neste exemplo, vamos mostrar como automatizar a
leitura de pedidos recebidos em um marketplace, utilizando Python para
processar as informações e gerar relatórios.</p>
<h2 id="objetivo-9">16.1. Objetivo</h2>
<p>O objetivo deste exemplo é criar um script que:</p>
<ul>
<li>Leia um arquivo com os pedidos recebidos, contendo informações como
produto, quantidade, preço e dados do cliente.</li>
<li>Gere um relatório com o resumo dos pedidos, incluindo o total de
vendas e a lista de produtos mais vendidos.</li>
</ul>
<h2 id="estrutura-do-codigo-9">16.2. Estrutura do Código</h2>
<p>O código será estruturado em funções, para facilitar a leitura e a
manutenção. As principais funções serão:</p>
<ul>
<li><code>ler_pedidos()</code>: Para ler o arquivo com os pedidos
recebidos.</li>
<li><code>gerar_relatorio_pedidos()</code>: Para gerar o relatório com o
resumo dos pedidos.</li>
</ul>
<h2 id="exemplo-de-codigo-9">16.3. Exemplo de Código</h2>
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para ler os pedidos recebidos</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ler_pedidos(caminho_arquivo):</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.read_csv(caminho_arquivo, sep<span class="op">=</span><span class="st">&#39;;&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;latin1&#39;</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para gerar o relatório com o resumo dos pedidos</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gerar_relatorio_pedidos(df_pedidos):</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    relatorio <span class="op">=</span> df_pedidos.groupby(<span class="st">&#39;Produto&#39;</span>).agg({<span class="st">&#39;Quantidade&#39;</span>: <span class="st">&#39;sum&#39;</span>, <span class="st">&#39;Preço&#39;</span>: <span class="st">&#39;mean&#39;</span>}).reset_index()</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    relatorio[<span class="st">&#39;Total Vendas&#39;</span>] <span class="op">=</span> relatorio[<span class="st">&#39;Quantidade&#39;</span>] <span class="op">*</span> relatorio[<span class="st">&#39;Preço&#39;</span>]</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>    relatorio.to_csv(<span class="st">&#39;relatorio_pedidos.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>, sep<span class="op">=</span><span class="st">&#39;;&#39;</span>)</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Relatório de pedidos gerado: relatorio_pedidos.csv&quot;</span>)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de uso</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>caminho_arquivo <span class="op">=</span> <span class="st">&#39;pedidos_marketplace.csv&#39;</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>df_pedidos <span class="op">=</span> ler_pedidos(caminho_arquivo)</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>gerar_relatorio_pedidos(df_pedidos)</span></code></pre></div>
<h2 id="consideracoes-finais-9">16.4. Considerações Finais</h2>
<p>A automação da leitura e processamento de pedidos de marketplaces
pode trazer maior eficiência e agilidade para as operações de vendas
online, facilitando o acompanhamento dos pedidos e a geração de
relatórios. Com o uso de arquivos CSV e a automação do processamento de
dados, é possível simplificar e otimizar essa tarefa comercial.</p>
<hr />
<h1 id="atualizacao-automatica-de-estoque">17. Atualização automática de
estoque</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>A atualização de estoque é uma atividade crítica para empresas de
e-commerce e vendas online, sendo essencial para garantir a
disponibilidade dos produtos e evitar perdas financeiras. Neste exemplo,
vamos mostrar como automatizar a atualização de estoque em planilhas
Excel ou em um ERP simples, utilizando Python para ler os dados de
vendas e atualizar as quantidades em estoque.</p>
<h2 id="objetivo-10">17.1. Objetivo</h2>
<p>O objetivo deste exemplo é criar um script que:</p>
<ul>
<li>Leia um arquivo com os dados de vendas, contendo informações como
produto, quantidade vendida e data da venda.</li>
<li>Atualize automaticamente as quantidades em estoque em uma planilha
Excel ou em um ERP simples.</li>
</ul>
<h2 id="estrutura-do-codigo-10">17.2. Estrutura do Código</h2>
<p>O código será estruturado em funções, para facilitar a leitura e a
manutenção. As principais funções serão:</p>
<ul>
<li><code>ler_vendas()</code>: Para ler o arquivo com os dados de
vendas.</li>
<li><code>atualizar_estoque()</code>: Para atualizar as quantidades em
estoque.</li>
</ul>
<h2 id="exemplo-de-codigo-10">17.3. Exemplo de Código</h2>
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para ler os dados de vendas</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ler_vendas(caminho_arquivo):</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.read_csv(caminho_arquivo, sep<span class="op">=</span><span class="st">&#39;;&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;latin1&#39;</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para atualizar o estoque</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> atualizar_estoque(df_vendas, caminho_estoque):</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    df_estoque <span class="op">=</span> pd.read_excel(caminho_estoque)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _, row <span class="kw">in</span> df_vendas.iterrows():</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>        produto <span class="op">=</span> row[<span class="st">&#39;Produto&#39;</span>]</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>        quantidade_vendida <span class="op">=</span> row[<span class="st">&#39;Quantidade&#39;</span>]</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>        df_estoque.loc[df_estoque[<span class="st">&#39;Produto&#39;</span>] <span class="op">==</span> produto, <span class="st">&#39;Estoque&#39;</span>] <span class="op">-=</span> quantidade_vendida</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>    df_estoque.to_excel(caminho_estoque, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Estoque atualizado com sucesso.&quot;</span>)</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de uso</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>caminho_vendas <span class="op">=</span> <span class="st">&#39;vendas.csv&#39;</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>caminho_estoque <span class="op">=</span> <span class="st">&#39;estoque.xlsx&#39;</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>df_vendas <span class="op">=</span> ler_vendas(caminho_vendas)</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>atualizar_estoque(df_vendas, caminho_estoque)</span></code></pre></div>
<h2 id="consideracoes-finais-10">17.4. Considerações Finais</h2>
<p>A automação da atualização de estoque pode trazer maior eficiência e
precisão para a gestão de estoques em empresas de e-commerce e vendas
online, facilitando o acompanhamento das vendas e a atualização das
quantidades em estoque. Com o uso de arquivos CSV e Excel, e a automação
do processamento de dados, é possível simplificar e otimizar essa tarefa
comercial.</p>
<hr />
<h1 id="envio-de-notas-fiscais-e-respostas-automaticas-a-clientes">18.
Envio de notas fiscais e respostas automáticas a clientes</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>O envio de notas fiscais e respostas automáticas a clientes é uma
prática importante para garantir a conformidade fiscal e melhorar o
atendimento ao cliente. Neste exemplo, vamos mostrar como automatizar o
envio de notas fiscais eletrônicas e respostas automáticas a clientes,
utilizando Python para gerar os documentos e enviá-los por e-mail.</p>
<h2 id="objetivo-11">18.1. Objetivo</h2>
<p>O objetivo deste exemplo é criar um script que:</p>
<ul>
<li>Gere notas fiscais eletrônicas com base nas informações de
vendas.</li>
<li>Envie as notas fiscais geradas e respostas automáticas por e-mail
para os clientes.</li>
</ul>
<h2 id="estrutura-do-codigo-11">18.2. Estrutura do Código</h2>
<p>O código será estruturado em funções, para facilitar a leitura e a
manutenção. As principais funções serão:</p>
<ul>
<li><code>gerar_nota_fiscal()</code>: Para gerar a nota fiscal
eletrônica.</li>
<li><code>enviar_nota_fiscal_email()</code>: Para enviar a nota fiscal e
a resposta automática por e-mail.</li>
</ul>
<h2 id="exemplo-de-codigo-11">18.3. Exemplo de Código</h2>
<div class="sourceCode" id="cb57"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> smtplib</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.multipart <span class="im">import</span> MIMEMultipart</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.text <span class="im">import</span> MIMEText</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.base <span class="im">import</span> MIMEBase</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email <span class="im">import</span> encoders</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para gerar a nota fiscal eletrônica</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gerar_nota_fiscal(dados_venda, caminho_saida):</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    df_nota <span class="op">=</span> pd.DataFrame([dados_venda])</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    df_nota.to_csv(caminho_saida, index<span class="op">=</span><span class="va">False</span>, sep<span class="op">=</span><span class="st">&#39;;&#39;</span>)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Nota fiscal gerada: </span><span class="sc">{</span>caminho_saida<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para enviar a nota fiscal por e-mail</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> enviar_nota_fiscal_email(destinatario, assunto, corpo, caminho_nota, smtp_user, smtp_password):</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>    smtp_server <span class="op">=</span> <span class="st">&#39;smtp.gmail.com&#39;</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>    smtp_port <span class="op">=</span> <span class="dv">587</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Criar o objeto de mensagem</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>    msg <span class="op">=</span> MIMEMultipart()</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>    msg[<span class="st">&#39;Subject&#39;</span>] <span class="op">=</span> assunto</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>    msg[<span class="st">&#39;From&#39;</span>] <span class="op">=</span> smtp_user</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>    msg[<span class="st">&#39;To&#39;</span>] <span class="op">=</span> destinatario</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adicionar o corpo do e-mail</span></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>    msg.attach(MIMEText(corpo, <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adicionar o anexo</span></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(caminho_nota, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> anexo:</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>        parte <span class="op">=</span> MIMEBase(<span class="st">&#39;application&#39;</span>, <span class="st">&#39;octet-stream&#39;</span>)</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>        parte.set_payload(anexo.read())</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>        encoders.encode_base64(parte)</span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>        parte.add_header(<span class="st">&#39;Content-Disposition&#39;</span>, <span class="ss">f&#39;attachment; filename=</span><span class="sc">{</span>caminho_nota<span class="sc">.</span>split(<span class="st">&quot;/&quot;</span>)[<span class="op">-</span><span class="dv">1</span>]<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>        msg.attach(parte)</span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Enviar o e-mail</span></span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> smtplib.SMTP(smtp_server, smtp_port) <span class="im">as</span> server:</span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a>        server.starttls()</span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a>        server.login(smtp_user, smtp_password)</span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a>        server.send_message(msg)</span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de uso</span></span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a>dados_venda <span class="op">=</span> {</span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Cliente&#39;</span>: <span class="st">&#39;João da Silva&#39;</span>,</span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Produto&#39;</span>: <span class="st">&#39;Notebook&#39;</span>,</span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Quantidade&#39;</span>: <span class="dv">1</span>,</span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Valor Unitário&#39;</span>: <span class="fl">5000.00</span>,</span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;CNPJ&#39;</span>: <span class="st">&#39;12.345.678/0001-95&#39;</span></span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a>caminho_nota <span class="op">=</span> <span class="st">&#39;nota_fiscal_joao_silva.csv&#39;</span></span>
<span id="cb57-47"><a href="#cb57-47" aria-hidden="true" tabindex="-1"></a>gerar_nota_fiscal(dados_venda, caminho_nota)</span>
<span id="cb57-48"><a href="#cb57-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-49"><a href="#cb57-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Enviar a nota fiscal por e-mail (descomente a linha abaixo para enviar o e-mail)</span></span>
<span id="cb57-50"><a href="#cb57-50" aria-hidden="true" tabindex="-1"></a><span class="co"># enviar_nota_fiscal_email(&#39;joao@email.com&#39;, &#39;Sua Nota Fiscal&#39;, &#39;Segue em anexo a nota fiscal.&#39;, caminho_nota, &#39;seu_email@gmail.com&#39;, &#39;sua_senha&#39;)</span></span></code></pre></div>
<h2 id="consideracoes-finais-11">18.4. Considerações Finais</h2>
<p>A automação do envio de notas fiscais e respostas automáticas a
clientes pode trazer maior eficiência e agilidade para o processo de
faturamento e atendimento ao cliente, garantindo a conformidade fiscal e
melhorando a experiência do cliente. Com o uso de geração automática de
notas fiscais e envio programático por e-mail, é possível simplificar e
otimizar essa tarefa financeira e comercial.</p>
<hr />
<h1 id="escritorios-que-prestam-servicos-para-reparticoes-publicas-e-orgaos-governamentais">Escritórios que prestam serviços para repartições públicas e órgãos governamentais</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>Escritórios que atuam junto a repartições públicas e órgãos
governamentais enfrentam desafios específicos, como a necessidade de
lidar com grande volume de documentos, atender a exigências legais e
normativas, cumprir prazos rigorosos e garantir a rastreabilidade das
informações. A automação pode ser uma grande aliada nesse contexto,
trazendo mais agilidade, precisão e conformidade para os processos
administrativos e operacionais.</p>
<p>Nesta seção, você aprenderá como aplicar Python para automatizar
tarefas comuns nesse segmento, desde o controle de protocolos e
conversão de documentos até a roteirização de rotas e o acompanhamento
de entregas. Os exemplos apresentados foram pensados para resolver
situações reais enfrentadas por profissionais que prestam serviços para
o setor público, mostrando como a tecnologia pode facilitar o dia a dia
e aumentar a eficiência.</p>
<p>A seguir, você verá como automatizar:</p>
<ul>
<li>O controle automatizado de protocolos em repartições públicas.</li>
<li>A conversão de tabelas em PDF para Excel.</li>
<li>A roteirização com base em distância, utilizando APIs como Google
Maps ou OpenRoute.</li>
<li>O acompanhamento de entregas via planilhas.</li>
</ul>
<hr />
<h1 id="controle-automatizado-de-protocolos-em-reparticao-publica">19.
Controle Automatizado de Protocolos em Repartição Pública</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>O controle de protocolos em repartições públicas é uma atividade
importante para garantir a tramitação adequada de processos e
documentos. Neste exemplo, vamos mostrar como automatizar o controle de
protocolos em uma repartição pública, utilizando Python para ler
planilhas com os dados dos protocolos e enviar notificações
automáticas.</p>
<h2 id="objetivo-12">19.1. Objetivo</h2>
<p>O objetivo deste exemplo é criar um script que:</p>
<ul>
<li>Leia uma planilha com os dados dos protocolos, contendo informações
como número do protocolo, descrição, data de entrada e situação.</li>
<li>Verifique quais protocolos estão com a situação “Pendente”.</li>
<li>Envie um e-mail de notificação para o responsável pelo protocolo,
informando sobre a pendência.</li>
</ul>
<h2 id="estrutura-do-codigo-12">19.2. Estrutura do Código</h2>
<p>O código será estruturado em funções, para facilitar a leitura e a
manutenção. As principais funções serão:</p>
<ul>
<li><code>ler_planilha_protocolos()</code>: Para ler a planilha com os
dados dos protocolos.</li>
<li><code>verificar_protocolos_pendentes()</code>: Para verificar quais
protocolos estão pendentes.</li>
<li><code>enviar_notificacoes_protocolos()</code>: Para enviar as
notificações por e-mail.</li>
</ul>
<h2 id="exemplo-de-codigo-12">19.3. Exemplo de Código</h2>
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> smtplib</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.text <span class="im">import</span> MIMEText</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para ler a planilha de protocolos</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ler_planilha_protocolos(caminho_arquivo):</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.read_excel(caminho_arquivo)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para verificar protocolos pendentes</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> verificar_protocolos_pendentes(df_protocolos):</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_protocolos[df_protocolos[<span class="st">&#39;Situação&#39;</span>] <span class="op">==</span> <span class="st">&#39;Pendente&#39;</span>]</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para enviar notificações por e-mail</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> enviar_notificacoes_protocolos(df_protocolos, smtp_user, smtp_password):</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>    smtp_server <span class="op">=</span> <span class="st">&#39;smtp.gmail.com&#39;</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>    smtp_port <span class="op">=</span> <span class="dv">587</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _, row <span class="kw">in</span> df_protocolos.iterrows():</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>        destinatario <span class="op">=</span> row[<span class="st">&#39;Email&#39;</span>]</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>        assunto <span class="op">=</span> <span class="ss">f&quot;Pendência no Protocolo - </span><span class="sc">{</span>row[<span class="st">&#39;Número do Protocolo&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>        corpo <span class="op">=</span> <span class="ss">f&quot;Prezado(a),</span><span class="ch">\n\n</span><span class="ss">Identificamos uma pendência no protocolo </span><span class="sc">{</span>row[<span class="st">&#39;Número do Protocolo&#39;</span>]<span class="sc">}</span><span class="ss">. Por favor, regularize a situação o quanto antes.</span><span class="ch">\n\n</span><span class="ss">Atenciosamente,&quot;</span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>        msg <span class="op">=</span> MIMEText(corpo)</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>        msg[<span class="st">&#39;Subject&#39;</span>] <span class="op">=</span> assunto</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>        msg[<span class="st">&#39;From&#39;</span>] <span class="op">=</span> smtp_user</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>        msg[<span class="st">&#39;To&#39;</span>] <span class="op">=</span> destinatario</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> smtplib.SMTP(smtp_server, smtp_port) <span class="im">as</span> server:</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>            server.starttls()</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>            server.login(smtp_user, smtp_password)</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>            server.send_message(msg)</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de uso</span></span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>caminho_planilha <span class="op">=</span> <span class="st">&#39;protocolos_reparticao_publica.xlsx&#39;</span></span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>df_protocolos <span class="op">=</span> ler_planilha_protocolos(caminho_planilha)</span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>df_protocolos_pendentes <span class="op">=</span> verificar_protocolos_pendentes(df_protocolos)</span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Enviar notificações (descomente a linha abaixo para enviar os e-mails)</span></span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a><span class="co"># enviar_notificacoes_protocolos(df_protocolos_pendentes, &#39;seu_email@gmail.com&#39;, &#39;sua_senha&#39;)</span></span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Processamento concluído.&quot;</span>)</span></code></pre></div>
<h2 id="consideracoes-finais-12">19.4. Considerações Finais</h2>
<p>A automação do controle de protocolos em repartições públicas pode
trazer maior eficiência e segurança para a tramitação de processos e
documentos, garantindo o cumprimento de prazos e a comunicação adequada
entre as partes envolvidas. Com o uso de planilhas e o envio automático
de notificações por e-mail, é possível simplificar e otimizar essa
tarefa administrativa.</p>
<hr />
<h1 id="conversor-de-tabelas-pdf-excel">20. Conversor de tabelas PDF →
Excel</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>A conversão de tabelas em PDF para Excel é uma tarefa comum em
escritórios que lidam com dados financeiros, orçamentos, relatórios e
outros documentos que contêm tabelas. Neste exemplo, vamos mostrar como
automatizar a conversão de tabelas em PDF para Excel, utilizando Python
para extrair os dados das tabelas e salvá-los em um arquivo Excel.</p>
<h2 id="objetivo-13">20.1. Objetivo</h2>
<p>O objetivo deste exemplo é criar um script que:</p>
<ul>
<li>Leia um arquivo PDF contendo uma tabela.</li>
<li>Extraia os dados da tabela e os salve em um arquivo Excel.</li>
</ul>
<h2 id="estrutura-do-codigo-13">20.2. Estrutura do Código</h2>
<p>O código será estruturado em funções, para facilitar a leitura e a
manutenção. As principais funções serão:</p>
<ul>
<li><code>ler_tabela_pdf()</code>: Para ler a tabela do arquivo
PDF.</li>
<li><code>salvar_tabela_excel()</code>: Para salvar a tabela em um
arquivo Excel.</li>
</ul>
<h2 id="exemplo-de-codigo-13">20.3. Exemplo de Código</h2>
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pdfplumber</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para ler a tabela do PDF</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ler_tabela_pdf(caminho_arquivo):</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> pdfplumber.<span class="bu">open</span>(caminho_arquivo) <span class="im">as</span> pdf:</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>        primeira_pagina <span class="op">=</span> pdf.pages[<span class="dv">0</span>]</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>        tabela <span class="op">=</span> primeira_pagina.extract_table()</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tabela</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para salvar a tabela em um arquivo Excel</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> salvar_tabela_excel(tabela, caminho_saida):</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>    df_tabela <span class="op">=</span> pd.DataFrame(tabela[<span class="dv">1</span>:], columns<span class="op">=</span>tabela[<span class="dv">0</span>])</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>    df_tabela.to_excel(caminho_saida, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Tabela salva em Excel: </span><span class="sc">{</span>caminho_saida<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de uso</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>caminho_pdf <span class="op">=</span> <span class="st">&#39;tabela.pdf&#39;</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>caminho_excel <span class="op">=</span> <span class="st">&#39;tabela.xlsx&#39;</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>tabela_extraida <span class="op">=</span> ler_tabela_pdf(caminho_pdf)</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>salvar_tabela_excel(tabela_extraida, caminho_excel)</span></code></pre></div>
<h2 id="consideracoes-finais-13">20.4. Considerações Finais</h2>
<p>A automação da conversão de tabelas em PDF para Excel pode trazer
maior eficiência e precisão para o trabalho com dados em escritórios,
facilitando a análise e o compartilhamento das informações. Com o uso de
arquivos PDF e Excel, e a automação do processamento e conversão de
dados, é possível simplificar e otimizar essa tarefa de manipulação de
dados.</p>
<hr />
<h1
id="roteirizacao-com-base-em-distancia-api-google-maps-ou-openroute-1">21.
Roteirização com base em distância (API Google Maps ou OpenRoute)</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>A roteirização é uma atividade fundamental para a otimização do
transporte de mercadorias, permitindo a definição das melhores rotas a
serem seguidas pelos veículos. Neste exemplo, vamos mostrar como
automatizar a roteirização com base em distância, utilizando APIs como
Google Maps ou OpenRoute.</p>
<h2 id="objetivo-14">21.1. Objetivo</h2>
<p>O objetivo deste exemplo é criar um script que:</p>
<ul>
<li>Receba uma lista de endereços de origem e destino.</li>
<li>Calcule a rota mais curta ou mais rápida entre os pontos, utilizando
a API escolhida.</li>
<li>Exiba o resultado com as informações da rota, como distância e tempo
estimado.</li>
</ul>
<h2 id="estrutura-do-codigo-14">21.2. Estrutura do Código</h2>
<p>O código será estruturado em funções, para facilitar a leitura e a
manutenção. As principais funções serão:</p>
<ul>
<li><code>calcular_rota_google_maps()</code>: Para calcular a rota
utilizando a API do Google Maps.</li>
<li><code>calcular_rota_openroute()</code>: Para calcular a rota
utilizando a API do OpenRoute.</li>
</ul>
<h2 id="exemplo-de-codigo-14">21.3. Exemplo de Código</h2>
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para calcular a rota utilizando a API do Google Maps</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calcular_rota_google_maps(origem, destino, chave_api):</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    url <span class="op">=</span> <span class="ss">f&quot;https://maps.googleapis.com/maps/api/directions/json?origin=</span><span class="sc">{</span>origem<span class="sc">}</span><span class="ss">&amp;destination=</span><span class="sc">{</span>destino<span class="sc">}</span><span class="ss">&amp;key=</span><span class="sc">{</span>chave_api<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> requests.get(url)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    dados <span class="op">=</span> response.json()</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> dados[<span class="st">&#39;status&#39;</span>] <span class="op">==</span> <span class="st">&#39;OK&#39;</span>:</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>        rota <span class="op">=</span> dados[<span class="st">&#39;routes&#39;</span>][<span class="dv">0</span>]</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>        distancia <span class="op">=</span> rota[<span class="st">&#39;legs&#39;</span>][<span class="dv">0</span>][<span class="st">&#39;distance&#39;</span>][<span class="st">&#39;text&#39;</span>]</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>        tempo <span class="op">=</span> rota[<span class="st">&#39;legs&#39;</span>][<span class="dv">0</span>][<span class="st">&#39;duration&#39;</span>][<span class="st">&#39;text&#39;</span>]</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&quot;Distância: </span><span class="sc">{</span>distancia<span class="sc">}</span><span class="ss">, Tempo: </span><span class="sc">{</span>tempo<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;Erro ao calcular a rota.&quot;</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para calcular a rota utilizando a API do OpenRoute</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calcular_rota_openroute(origem, destino):</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>    url <span class="op">=</span> <span class="ss">f&quot;https://api.openrouteservice.org/v2/directions/driving-car?api_key=sua_chave_api&amp;start=</span><span class="sc">{</span>origem<span class="sc">}</span><span class="ss">&amp;end=</span><span class="sc">{</span>destino<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> requests.get(url)</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>    dados <span class="op">=</span> response.json()</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> dados[<span class="st">&#39;routes&#39;</span>]:</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>        rota <span class="op">=</span> dados[<span class="st">&#39;routes&#39;</span>][<span class="dv">0</span>]</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>        distancia <span class="op">=</span> rota[<span class="st">&#39;summary&#39;</span>][<span class="st">&#39;length&#39;</span>]</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>        tempo <span class="op">=</span> rota[<span class="st">&#39;summary&#39;</span>][<span class="st">&#39;duration&#39;</span>]</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&quot;Distância: </span><span class="sc">{</span>distancia<span class="sc">}</span><span class="ss"> metros, Tempo: </span><span class="sc">{</span>tempo<span class="sc">}</span><span class="ss"> segundos&quot;</span></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;Erro ao calcular a rota.&quot;</span></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de uso</span></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>origem <span class="op">=</span> <span class="st">&quot;-23.550520, -46.633308&quot;</span>  <span class="co"># São Paulo</span></span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>destino <span class="op">=</span> <span class="st">&quot;-22.906847, -43.172896&quot;</span>  <span class="co"># Rio de Janeiro</span></span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular rota pelo Google Maps</span></span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>resultado_google_maps <span class="op">=</span> calcular_rota_google_maps(origem, destino, <span class="st">&#39;sua_chave_api_google_maps&#39;</span>)</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Google Maps:&quot;</span>, resultado_google_maps)</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular rota pelo OpenRoute</span></span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>resultado_openroute <span class="op">=</span> calcular_rota_openroute(origem, destino)</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;OpenRoute:&quot;</span>, resultado_openroute)</span></code></pre></div>
<h2 id="consideracoes-finais-14">21.4. Considerações Finais</h2>
<p>A automação da roteirização com base em distância pode trazer ganhos
significativos de eficiência e economia para as operações de transporte,
permitindo a definição de rotas otimizadas e a redução de custos com
combustível e tempo de viagem. Com o uso de APIs de mapeamento e a
automação do processamento das informações, é possível simplificar e
otimizar essa tarefa logística.</p>
<hr />
<h1 id="acompanhamento-de-entregas-via-planilhas-1">22. Acompanhamento
de entregas via planilhas</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>O acompanhamento de entregas é uma atividade importante para garantir
a satisfação dos clientes e a eficiência das operações de logística.
Neste exemplo, vamos mostrar como automatizar o acompanhamento de
entregas, utilizando Python para ler planilhas com os dados das entregas
e enviar notificações automáticas.</p>
<h2 id="objetivo-15">22.1. Objetivo</h2>
<p>O objetivo deste exemplo é criar um script que:</p>
<ul>
<li>Leia uma planilha com os dados das entregas, contendo informações
como código da entrega, cliente, endereço, data e status.</li>
<li>Envie notificações automáticas para os clientes, informando sobre o
status da entrega.</li>
</ul>
<h2 id="estrutura-do-codigo-15">22.2. Estrutura do Código</h2>
<p>O código será estruturado em funções, para facilitar a leitura e a
manutenção. As principais funções serão:</p>
<ul>
<li><code>ler_planilha_entregas()</code>: Para ler a planilha com os
dados das entregas.</li>
<li><code>enviar_notificacoes()</code>: Para enviar as notificações
automáticas.</li>
</ul>
<h2 id="exemplo-de-codigo-15">22.3. Exemplo de Código</h2>
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> smtplib</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.text <span class="im">import</span> MIMEText</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para ler a planilha de entregas</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ler_planilha_entregas(caminho_arquivo):</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.read_excel(caminho_arquivo)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para enviar notificações automáticas</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> enviar_notificacoes(df_entregas, smtp_user, smtp_password):</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    smtp_server <span class="op">=</span> <span class="st">&#39;smtp.gmail.com&#39;</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    smtp_port <span class="op">=</span> <span class="dv">587</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _, row <span class="kw">in</span> df_entregas.iterrows():</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>        destinatario <span class="op">=</span> row[<span class="st">&#39;Email&#39;</span>]</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>        assunto <span class="op">=</span> <span class="ss">f&quot;Atualização sobre sua entrega - </span><span class="sc">{</span>row[<span class="st">&#39;Código da Entrega&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>        corpo <span class="op">=</span> <span class="ss">f&quot;Prezado(a),</span><span class="ch">\n\n</span><span class="ss">Informamos que o status da sua entrega </span><span class="sc">{</span>row[<span class="st">&#39;Código da Entrega&#39;</span>]<span class="sc">}</span><span class="ss"> foi atualizado para: </span><span class="sc">{</span>row[<span class="st">&#39;Status&#39;</span>]<span class="sc">}</span><span class="ss">.</span><span class="ch">\n\n</span><span class="ss">Atenciosamente,&quot;</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>        msg <span class="op">=</span> MIMEText(corpo)</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>        msg[<span class="st">&#39;Subject&#39;</span>] <span class="op">=</span> assunto</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>        msg[<span class="st">&#39;From&#39;</span>] <span class="op">=</span> smtp_user</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>        msg[<span class="st">&#39;To&#39;</span>] <span class="op">=</span> destinatario</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> smtplib.SMTP(smtp_server, smtp_port) <span class="im">as</span> server:</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>            server.starttls()</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>            server.login(smtp_user, smtp_password)</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>            server.send_message(msg)</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de uso</span></span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>caminho_planilha <span class="op">=</span> <span class="st">&#39;entregas.xlsx&#39;</span></span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>df_entregas <span class="op">=</span> ler_planilha_entregas(caminho_planilha)</span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Enviar notificações (descomente a linha abaixo para enviar os e-mails)</span></span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a><span class="co"># enviar_notificacoes(df_entregas, &#39;seu_email@gmail.com&#39;, &#39;sua_senha&#39;)</span></span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Processamento concluído.&quot;</span>)</span></code></pre></div>
<h2 id="consideracoes-finais-15">22.4. Considerações Finais</h2>
<p>A automação do acompanhamento de entregas pode trazer maior
eficiência e agilidade para as operações de logística, melhorando a
comunicação com os clientes e a gestão das entregas. Com o uso de
planilhas e o envio automático de notificações por e-mail, é possível
simplificar e otimizar essa tarefa logística.</p>
<hr />
<h1 id="conclusao-1">23. Conclusão</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>A automação de processos em escritórios que prestam serviços para
repartições públicas e órgãos governamentais pode trazer ganhos
significativos de eficiência, precisão e conformidade. Com o uso de
ferramentas como Python, planilhas e APIs, é possível simplificar
tarefas administrativas, melhorar a comunicação com os clientes e
otimizar a gestão de documentos e processos. A implementação de soluções
automatizadas pode reduzir o tempo gasto em atividades repetitivas,
minimizar erros humanos e garantir que os prazos sejam cumpridos de
forma mais eficaz. Além disso, a automação pode facilitar o acesso e a
análise de dados, permitindo uma tomada de decisão mais informada e
ágil. Com o avanço da tecnologia e a crescente demanda por eficiência
nos serviços públicos, a automação se torna uma ferramenta indispensável
para os profissionais que atuam nesse setor.</p>
<hr />
<h1 id="agradecimentos">24. Agradecimentos</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>Agradecemos a todos os leitores e profissionais que contribuíram para
a elaboração deste material. Esperamos que os exemplos apresentados
tenham sido úteis e inspiradores, e que possam ser aplicados na prática
para melhorar a eficiência e a produtividade em seus escritórios.</p>
<hr />
<h1 id="referencias-bibliograficas-formato-abnt">25. Referências Bibliográficas (Formato ABNT)</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<p>FAKER. Faker Documentation. Disponível em: <a
href="https://faker.readthedocs.io/"
class="uri">https://faker.readthedocs.io/</a>. Acesso em: 17 jun.
2025.</p>
<p>FPDF. FPDF Documentation. Disponível em: <a
href="http://www.fpdf.org/" class="uri">http://www.fpdf.org/</a>. Acesso
em: 17 jun. 2025.</p>
<p>GOOGLE DEVELOPERS. Google Maps Platform Documentation. Disponível em:
<a href="https://developers.google.com/maps/documentation"
class="uri">https://developers.google.com/maps/documentation</a>. Acesso
em: 17 jun. 2025.</p>
<p>LUTZ, Mark. Learning Python. 5. ed. Sebastopol: O’Reilly Media,
2013.</p>
<p>MCKINNEY, Wes. Python for Data Analysis. 3. ed. Sebastopol: O’Reilly
Media, 2022.</p>
<p>OPENPYXL. OpenPyXL Documentation. Disponível em: <a
href="https://openpyxl.readthedocs.io/"
class="uri">https://openpyxl.readthedocs.io/</a>. Acesso em: 17 jun.
2025.</p>
<p>OPENROUTESERVICE. API Documentation. Disponível em: <a
href="https://openrouteservice.org/sign-up/"
class="uri">https://openrouteservice.org/sign-up/</a>. Acesso em: 17
jun. 2025.</p>
<p>PANDAS DEVELOPMENT TEAM. Pandas Documentation. Disponível em: <a
href="https://pandas.pydata.org/docs/"
class="uri">https://pandas.pydata.org/docs/</a>. Acesso em: 17 jun.
2025.</p>
<p>PDFPLUMBER. pdfplumber Documentation. Disponível em: <a
href="https://github.com/jsvine/pdfplumber"
class="uri">https://github.com/jsvine/pdfplumber</a>. Acesso em: 17 jun.
2025.</p>
<p>PYTHON SOFTWARE FOUNDATION. Python Documentation. Disponível em: <a
href="https://docs.python.org/3/"
class="uri">https://docs.python.org/3/</a>. Acesso em: 17 jun. 2025.</p>
<p>PYTHON-DOCX. python-docx Documentation. Disponível em: <a
href="https://python-docx.readthedocs.io/"
class="uri">https://python-docx.readthedocs.io/</a>. Acesso em: 17 jun.
2025.</p>
<p>PYPDF2. PyPDF2 Documentation. Disponível em: <a
href="https://pypdf2.readthedocs.io/"
class="uri">https://pypdf2.readthedocs.io/</a>. Acesso em: 17 jun.
2025.</p>
<p>PYWEBIO. PyWebIO Documentation. Disponível em: <a
href="https://pywebio.readthedocs.io/"
class="uri">https://pywebio.readthedocs.io/</a>. Acesso em: 17 jun.
2025.</p>
<p>REITZ, Kenneth; SCHLUSSER, Tanya. The Hitchhiker’s Guide to Python.
Sebastopol: O’Reilly Media, 2021.</p>
<p>REQUESTS. Requests: HTTP for Humans. Disponível em: <a
href="https://docs.python-requests.org/en/latest/"
class="uri">https://docs.python-requests.org/en/latest/</a>. Acesso em:
17 jun. 2025.</p>
<p>RICHARDSON, Leonard. BeautifulSoup Documentation. Disponível em: <a
href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/"
class="uri">https://www.crummy.com/software/BeautifulSoup/bs4/doc/</a>.
Acesso em: 17 jun. 2025.</p>
<p>SELENIUMHQ. Selenium with Python Documentation. Disponível em: <a
href="https://selenium-python.readthedocs.io/"
class="uri">https://selenium-python.readthedocs.io/</a>. Acesso em: 17
jun. 2025.</p>
<p>SWEIGART, Al. Automate the Boring Stuff with Python. 2. ed. San
Francisco: No Starch Press, 2019.</p>
<p>TKDOCS. Tkinter Documentation. Disponível em: <a
href="https://tkdocs.com/" class="uri">https://tkdocs.com/</a>. Acesso
em: 17 jun. 2025.</p>
<p>VANDERPLAS, Jake. Python Data Science Handbook. Sebastopol: O’Reilly
Media, 2016.</p>
<hr />
<h1 id="adendo-codigos-em-python">26. ADENDO: Códigos em Python</h1>
<a class="voltar" href="#sumario">↩ Voltar ao Sumário</a>
<ul>
<li>Exemplo Prático 01 – Análise de vendas de produtos online
(CSV)<br />
<code>01_analise_vendas_csv.py</code></li>
<li>Exemplo Prático 02 – Geração de relatórios financeiros (Excel)<br />
<code>02_relatorio_financeiro_excel.py</code></li>
<li>Exemplo Prático 03 – Controle de inadimplência em aluguéis (Excel +
E-mail)<br />
<code>03_inadimplencia_alugueis_email.py</code></li>
<li>Exemplo Prático 04 – Envio de e-mails automatizados (Python +
SMTP)<br />
<code>04_envio_email_automatizado.py</code></li>
<li>Exemplo Prático 05 – Extração de texto de um PDF<br />
<code>05_extracao_texto_pdf.py</code></li>
<li>Exemplo Prático 06 – Leitura e modificação de um arquivo Word<br />
<code>06_modificacao_word.py</code></li>
<li>Exemplo Prático 07 – Automação de Excel com Pandas<br />
<code>07_automacao_excel_pandas.py</code></li>
<li>Exemplo Prático 08 – Geração e envio de múltiplos relatórios diários
por e-mail<br />
<code>08_relatorios_diarios_email.py</code></li>
<li>Exemplo Prático 09 – Web scraping básico com BeautifulSoup<br />
<code>09_webscraping_beautifulsoup.py</code></li>
<li>Exemplo Prático 10 – Extração de tabelas HTML para Excel<br />
<code>10_extracao_tabelas_html_excel.py</code></li>
<li>Exemplo Prático 11 – Automação de sites com Selenium<br />
<code>11_automacao_sites_selenium.py</code></li>
<li>Exemplo Prático 12 – Interface gráfica simples com Tkinter<br />
<code>12_interface_tkinter.py</code></li>
<li>Exemplo Prático 13 – Interface web simples com PyWebIO<br />
<code>13_interface_pywebio.py</code></li>
<li>Exemplo Prático 14 – Gerador automático de procurações e
petições<br />
<code>14_gerador_procuracoes_peticiones.py</code></li>
<li>Exemplo Prático 15 – Controle de prazos processuais com
alertas<br />
<code>15_controle_prazos_alertas.py</code></li>
<li>Exemplo Prático 16 – Consulta automatizada a sites de
tribunais<br />
<code>16_consulta_tribunais.py</code></li>
<li>Exemplo Prático 17 – Leitura e consolidação de extratos
bancários<br />
<code>17_extratos_bancarios.py</code></li>
<li>Exemplo Prático 18 – Geração automática de guias de impostos<br />
<code>18_geracao_guias_impostos.py</code></li>
<li>Exemplo Prático 19 – Envio automático de boletos por e-mail<br />
<code>19_envio_boletos_email.py</code></li>
<li>Exemplo Prático 20 – Leitura e geração de manifestos (XML,
PDF)<br />
<code>20_manifestos_xml_pdf.py</code></li>
<li>Exemplo Prático 21 – Roteirização com base em distância (API)<br />
<code>21_roteirizacao_api.py</code></li>
<li>Exemplo Prático 22 – Acompanhamento de entregas via planilhas<br />
<code>22_acompanhamento_entregas_planilha.py</code></li>
<li>Exemplo Prático 23 – Leitura de pedidos de marketplaces<br />
<code>23_leitura_pedidos_marketplace.py</code></li>
<li>Exemplo Prático 24 – Atualização automática de estoque<br />
<code>24_atualizacao_estoque.py</code></li>
<li>Exemplo Prático 25 – Envio de notas fiscais e respostas
automáticas<br />
<code>25_envio_notas_respostas.py</code></li>
<li>Exemplo Prático 26 – Controle automatizado de protocolos<br />
<code>26_controle_protocolos.py</code></li>
<li>Exemplo Prático 27 – Conversor de tabelas PDF para Excel<br />
<code>27_pdf_para_excel.py</code></li>
<li>Exemplo Prático 28 – Organizador de arquivos em pastas por
cliente<br />
<code>28_organizador_arquivos_clientes.py</code></li>
<li>Exemplo Prático 29 – Dashboard de pagamentos<br />
<code>29_dashboard_pagamentos.py</code></li>
<li>Exemplo Prático 30 – Calculadora de impostos com interface<br />
<code>30_calculadora_impostos_interface.py</code></li>
</ul>
<div class="contracapa">
<img src="images/contra_capa.png" alt="Contra Capa do Livro">
</div>
</body>
</html>
