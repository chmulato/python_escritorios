CAPA
```plaintext
 ___________________________________________________________
|                                                           |
|   ____        _   _                 _                     |
|  |  _ \ _   _| |_| |__   ___   ___ | | ___   _ _ __       |
|  | |_) | | | | __| '_ \ / _ \ / _ \| |/ / | | | '_ \      |
|  |  __/| |_| | |_| | | | (_) | (_) |   <| |_| | |_) |     |
|  |_|    \__, |\__|_| |_|\___/ \___/|_|\_\\__,_| .__/      |
|         |___/                                   |_|       |
|                                                           |
|   ‚öñÔ∏è   [ ]   üöö   üõí                                     |
|                                                           |
|   AUTOMA√á√ÉO DE TAREFAS PARA ESCRIT√ìRIOS                   |
|   COM PYTHON E INTELIG√äNCIA ARTIFICIAL                    |
|                                                           |
|   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       |
|   ‚îÇ [  ][  ][  ][  ][  ][  ][  ][  ][  ][  ][  ]  ‚îÇ       |
|   ‚îÇ [  ][  ][  ][  ][PY][  ][  ][  ][  ][  ][  ]  ‚îÇ       |
|   ‚îÇ [  ][  ][  ][  ][  ][  ][  ][  ][  ][  ][  ]  ‚îÇ       |
|   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       |
|                                                           |
|   Christian Mulato - Programador de Computador            |
|___________________________________________________________|

# Automa√ß√£o de Tarefas para Escrit√≥rios com Python e Intelig√™ncia Artificial
**Christian Mulato**
Programador de Computador
**ISBN:** 978-65-0000-000-0
**Data de publica√ß√£o:** Junho de 2025
**Direitos Autorais Reservados**
```

***

# Apresenta√ß√£o

Vivemos uma era em que a tecnologia e a intelig√™ncia artificial podem transformar o dia a dia dos escrit√≥rios, tornando tarefas repetitivas mais r√°pidas, precisas e menos cansativas. No entanto, muitos profissionais ainda gastam horas com atividades manuais que poderiam ser facilmente automatizadas.

Este livro nasceu da vontade de aproximar o poder da programa√ß√£o ‚Äî especialmente do Python ‚Äî e da intelig√™ncia artificial do ambiente de escrit√≥rios, sejam eles de advocacia, contabilidade, log√≠stica, vendas ou servi√ßos para reparti√ß√µes p√∫blicas e √≥rg√£os governamentais. O objetivo √© mostrar, de forma pr√°tica e acess√≠vel, como automatizar processos comuns, economizar tempo e aumentar a produtividade, mesmo para quem nunca programou antes.

Ao longo dos cap√≠tulos, voc√™ encontrar√° exemplos reais, projetos pr√°ticos e dicas para aplicar imediatamente no seu trabalho. N√£o √© necess√°rio ser um especialista em tecnologia: basta curiosidade e vontade de aprender.

O conte√∫do est√° dividido em duas partes principais para facilitar o aprendizado e a aplica√ß√£o dos conceitos:

- **Parte I ‚Äì Fundamentos da Automa√ß√£o:** 
- Aqui voc√™ aprender√° os conceitos essenciais, desde a instala√ß√£o do ambiente at√© a manipula√ß√£o de arquivos, automa√ß√£o de e-mails, web scraping, cria√ß√£o de interfaces gr√°ficas simples e introdu√ß√£o ao uso de intelig√™ncia artificial em tarefas do escrit√≥rio.

- **Parte II ‚Äì Casos Reais por Tipo de Escrit√≥rio:**
-  Nesta parte, apresentamos exemplos pr√°ticos e projetos voltados para diferentes √°reas, incluindo escrit√≥rios que prestam servi√ßos para reparti√ß√µes p√∫blicas e √≥rg√£os governamentais, mostrando como adaptar as solu√ß√µes para a sua realidade.

Espero que este material ajude voc√™ a transformar sua rotina profissional, abrindo portas para novas possibilidades e mostrando que a automa√ß√£o e a intelig√™ncia artificial est√£o ao alcance de todos.

Boa leitura e √≥timos projetos!

**Christian Mulato**  
Programador de Computador

***

# Sum√°rio

## Parte 1 ‚Äì Fundamentos da Automa√ß√£o

1. [Introdu√ß√£o √† automa√ß√£o com Python](#1-introdu√ß√£o-√†-automa√ß√£o-com-python)  
2. [Instala√ß√£o de ambiente: VS Code, Python, bibliotecas √∫teis](#2-instala√ß√£o-de-ambiente-vs-code-python-e-bibliotecas-√∫teis)  
3. [Trabalhando com arquivos (Excel, CSV, PDF, Word)](#3-trabalhando-com-arquivos-excel-csv-pdf-word)  
4. [Automa√ß√£o de e-mails e notifica√ß√µes](#4-automa√ß√£o-de-e-mails-e-notifica√ß√µes) 
5. [Web scraping e automa√ß√£o de sites](#5-web-scraping-e-automa√ß√£o-de-sites) 
6. [Cria√ß√£o de interfaces gr√°ficas simples (Tkinter ou PyWebIO)](#6-cria√ß√£o-de-interfaces-gr√°ficas-simples-tkinter-ou-pywebio)  

## Parte 2 ‚Äì Casos Reais por Tipo de Escrit√≥rio

### Escrit√≥rio de Advocacia

7. [Gerador autom√°tico de procura√ß√µes e peti√ß√µes a partir de modelos](#7-gerador-autom√°tico-de-procura√ß√µes-e-peti√ß√µes-a-partir-de-modelos)  
8. [Controle de prazos processuais (leitura de planilhas + envio de alertas por e-mail)](#8-controle-de-prazos-processuais-leitura-de-planilhas--envio-de-alertas-por-e-mail)  
9. [Consulta a sites de tribunais](#9-consulta-a-sites-de-tribunais)  

### Escrit√≥rio de Contabilidade

10. [Leitura e consolida√ß√£o de extratos banc√°rios (CSV)](#10-leitura-e-consolida√ß√£o-de-extratos-banc√°rios-csv)  
11. [Gera√ß√£o autom√°tica de guias de impostos](#11-gera√ß√£-autom√°tica-de-guias-de-impostos)  
12. [Envio autom√°tico de boletos por e-mail](#12-envio-autom√°tico-de-boletos-por-e-mail)  

### Escrit√≥rio de Log√≠stica

13. [Leitura e gera√ß√£o de manifestos (XML, PDF)](#13-leitura-e-gera√ß√£-de-manifestos-xml-pdf)  
14. [Roteiriza√ß√£o com base em dist√¢ncia (API Google Maps ou OpenRoute)](#14-roteiriza√ß√£o-com-base-em-dist√¢ncia-api-google-maps-ou-openroute)  
15. [Acompanhamento de entregas via planilhas atualizadas](#15-acompanhamento-de-entregas-via-planilhas-atualizadas)  

### E-commerce e Vendas Online

16. [Leitura de pedidos de marketplaces](#16-leitura-de-pedidos-de-marketplaces)  
17. [Atualiza√ß√£o autom√°tica de estoque em Excel/ERP simples](#17-atualiza√ß√£o-autom√°tica-de-estoque-em-excelerp-simples)  
18. [Envio de notas fiscais e respostas autom√°ticas a clientes](#18-envio-de-notas-fiscais-e-respostas-autom√°ticas-a-clientes)  

### Escrit√≥rios que prestam servi√ßos para reparti√ß√µes p√∫blicas e √≥rg√£os governamentais

19. [Controle Automatizado de Protocolos em Reparti√ß√£o P√∫blica](#19-controle-automatizado-de-protocolos-em-reparti√ß√£o-p√∫blica)
20. [Conversor de tabelas PDF ‚Üí Excel](#20-conversor-de-tabelas-pdf--excel)
21. [Organizador de arquivos em pastas por cliente](#21-organizador-de-arquivos-em-pastas-por-cliente)
22. [Dashboard de pagamentos](#22-dashboard-de-pagamentos)

## Anexos

- Figuras e diagramas  
- Refer√™ncias

## C√≥digos em Python

- Exemplo Pr√°tico 01 - An√°lise de vendas de produtos online (CSV)
   - `codes/01_exemplo_pratico_vendas_online.py`
- Exemplo Pr√°tico 02 - Gera√ß√£o de relat√≥rios financeiros (Excel)
   - `codes/02_exemplo_pratico_relatorio_financeiro.py`
- Exemplo Pr√°tico 03 - Controle de inadimpl√™ncia em alugu√©is (Excel + E-mail)
   - `codes/03_exemplo_pratico_alugueis_com_email.py`
- Exemplo Pr√°tico 04 - Envio de e-mails automatizados (Python + SMTP)
   - `codes/04_exemplo_pratico_envio_email.py`
- Exemplo Pr√°tico 05 - Extra√ß√£o de texto de um PDF
   - `codes/05_exemplo_pratico_extracao_pdf.py`
- Exemplo Pr√°tico 06 - Leitura e modifica√ß√£o de um arquivo Word
   - `codes/06_exemplo_pratico_modificacao_word.py`
- Exemplo Pr√°tico 07 - Automa√ß√£o de Google Sheets
   - `codes/07_exemplo_pratico_automacao_excel.py`
- Exemplo Pr√°tico 08 - Envio de relat√≥rios di√°rios por e-mail
   - `codes/08_exemplo_pratico_envio_relatorio_diario.py`

***

# Introdu√ß√£o

A automa√ß√£o de tarefas rotineiras √© uma das maiores oportunidades para escrit√≥rios que desejam ganhar produtividade, reduzir erros e liberar tempo para atividades mais estrat√©gicas. Python, por ser uma linguagem acess√≠vel, poderosa e com vasta comunidade, tornou-se a escolha ideal para quem quer come√ßar a automatizar processos no dia a dia profissional.

Este livro foi pensado para ser um guia pr√°tico, direto ao ponto, e acess√≠vel mesmo para quem nunca programou antes. O conte√∫do est√° dividido em duas partes principais, para facilitar o aprendizado e a aplica√ß√£o dos conceitos:

## Parte I ‚Äì Fundamentos da Automa√ß√£o

Na primeira parte, voc√™ aprender√° os conceitos essenciais para come√ßar a automatizar tarefas com Python. Aqui, abordamos desde a instala√ß√£o do ambiente, passando pelo trabalho com arquivos, automa√ß√£o de e-mails, web scraping e at√© a cria√ß√£o de interfaces gr√°ficas simples. O objetivo √© construir uma base s√≥lida, permitindo que voc√™ entenda como Python pode ser aplicado em diferentes situa√ß√µes do cotidiano de um escrit√≥rio.

## Parte II ‚Äì Casos Reais por Tipo de Escrit√≥rio

Na segunda parte, apresentamos exemplos pr√°ticos e projetos voltados para √°reas espec√≠ficas: advocacia, contabilidade, log√≠stica e e-commerce. Cada cap√≠tulo traz situa√ß√µes reais enfrentadas nesses segmentos e mostra, passo a passo, como resolv√™-las com Python. Assim, voc√™ poder√° adaptar as solu√ß√µes para a sua realidade, independentemente do ramo de atua√ß√£o.

Ao final, voc√™ encontrar√° projetos pr√°ticos para consolidar o aprendizado e estimular a criatividade na busca por novas automa√ß√µes.

Esperamos que este livro seja um ponto de partida para transformar sua rotina profissional, tornando seu escrit√≥rio mais inteligente, eficiente e preparado para os desafios

***

# Parte I ‚Äì Fundamentos da Automa√ß√£o

Nesta primeira parte, voc√™ vai aprender os conceitos e ferramentas essenciais para come√ßar a automatizar tarefas com Python no ambiente de escrit√≥rio. O objetivo √© construir uma base s√≥lida, mesmo para quem nunca programou antes, mostrando passo a passo como instalar o ambiente, manipular arquivos, enviar e-mails automaticamente, coletar informa√ß√µes da internet e criar interfaces gr√°ficas simples.

Ao dominar esses fundamentos, voc√™ estar√° preparado para aplicar a automa√ß√£o em diferentes √°reas e desafios do dia a dia profissional.

***

# 1. Introdu√ß√£o √† automa√ß√£o com Python

Automa√ß√£o √© o processo de usar tecnologia para executar tarefas de forma autom√°tica, reduzindo a necessidade de interven√ß√£o manual. No contexto dos escrit√≥rios, isso significa transformar atividades repetitivas e demoradas em processos r√°pidos, precisos e eficientes.

Python √© uma das linguagens de programa√ß√£o mais populares para automa√ß√£o devido √† sua simplicidade, legibilidade e grande quantidade de bibliotecas prontas para uso. Com Python, √© poss√≠vel automatizar desde tarefas simples, como renomear arquivos em lote, at√© processos mais complexos, como gerar relat√≥rios, enviar e-mails, manipular planilhas e interagir com sistemas web.

### Por que automatizar com Python?

- **Facilidade de aprendizado:** Python possui uma sintaxe clara e intuitiva, ideal para iniciantes.
- **Comunidade ativa:** H√° muitos tutoriais, f√≥runs e exemplos dispon√≠veis.
- **Bibliotecas poderosas:** Existem m√≥dulos prontos para manipular arquivos, enviar e-mails, acessar bancos de dados, trabalhar com planilhas, PDFs, web scraping, entre outros.
- **Versatilidade:** Python pode ser usado em diferentes sistemas operacionais e integrado a diversas ferramentas j√° utilizadas em escrit√≥rios.

### Exemplos de automa√ß√£o em escrit√≥rios

- Organizar e renomear arquivos automaticamente.
- Preencher e gerar documentos a partir de modelos.
- Ler e consolidar dados de planilhas.
- Enviar e-mails em massa ou com anexos personalizados.
- Coletar informa√ß√µes de sites automaticamente (web scraping).
- Gerar relat√≥rios e dashboards de forma autom√°tica.

Ao longo deste livro, voc√™ ver√° como essas e outras tarefas podem ser automatizadas, tornando o seu dia a dia mais produtivo e eficiente. Vamos come√ßar a jornada pela automa√ß√£o com Python!

***

# 2. Instala√ß√£o de Ambiente: VS Code, Python e Bibliotecas √öteis

Antes de iniciar os exemplos pr√°ticos, √© importante preparar o ambiente de desenvolvimento. Siga os passos abaixo:

## 2.1. Instale o Visual Studio Code (VS Code)

- Acesse: [https://code.visualstudio.com/](https://code.visualstudio.com/)
- Baixe e instale a vers√£o adequada para o seu sistema operacional (Windows, macOS ou Linux).

## 2.2. Instale o Python

- Acesse: [https://www.python.org/downloads/](https://www.python.org/downloads/)
- Baixe a vers√£o mais recente do Python 3.x.
- Durante a instala√ß√£o, marque a op√ß√£o **"Add Python to PATH"**.

## 2.3. Instale Bibliotecas √öteis

Abra o terminal do VS Code (atalho: `Ctrl + ``) e execute os comandos abaixo para instalar as principais bibliotecas que ser√£o usadas nos exemplos:

```bash
pip install pandas openpyxl
```

- `pandas`: Manipula√ß√£o de dados e leitura de planilhas Excel.
- `openpyxl`: Leitura e escrita de arquivos `.xlsx` (Excel).

## 2.4. (Opcional) Instale Extens√µes no VS Code

- **Python** (Microsoft): Suporte a sintaxe, depura√ß√£o e execu√ß√£o de scripts Python.
- **Jupyter**: Para notebooks interativos, se desejar.

---

> Ap√≥s esses passos, seu ambiente estar√° pronto para executar os exemplos pr√°ticos.

***

# 3. Trabalhando com arquivos (Excel, CSV, PDF, Word)

Nesta se√ß√£o, voc√™ aprender√° a manipular diferentes tipos de arquivos comuns no ambiente de escrit√≥rio, como Excel, CSV, PDF e Word. Essas habilidades s√£o essenciais para automatizar tarefas que envolvem leitura, escrita e processamento de dados.

## 3.1. Arquivos CSV

Para ler e escrever arquivos CSV, use o m√≥dulo csv ou o pandas:
```python
import csv
# Lendo um arquivo CSV
with open('dados.csv', mode='r', encoding='utf-8') as file:
    leitor = csv.reader(file)
    for linha in leitor:
        print(linha)
# Escrevendo em um arquivo CSV
with open('saida.csv', mode='w', newline='', encoding='utf-8') as file:
    escritor = csv.writer(file)
    escritor.writerow(['Nome', 'Idade'])
    escritor.writerow(['Jo√£o', 30])
    escritor.writerow(['Maria', 25])
```

## 3.2. Arquivos Excel

Para manipular arquivos Excel, use a biblioteca `pandas` ou `openpyxl`. Aqui est√° um exemplo com `pandas`:

```python
import pandas as pd
# Lendo um arquivo Excel
df = pd.read_excel('dados.xlsx', sheet_name='Planilha1')
print(df.head())  # Exibe as primeiras linhas do DataFrame
# Escrevendo em um arquivo Excel
df.to_excel('saida.xlsx', index=False, sheet_name='Resultados')
```

## 3.3. Arquivos PDF

Para ler arquivos PDF, voc√™ pode usar a biblioteca `PyPDF2`. Aqui est√° um exemplo simples:

```python
import PyPDF2
# Lendo um arquivo PDF
with open('documento.pdf', 'rb') as file:
    leitor = PyPDF2.PdfReader(file)
    for pagina in leitor.pages:
        print(pagina.extract_text())  # Extrai o texto de cada p√°gina
```

## 3.4. Arquivos Word

Para manipular arquivos Word, use a biblioteca `python-docx`. Veja como ler e escrever documentos:

```python
from docx import Document
# Lendo um arquivo Word
doc = Document('documento.docx')
for par in doc.paragraphs:
    print(par.text)  # Exibe o texto de cada par√°grafo
# Escrevendo em um arquivo Word
doc_novo = Document()
doc_novo.add_heading('T√≠tulo do Documento', level=1)
doc_novo.add_paragraph('Este √© um par√°grafo de exemplo.')
doc_novo.save('novo_documento.docx')  # Salva o novo documento
```

## 3.5. Configurando as depend√™ncias do ambiente Python

Para trabalhar com arquivos Excel, CSV, PDF e Word, voc√™ precisa instalar algumas bibliotecas extras. Siga os passos abaixo:

1. **Crie um ambiente virtual (opcional, mas recomendado):**
   No terminal, execute:
   ```
   python -m venv venv
   ```
   Ative o ambiente virtual:
   ```
   venv\Scripts\activate
   ```

2. **Instale as bibliotecas necess√°rias:**
   ```
   pip install pandas openpyxl pdfplumber python-docx
   ```

   - `pandas`: manipula√ß√£o de dados (CSV, Excel)
   - `openpyxl`: leitura/escrita de arquivos Excel (.xlsx)
   - `pdfplumber`: leitura de arquivos PDF
   - `python-docx`: leitura/escrita de arquivos Word (.docx)

3. **(Opcional) Crie um arquivo `requirements.txt` para registrar as depend√™ncias:**
   ```
   pip freeze > requirements.txt
   ```

Assim, seu ambiente estar√° pronto para manipular arquivos desses tipos em Python. Voc√™ pode usar os exemplos acima como base para criar scripts que automatizam tarefas relacionadas a esses arquivos no seu dia a dia profissional.

***

## 3.6. Exerc√≠cios Pr√°ticos

Nesta se√ß√£o, voc√™ encontrar√° exerc√≠cios pr√°ticos para aplicar os conceitos aprendidos sobre manipula√ß√£o de arquivos. Esses exerc√≠cios s√£o projetados para serem desafiadores e ajudar√£o a consolidar seu conhecimento em automa√ß√£o de tarefas comuns em escrit√≥rios.

***

### 3.6.1. Exerc√≠cio Pr√°tico: An√°lise de Vendas de Produtos Online (CSV)

**Hist√≥ria:**  
Voc√™ trabalha no setor de an√°lise de dados de uma loja online. Recebeu um arquivo `vendas.csv` contendo o hist√≥rico de vendas do √∫ltimo m√™s. Cada linha do arquivo representa uma venda, com as seguintes colunas: `data`, `produto`, `quantidade`, `preco_unitario`.

**Desafio:**  
1. Leia o arquivo `vendas.csv` usando Python.
2. Calcule o total vendido (em reais) por produto.
3. Gere um novo arquivo `relatorio_vendas.csv` contendo duas colunas: `produto` e `total_vendido`.
4. (Opcional) Identifique qual produto teve o maior volume de vendas.

**Exemplo de entrada (`vendas.csv`):**
```
data,produto,quantidade,preco_unitario
2025-06-01,Mouse,2,50
2025-06-01,Teclado,1,120
2025-06-02,Mouse,1,50
2025-06-02,Monitor,1,900
```

**C√≥digo Python** para resolver o exerc√≠cio:

```python
import os
import pandas as pd

# Caminhos dos arquivos
csv_path = r'C:\dev\python_escritorios\codes\vendas.csv'
relatorio_path = r'C:\dev\python_escritorios\codes\relatorio_vendas.csv'

# Apaga o relat√≥rio antigo, se existir
if os.path.exists(relatorio_path):
    os.remove(relatorio_path)

# L√™ o arquivo de vendas
df = pd.read_csv(csv_path)

# Calcula o total vendido por produto
df['total'] = df['quantidade'] * df['preco_unitario']
df_relatorio = df.groupby('produto')['total'].sum().reset_index()
df_relatorio.rename(columns={'total': 'total_vendido'}, inplace=True)

# Salva o novo relat√≥rio
df_relatorio.to_csv(relatorio_path, index=False)

print("Relat√≥rio de vendas gerado com sucesso!")
```

**Resultado esperado (`relatorio_vendas.csv`)**:
```plaintext
produto,total_vendido
Mouse,150
Teclado,120
Monitor,900
```
**Conclus√£o:**

Com este exerc√≠cio, voc√™ praticou a leitura de arquivos CSV, manipula√ß√£o de dados com pandas e gera√ß√£o de relat√≥rios. Essas habilidades s√£o fundamentais para automatizar an√°lises de vendas e outras tarefas relacionadas a dados em escrit√≥rios.


***

### 3.6.2. Exerc√≠cio Pr√°tico: Automatizando Relat√≥rios de Inadimpl√™ncia em Alugu√©is com Python e Excel

**Hist√≥ria:**
Neste exerc√≠cio, vamos aplicar a integra√ß√£o entre Python e Excel para resolver um problema comum em empresas de aluguel de im√≥veis: o controle de inadimpl√™ncia.

**Cen√°rio:**  
Uma empresa de aluguel de im√≥veis mant√©m uma planilha chamada `alugueis.xlsx` com os seguintes campos:

- Im√≥vel
- Inquilino
- Valor Mensal
- Data de Vencimento
- Pago (Sim/N√£o)

**Planilha de exemplo (`alugueis.xlsx`):**

```plaintext
|-----------|-------------------|--------------|--------------------|----------------|
| Im√≥vel    | Inquilino         | Valor Mensal | Data de Vencimento | Pago (Sim/N√£o) |
|-----------|-------------------|--------------|--------------------|----------------|
| Apto 101  | Jo√£o da Silva     | 1800         | 2025-06-10         | Sim            |
| Casa 202  | Maria Souza       | 2500         | 2025-06-15         | N√£o            |
| Loja 303  | Pedro Lima        | 3200         | 2025-06-20         | N√£o            |
| Apto 104  | Ana Martins       | 2000         | 2025-06-12         | Sim            |
| Casa 205  | Bruno Carvalho    | 2700         | 2025-06-18         | N√£o            |
| Loja 307  | Carla Mendes      | 3500         | 2025-06-25         | Sim            |
| Apto 110  | Felipe Gon√ßalves  | 2100         | 2025-06-14         | N√£o            |
| Casa 208  | Luciana Ferreira  | 2600         | 2025-06-22         | N√£o            |
|-----------|-------------------|--------------|--------------------|----------------|
```

**Desafio:**  
Crie um script Python que:

1. Leia a planilha `alugueis.xlsx`.
2. Filtre os registros de im√≥veis cujo aluguel ainda n√£o foi pago.
3. Gere um novo arquivo Excel chamado `relatorio_inadimplentes.xlsx` apenas com os inadimplentes.
4. Simule o envio de um e-mail para cada inquilino inadimplente, informando o valor devido e a data de vencimento.

**Exemplo de C√≥digo Python:**

```python
import pandas as pd
import os

relatorio_path = r'C:\dev\python_escritorios\codes\relatorio_inadimplentes.xlsx'
# 1. Importar bibliotecas
# Importar bibliotecas necess√°rias
# Apagar o relat√≥rio anterior, se existir
if os.path.exists(relatorio_path):
    os.remove(relatorio_path)

# 2. Ler a planilha de alugu√©is
df = pd.read_excel(r'C:\dev\python_escritorios\codes\alugueis.xlsx')

# 3. Filtrar inadimplentes
inadimplentes = df[df['Pago (Sim/N√£o)'] == 'N√£o']

# 4. Salvar relat√≥rio dos inadimplentes
inadimplentes.to_excel(r'C:\dev\python_escritorios\codes\relatorio_inadimplentes.xlsx', index=False)

# 5. Simular envio de e-mails
for _, row in inadimplentes.iterrows():
    print(f"Enviando e-mail para {row['Inquilino']}:")
    print(f"Prezado(a) {row['Inquilino']}, seu aluguel do im√≥vel {row['Im√≥vel']} no valor de R$ {row['Valor Mensal']} est√° em aberto. Vencimento: {row['Data de Vencimento']}.")
    print("------------------------------\n")

# 6. Calcular total de alugu√©is em aberto
total_inadimplentes = inadimplentes['Valor Mensal'].sum()
print(f"Total de alugu√©is em aberto: R$ {total_inadimplentes}")

# 7. Calcular total de alugu√©is pagos
total_pagos = df[df['Pago (Sim/N√£o)'] == 'Sim']['Valor Mensal'].sum()
print(f"Total de alugu√©is pagos: R$ {total_pagos}")

# 8. Calcular total geral de alugu√©is
total_geral = df['Valor Mensal'].sum()
print(f"Total geral de alugu√©is: R$ {total_geral}")

# 9. Calcular porcentagem de inadimpl√™ncia
porcentagem_inadimplencia = (total_inadimplentes / total_geral) * 100 if total_geral > 0 else 0
print(f"Porcentagem de inadimpl√™ncia: {porcentagem_inadimplencia:.2f}%")

# 10. Exibir relat√≥rio final
print("\nRelat√≥rio Final:")
print(f"Total de alugu√©is em aberto: R$ {total_inadimplentes}")
print(f"Total de alugu√©is pagos: R$ {total_pagos}")
print(f"Total geral de alugu√©is: R$ {total_geral}")

# 11. Salvar relat√≥rio final
relatorio_final = {
    'Total Alugu√©is em Aberto': [total_inadimplentes],
    'Total Alugu√©is Pagos': [total_pagos],
    'Total Geral de Alugu√©is': [total_geral],
    'Porcentagem de Inadimpl√™ncia': [porcentagem_inadimplencia]
}
relatorio_df = pd.DataFrame(relatorio_final)
relatorio_df.to_excel(r'C:\dev\python_escritorios\codes\relatorio_final.xlsx', index=False)

# 12. Exibir mensagem de conclus√£o
print("Relat√≥rio final salvo com sucesso em 'relatorio_final.xlsx'.")

# 13. Fim do script
print("Processamento conclu√≠do.")
```

### Adendo - Exerc√≠cio Pr√°tico: Envio Real de E-mails para Inquilinos Inadimplentes

Al√©m de gerar o relat√≥rio de inadimplentes, √© poss√≠vel automatizar o envio de e-mails reais para cada inquilino com aluguel em aberto utilizando Python.

**Como fazer:**

1. **Adicione uma coluna "E-mail"** na planilha `alugueis.xlsx` com o endere√ßo de e-mail de cada inquilino.

2. **Utilize a biblioteca `smtplib`** do Python para enviar e-mails autom√°ticos. √â recomendado utilizar uma conta de e-mail dedicada e, no caso do Gmail, gerar uma senha de aplicativo para maior seguran√ßa.

3. **Exemplo de c√≥digo Python:**  
O c√≥digo completo para gera√ß√£o do relat√≥rio de inadimplentes e envio real de e-mails est√° dispon√≠vel no arquivo:

**C√≥digo Python para envio de e-mails:**

`codes/03_exemplo_pratico_alugueis_com_email.py`

4. **Exemplo de Planilha de Alugu√©is com E-mail dos Inquilinos**

```plaintext
|-----------|-------------------|--------------|--------------------|----------------|----------------------|
| Im√≥vel    | Inquilino         | Valor Mensal | Data de Vencimento | Pago (Sim/N√£o) | E-mail               |
|-----------|-------------------|--------------|--------------------|----------------|----------------------|
| Apto 101  | Jo√£o da Silva     | 1800         | 2025-06-10         | Sim            | joao@email.com       |
| Casa 202  | Maria Souza       | 2500         | 2025-06-15         | N√£o            | maria@email.com      |
| Loja 303  | Pedro Lima        | 3200         | 2025-06-20         | N√£o            | pedro@email.com      |
| Apto 104  | Ana Martins       | 2000         | 2025-06-12         | Sim            | ana@email.com        |
| Casa 205  | Bruno Carvalho    | 2700         | 2025-06-18         | N√£o            | bruno@email.com      |
| Loja 307  | Carla Mendes      | 3500         | 2025-06-25         | Sim            | carla@email.com      |
| Apto 110  | Felipe Gon√ßalves  | 2100         | 2025-06-14         | N√£o            | felipe@email.com     |
| Casa 208  | Luciana Ferreira  | 2600         | 2025-06-22         | N√£o            | luciana@email.com    |
|-----------|-------------------|--------------|--------------------|----------------|----------------------|
```

**Aten√ß√£o:**  
- Nunca compartilhe senhas em c√≥digo p√∫blico.
- Teste o envio com poucos destinat√°rios antes de usar em produ√ß√£o.
- Certifique-se de que o envio de e-mails est√° de acordo com as pol√≠ticas da sua empresa e com a legisla√ß√£o vigente (LGPD).

Com essa automa√ß√£o, a empresa pode agilizar a comunica√ß√£o com os inquilinos inadimplentes, tornando o processo mais eficiente e reduzindo o tempo gasto com cobran√ßas manuais.

**Conclus√£o:**

Com este exerc√≠cio, voc√™ praticou a leitura e escrita de arquivos Excel, filtragem de dados com pandas. Essas habilidades s√£o essenciais para automatizar o controle de inadimpl√™ncia em empresas de aluguel de im√≥veis, tornando o processo mais eficiente e organizado.

***

### 3.6.3. Exerc√≠cio Pr√°tico: Extra√ß√£o de Texto de um PDF

**Hist√≥ria Fict√≠cia:**  
A reparti√ß√£o p√∫blica ‚ÄúPrefeitura Municipal de Campo Largo, do Estado do Paran√°‚Äù recebe diariamente diversos documentos em PDF, como of√≠cios, requerimentos e certid√µes. A servidora Ana precisa extrair rapidamente o texto de um of√≠cio em PDF para copiar o conte√∫do para um sistema interno, mas fazer isso manualmente toma muito tempo.

**Desafio:**  
Ajude Ana a automatizar esse processo criando um script Python que:

1. Leia um arquivo PDF chamado `oficio_exemplo.pdf` localizado na pasta `codes`.
2. Extraia todo o texto do documento.
3. Salve o texto extra√≠do em um arquivo chamado `oficio_extraido.txt` na mesma pasta.
4. Mostre na tela as primeiras linhas do texto extra√≠do.

**Dica:**  
Utilize a biblioteca `PyPDF2` para a extra√ß√£o de texto de arquivos PDF.

**C√≥digo Python**:

```python
import PyPDF2

# Caminho do arquivo PDF
pdf_path = r'C:\dev\python_escritorios\codes\oficio_exemplo.pdf'
txt_path = r'C:\dev\python_escritorios\codes\oficio_extraido.txt'

# Abrir o PDF e extrair texto
with open(pdf_path, 'rb') as file:
    reader = PyPDF2.PdfReader(file)
    texto = ""
    for page in reader.pages:
        texto += page.extract_text()

# Salvar o texto extra√≠do em um arquivo .txt
with open(txt_path, 'w', encoding='utf-8') as f:
    f.write(texto)

# Mostrar as primeiras linhas do texto extra√≠do
print("Primeiras linhas do texto extra√≠do:")
print('\n'.join(texto.splitlines()[:10]))
```

**Observa√ß√£o:**  
Certifique-se de instalar a biblioteca com `pip install PyPDF2` antes de executar o script.

**Resultado esperado:**

```plaintext
OF√çCIO N¬∫ 123/2025 ‚Äì GAB/PMNE  
 
Campo Largo, 17 de junho de 2025.  
 
Ao   
Senhor Diretor do Departamento de Recursos Humanos   
Prefeitura Municipal de Campo Largo  
 
Assunto: Solicita√ß√£o de atualiza√ß√£o cadastral  
 
Prezado Senhor,  
 
Solicito, por meio deste of√≠cio, a gentileza de proceder √† atualiza√ß√£o dos dados 
cadastrais do servidor Jo√£o da Silva, matr√≠cula 4567, lotado no setor de Protocolo. 
Informo que houve altera√ß√£o de endere√ßo residencial e n√∫mero de telefone para 
contato.  
 
Segue em anexo a documenta√ß√£o comprobat√≥ria.  
 
Atenciosamente,  
 
Maria Souza   
Chefe de Gabinete   
Prefeitura Municipal de Campo Largo
```

**Conclus√£o:**

Com este exerc√≠cio, voc√™ praticou a leitura de arquivos PDF e a extra√ß√£o de texto usando Python. Essa habilidade √© √∫til para automatizar a coleta de informa√ß√µes de documentos oficiais, economizando tempo e aumentando a efici√™ncia no trabalho com reparti√ß√µes p√∫blicas.


***

### 3.6.4. Exerc√≠cio Pr√°tico: Leitura e Modifica√ß√£o de um Arquivo Word

**Hist√≥ria Fict√≠cia:**  
O escrit√≥rio de advocacia ‚ÄúSilva & Associados‚Äù recebe frequentemente minutas de contratos em formato Word, enviadas por clientes e parceiros. A advogada J√∫lia precisa revisar rapidamente esses contratos para garantir que todos contenham uma cl√°usula padr√£o de confidencialidade. Para agilizar o processo, ela deseja um script Python que leia o arquivo Word do contrato, verifique se a cl√°usula est√° presente e, caso n√£o esteja, adicione automaticamente a cl√°usula ao final do documento.

**Desafio:**  
Crie um script Python que:

1. Leia um arquivo Word chamado `contrato_exemplo.docx` localizado na pasta `codes`.
2. Verifique se o texto da cl√°usula de confidencialidade est√° presente.
3. Caso n√£o esteja, adicione a seguinte cl√°usula ao final do documento:

   > **Cl√°usula de Confidencialidade:** As partes se comprometem a manter em sigilo todas as informa√ß√µes trocadas em raz√£o deste contrato, n√£o podendo divulg√°-las a terceiros sem pr√©via autoriza√ß√£o por escrito.

4. Salve o documento modificado como `contrato_confidencial.docx` na mesma pasta.

**Dica:**  
Utilize a biblioteca `python-docx` para manipula√ß√£o de arquivos Word.

**C√≥digo Python**:

```python
from docx import Document
# Caminho do arquivo Word
doc_path = r'C:\dev\python_escritorios\codes\contrato_exemplo.docx'
doc_novo_path = r'C:\dev\python_escritorios\codes\contrato_confidencial.docx' 
# Cl√°usula de confidencialidade
clausa_confidencialidade = (
    "Cl√°usula de Confidencialidade: As partes se comprometem a manter em sigilo "
    "todas as informa√ß√µes trocadas em raz√£o deste contrato, n√£o podendo divulg√°-las "
    "a terceiros sem pr√©via autoriza√ß√£o por escrito."
)
# Abrir o documento Word
doc = Document(doc_path)
# Verificar se a cl√°usula j√° existe
clausula_presente = any(clausa_confidencialidade in par.text for par in doc.paragraphs)
if not clausula_presente:
    # Adicionar a cl√°usula de confidencialidade ao final do documento
    doc.add_paragraph(clausa_confidencialidade)
    print("Cl√°usula de confidencialidade adicionada ao contrato.")
else:
    print("Cl√°usula de confidencialidade j√° est√° presente no contrato.")
# Salvar o documento modificado
doc.save(doc_novo_path)
# Exibir mensagem de conclus√£o
print(f"Documento modificado salvo como '{doc_novo_path}'")
```

**Resultado esperado:**

```plaintext
Cl√°usula de confidencialidade adicionada ao contrato.
Documento modificado salvo como 'C:\dev\python_escritorios\codes\contrato_confidencial.docx'
```

**Conclus√£o:**

Com este exerc√≠cio, voc√™ praticou a leitura e modifica√ß√£o de arquivos Word usando Python. Essa habilidade √© √∫til para automatizar a revis√£o de documentos legais, garantindo que cl√°usulas importantes estejam sempre presentes, economizando tempo e aumentando a efici√™ncia no trabalho de advogados e escrit√≥rios de advocacia.

***

# 4. Automa√ß√£o de E-mails e Notifica√ß√µes

Nesta se√ß√£o, voc√™ aprender√° a automatizar o envio de e-mails e notifica√ß√µes usando Python. Essa habilidade √© essencial para manter a comunica√ß√£o eficiente em escrit√≥rios, seja para enviar lembretes, relat√≥rios ou avisos importantes.

## 4.1. Enviando E-mails com Python

Para enviar e-mails com Python, voc√™ pode usar a biblioteca `smtplib`, que permite enviar mensagens atrav√©s do protocolo SMTP. Abaixo est√° um exemplo b√°sico de como enviar um e-mail:

```python
import smtplib
from email.mime.text import MIMEText
# Configura√ß√µes do servidor SMTP
smtp_server = 'smtp.gmail.com'
smtp_port = 587
smtp_user = 'seu_email@gmail.com'
smtp_password = 'sua_senha'
# Fun√ß√£o para enviar e-mail
def enviar_email(destinatario, assunto, corpo):
    # Criar o objeto de mensagem
    msg = MIMEText(corpo)
    msg['Subject'] = assunto
    msg['From'] = smtp_user
    msg['To'] = destinatario
    # Enviar o e-mail
    with smtplib.SMTP(smtp_server, smtp_port) as server:
        server.starttls()
        server.login(smtp_user, smtp_password)
        server.send_message(msg)    
# Exemplo de uso
enviar_email('destinatario@example.com', 'Assunto do E-mail', 'Corpo do e-mail')
```

## 4.2. Enviando E-mails com Anexos

Para enviar e-mails com anexos, voc√™ pode usar a biblioteca `email` para criar mensagens mais complexas. Veja o exemplo abaixo:
```python
import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from email.mime.base import MIMEBase
from email import encoders
# Configura√ß√µes do servidor SMTP
smtp_server = 'smtp.gmail.com'
smtp_port = 587
smtp_user = 'seu_email@gmail.com'
smtp_password = 'sua_senha'
# Fun√ß√£o para enviar e-mail com anexo
def enviar_email_com_anexo(destinatario, assunto, corpo, caminho_anexo):
    # Criar o objeto de mensagem
    msg = MIMEMultipart()
    msg['Subject'] = assunto
    msg['From'] = smtp_user
    msg['To'] = destinatario
    # Adicionar o corpo do e-mail
    msg.attach(MIMEText(corpo, 'plain'))
    # Adicionar o anexo
    with open(caminho_anexo, 'rb') as anexo:
        parte = MIMEBase('application', 'octet-stream')
        parte.set_payload(anexo.read())
        encoders.encode_base64(parte)
        parte.add_header('Content-Disposition', f'attachment; filename={caminho_anexo.split("/")[-1]}')
        msg.attach(parte)
    # Enviar o e-mail
    with smtplib.SMTP(smtp_server, smtp_port) as server:
        server.starttls()
        server.login(smtp_user, smtp_password)
        server.send_message(msg)
# Exemplo de uso
enviar_email_com_anexo(
    'destinatario@example.com',
    'Assunto do E-mail com Anexo',
    'Corpo do e-mail com anexo',
    'caminho/para/o/anexo.txt'
)
```

## 4.3. Enviando Notifica√ß√µes por E-mail

Para enviar notifica√ß√µes por e-mail, voc√™ pode usar a fun√ß√£o `enviar_email` que criamos anteriormente. Veja um exemplo de como enviar um lembrete de reuni√£o:

```python
enviar_email(
    'destinatario@example.com',
    'Lembrete de Reuni√£o',
    'Este √© um lembrete de que voc√™ tem uma reuni√£o agendada para amanh√£ √†s 10h.'
)
```

## 4.4. Configurando as Depend√™ncias do Ambiente Python

Para que os exemplos de envio de e-mails funcionem, voc√™ precisa ter o Python instalado em seu ambiente, bem como as bibliotecas necess√°rias. Voc√™ pode instalar as bibliotecas usando o gerenciador de pacotes `pip`. Execute o seguinte comando no terminal:

```bash
pip install secure-smtplib email
```

## 4.5. Exerc√≠cios Pr√°ticos

Nesta se√ß√£o, voc√™ encontrar√° exerc√≠cios pr√°ticos para aplicar os conceitos aprendidos sobre automa√ß√£o de e-mails e notifica√ß√µes. Esses exerc√≠cios s√£o projetados para serem desafiadores e ajudar√£o a consolidar seu conhecimento em automa√ß√£o de comunica√ß√£o por e-mail.


### 4.5.1. Exerc√≠cio Pr√°tico: Envio de Relat√≥rios Di√°rios por E-mail

**Hist√≥ria:**
A empresa "Tech Solutions" precisa enviar relat√≥rios di√°rios de vendas para a equipe de ger√™ncia. O relat√≥rio √© gerado em um arquivo Excel chamado `relatorio_vendas.xlsx`, que cont√©m as vendas do dia anterior. A gerente Ana deseja automatizar o envio desse relat√≥rio por e-mail todas as manh√£s.

**Desafio:**
Crie um script Python que:
1. Leia o arquivo `relatorio_vendas.xlsx` localizado na pasta `codes`.
2. Envie o arquivo como anexo para o e-mail da gerente Ana, cujo endere√ßo √© `ana@techsolutions.com`.
3. O assunto do e-mail deve ser "Relat√≥rio de Vendas - [Data Atual]".
4. O corpo do e-mail deve conter uma breve mensagem: "Prezada Ana, segue em anexo o relat√≥rio de vendas do dia anterior."
5. Certifique-se de que o e-mail seja enviado usando uma conta de e-mail v√°lida (por exemplo, Gmail).
6. (Opcional) Configure o script para ser executado automaticamente todos os dias √†s 8h da manh√£ usando o agendador de tarefas do sistema operacional (Windows Task Scheduler ou cron no Linux).

**C√≥digo Python:**

```python
import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from email.mime.base import MIMEBase
from email import encoders
import pandas as pd
from datetime import datetime
import os

# Configura√ß√µes do servidor SMTP
smtp_server = 'smtp.gmail.com'
smtp_port = 587
smtp_user = 'seu_email@gmail.com'
smtp_password = 'sua_senha'

# Caminho do arquivo Excel
excel_path = r'C:\dev\python_escritorios\codes\relatorio_vendas.xlsx'

# 1. Gera√ß√£o de dados fict√≠cios de vendas
fake = Faker('pt_BR')
dados_vendas = []
for _ in range(10):  # Gerar 10 registros fict√≠cios
    dados_vendas.append({
        'data': fake.date_this_month(),
        'produto': fake.word(),
        'quantidade': fake.random_int(min=1, max=10),
        'preco_unitario': fake.random_int(min=50, max=500)
    })

# Criar DataFrame
df_vendas = pd.DataFrame(dados_vendas)

# 2. Salvando dados em um arquivo Excel (.xlsx)
df_vendas.to_excel(excel_path, index=False, sheet_name='Vendas')

# 3. Exibindo dados no console para c√≥pia manual para o Excel
print("Dados de Vendas Gerados:")
print(df_vendas)

# 4. Envio do relat√≥rio como anexo por e-mail
data_atual = datetime.now().strftime('%d/%m/%Y')
assunto = f'Relat√≥rio de Vendas - {data_atual}'
corpo = 'Prezada Ana, segue em anexo o relat√≥rio de vendas do dia.'

# Fun√ß√£o para enviar e-mail com anexo
def enviar_email_com_anexo(destinatario, assunto, corpo, caminho_anexo):
    # Criar o objeto de mensagem
    msg = MIMEMultipart()
    msg['Subject'] = assunto
    msg['From'] = smtp_user
    msg['To'] = destinatario
    # Adicionar o corpo do e-mail
    msg.attach(MIMEText(corpo, 'plain'))
    # Adicionar o anexo
    with open(caminho_anexo, 'rb') as anexo:
        parte = MIMEBase('application', 'octet-stream')
        parte.set_payload(anexo.read())
        encoders.encode_base64(parte)
        parte.add_header('Content-Disposition', f'attachment; filename={caminho_anexo.split("/")[-1]}')
        msg.attach(parte)
    # Enviar o e-mail
    with smtplib.SMTP(smtp_server, smtp_port) as server:
        server.starttls()
        server.login(smtp_user, smtp_password)
        server.send_message(msg)

# Enviar o e-mail com o relat√≥rio
enviar_email_com_anexo(
    'ana@techsolutions.com',
    assunto,
    corpo,
    excel_path
)
```

**Resultado esperado:**
```plaintext
Arquivo de vendas gerado em: C:\dev\python_escritorios\codes\relatorio_vendas.xlsx
Copie e cole os dados abaixo no Excel, se desejar:
Data	Produto	Quantidade	Valor Total
25/10/2023	Notebook	5	15000.00
E-mail enviado com sucesso!
```

**Observa√ß√£o:**
Certifique-se de substituir `seu_email@gmail.com` e `sua_senha` pelas suas credenciais de e-mail.

**Aten√ß√£o:**
- Nunca compartilhe suas credenciais de e-mail em c√≥digo p√∫blico.
- Use uma senha de aplicativo se estiver usando o Gmail, pois o Google pode bloquear tentativas de login de aplicativos menos seguros.
- Considere usar OAuth2 para uma abordagem mais segura.

**Conclus√£o:**

Com este exerc√≠cio, voc√™ praticou o envio de e-mails com anexos usando Python. Essa habilidade √© essencial para automatizar a comunica√ß√£o de relat√≥rios e documentos importantes em ambientes corporativos, economizando tempo e aumentando a efici√™ncia na troca de informa√ß√µes.

***

### 4.5.2. Exerc√≠cio Pr√°tico: Envio Autom√°tico de Relat√≥rio Di√°rio de Vendas

**Hist√≥ria:**  
A empresa "Tech Solutions" deseja automatizar o envio di√°rio de um relat√≥rio de vendas por e-mail para a equipe de ger√™ncia. O relat√≥rio deve conter dados fict√≠cios de vendas, ser salvo em Excel e enviado como anexo para a gerente Ana.

**Desafio:**  
Automatizar o processo de gera√ß√£o e envio do relat√≥rio di√°rio de vendas, seguindo os passos:

1. **Gera√ß√£o de Dados Fict√≠cios de Vendas:**  
   - Gerar 10 registros fict√≠cios de vendas usando a biblioteca `Faker`.
   - Cada registro deve conter: data, produto, quantidade e pre√ßo unit√°rio.

2. **Salvando Dados em um Arquivo Excel (.xlsx):**  
   - Salvar os dados em um arquivo Excel chamado `relatorio_vendas.xlsx` usando o `pandas`.

3. **Exibindo Dados no Console para C√≥pia Manual para o Excel:**  
   - Exibir os dados gerados no console para facilitar a c√≥pia.

4. **Envio do Relat√≥rio como Anexo por E-mail:**  
   - Enviar o arquivo Excel como anexo para o e-mail da gerente Ana (`ana@techsolutions.com`) usando `smtplib`.

**C√≥digo Python:**

```python
import pandas as pd
from faker import Faker
import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from email.mime.base import MIMEBase
from email import encoders
from datetime import datetime
import os

# Configura√ß√µes do servidor SMTP
smtp_server = 'smtp.gmail.com'
smtp_port = 587
smtp_user = 'seu_email@gmail.com'
smtp_password = 'sua_senha'

# Caminho do arquivo Excel
excel_path = r'C:\dev\python_escritorios\codes\relatorio_vendas.xlsx'

# 1. Gera√ß√£o de dados fict√≠cios de vendas
fake = Faker('pt_BR')
dados_vendas = []
for _ in range(10):
    dados_vendas.append({
        'data': fake.date_this_month(),
        'produto': fake.word(),
        'quantidade': fake.random_int(min=1, max=10),
        'preco_unitario': fake.random_int(min=50, max=500)
    })

# 2. Criar DataFrame e salvar em Excel
df_vendas = pd.DataFrame(dados_vendas)
df_vendas.to_excel(excel_path, index=False, sheet_name='Vendas')

# 3. Exibir dados no console
print("Dados de Vendas Gerados:")
print(df_vendas)

# 4. Envio do relat√≥rio como anexo por e-mail
data_atual = datetime.now().strftime('%d/%m/%Y')
assunto = f'Relat√≥rio de Vendas - {data_atual}'
corpo = 'Prezada Ana, segue em anexo o relat√≥rio de vendas do dia.'

def enviar_email_com_anexo(destinatario, assunto, corpo, caminho_anexo):
    msg = MIMEMultipart()
    msg['Subject'] = assunto
    msg['From'] = smtp_user
    msg['To'] = destinatario
    msg.attach(MIMEText(corpo, 'plain'))
    with open(caminho_anexo, 'rb') as anexo:
        parte = MIMEBase('application', 'octet-stream')
        parte.set_payload(anexo.read())
        encoders.encode_base64(parte)
        parte.add_header('Content-Disposition', f'attachment; filename={caminho_anexo.split("/")[-1]}')
        msg.attach(parte)
    with smtplib.SMTP(smtp_server, smtp_port) as server:
        server.starttls()
        server.login(smtp_user, smtp_password)
        server.send_message(msg)

enviar_email_com_anexo(
    'ana@techsolutions.com',
    assunto,
    corpo,
    excel_path
)

print("E-mail enviado com sucesso!")
```

**Resultado esperado:**
```plaintext
Dados de Vendas Gerados:
           data   produto  quantidade  preco_unitario
0   2025-06-01  exemplo1           3             120
1   2025-06-02  exemplo2           7             350
... (mais linhas) ...
E-mail enviado com sucesso!
```

**Observa√ß√µes:**
- Substitua `seu_email@gmail.com` e `sua_senha` pelas suas credenciais.
- Instale as depend√™ncias necess√°rias com:  
  `pip install pandas faker openpyxl`
- Nunca compartilhe suas credenciais em c√≥digo p√∫blico.
- Considere usar senha de aplicativo ou OAuth2 para maior seguran√ßa.

**Conclus√£o:**  
Com este exemplo, voc√™ praticou a gera√ß√£o de dados fict√≠cios, manipula√ß√£o de arquivos Excel, exibi√ß√£o de dados no console e envio autom√°tico de e-mails com anexo usando Python.

***

## 4.6. Considera√ß√µes de Seguran√ßa (OAuth2, aplicativos menos seguros)

Ao automatizar o envio de e-mails, √© importante considerar as implica√ß√µes de seguran√ßa. O uso de senhas em texto claro, como mostrado nos exemplos, n√£o √© recomendado para ambientes de produ√ß√£o.

## OAuth2

Uma abordagem mais segura √© usar OAuth2 para autentica√ß√£o. O OAuth2 √© um protocolo de autoriza√ß√£o que permite que aplicativos de terceiros acessem suas informa√ß√µes sem precisar compartilhar suas senhas.

### Vantagens do OAuth2

- **Seguran√ßa:** N√£o √© necess√°rio armazenar senhas em texto claro.
- **Controle:** √â poss√≠vel revogar o acesso a qualquer momento.
- **Escopo:** √â poss√≠vel limitar o acesso a apenas determinadas informa√ß√µes.

### Como Usar OAuth2 com Python

Para usar OAuth2 com Python, voc√™ pode usar a biblioteca `oauth2client`. Abaixo est√° um exemplo b√°sico de como configurar o OAuth2:

```python
from oauth2client.service_account import ServiceAccountCredentials
import gspread

# Configurar o escopo e as credenciais
escopo = ['https://www.googleapis.com/auth/spreadsheets']
credenciais = ServiceAccountCredentials.from_json_keyfile_name('caminho/para/credenciais.json', escopo)

# Autenticar e acessar o Google Sheets
cliente = gspread.authorize(credenciais)
planilha = cliente.open('Nome da Planilha').sheet1

# Ler dados da planilha
dados = planilha.get_all_records()
print(dados)
```

## Aplicativos Menos Seguros

Se voc√™ estiver usando o Gmail, √© poss√≠vel que precise permitir o acesso de "aplicativos menos seguros" para que o envio de e-mails funcione. No entanto, essa op√ß√£o reduz a seguran√ßa da sua conta e n√£o √© recomendada.

### Como Ativar

1. Acesse sua conta do Google.
2. V√° para "Seguran√ßa".
3. Na se√ß√£o "Acesso a app menos seguro", ative a op√ß√£o "Permitir aplicativos menos seguros".

### Aten√ß√£o

- Essa op√ß√£o pode n√£o estar dispon√≠vel para contas do Google Workspace (antigo G Suite).
- O Google pode bloquear o acesso de aplicativos menos seguros a qualquer momento, afetando a funcionalidade do seu aplicativo.

## Conclus√£o

Neste cap√≠tulo, voc√™ aprendeu sobre considera√ß√µes de seguran√ßa ao automatizar o envio de e-mails. A utiliza√ß√£o de OAuth2 √© a abordagem recomendada para garantir a seguran√ßa das suas credenciais e informa√ß√µes.

***

